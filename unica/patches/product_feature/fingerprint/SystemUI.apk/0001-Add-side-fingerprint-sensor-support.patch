From 5da5558c41b283f97bc198cafc77feac59a609dc Mon Sep 17 00:00:00 2001
From: BlackMesa123 <giangrecosalvo9@gmail.com>
Date: Fri, 14 Jun 2024 10:35:08 +0200
Subject: [PATCH] Add side fingerprint sensor support

---
 .../DualDarInnerLockScreenController.smali    |  126 +-
 .../KeyguardArrowViewController.smali         |   87 +-
 .../KeyguardPasswordViewController.smali      |   60 +-
 ...KeyguardSecAbsKeyInputViewController.smali |  274 +-
 .../KeyguardSecPatternViewController.smali    |  280 +-
 ...rdSecSecurityContainer$ArrowViewMode.smali |  151 +-
 ...ntroller$OnApplyWindowInsetsListener.smali |  146 +-
 ...yguardSecSecurityContainerController.smali |  193 +-
 .../keyguard/KeyguardSecUpdateMonitor.smali   |   18 +-
 ...onitorImpl$$ExternalSyntheticLambda6.smali |   17 +-
 ...onitorImpl$$ExternalSyntheticLambda7.smali |   59 +-
 ...onitorImpl$$ExternalSyntheticLambda9.smali |   17 +-
 .../KeyguardSecUpdateMonitorImpl.smali        | 2815 +++++++----------
 .../keyguard/KeyguardTextBuilder.smali        |  112 +-
 .../SecLockIconViewController$3.smali         |    4 +-
 .../com/android/keyguard/SecurityUtils.smali  |   33 +-
 .../android/keyguard/StrongAuthPopup.smali    |  419 ++-
 .../KeyguardBiometricViewController.smali     |  563 ++--
 ...opup$keyguardUpdateMonitorCallback$1.smali |   58 +-
 smali/com/android/systemui/LsRune.smali       |   10 +-
 ...mponent$CentralSurfacesComponentImpl.smali |    4 +-
 .../plugin/PluginFaceWidgetManager.smali      |   19 +-
 .../features/GlobalActionFeatures.smali       |   27 +-
 .../keyguard/KeyguardViewMediator.smali       |    2 +-
 .../keyguard/animator/ActionDownHandler.smali |  410 +--
 .../animator/FullScreenViewController.smali   |  103 +-
 .../animator/KeyguardTouchAnimator$2.smali    |  103 +-
 .../animator/KeyguardTouchAnimator.smali      |   32 +-
 .../KeyguardTouchSecurityInjector.smali       |   81 -
 .../power/PowerNotificationWarnings.smali     |   23 +
 .../systemui/power/PowerUI$Receiver.smali     |  224 +-
 .../power/SecPowerNotificationWarnings.smali  |   58 +-
 .../NotificationPanelViewController.smali     |  182 +-
 ...ificationPanelViewController_Factory.smali |    4 +
 ...Controller$$ExternalSyntheticLambda1.smali |   65 +-
 ...cationController$SecKeyguardCallback.smali |   23 +-
 .../phone/BiometricUnlockController.smali     |  213 +-
 .../phone/CentralSurfacesImpl$21.smali        |   23 +-
 .../statusbar/phone/CentralSurfacesImpl.smali |   21 +-
 .../phone/KeyguardSecBottomAreaView.smali     |   88 +-
 .../KeyguardSecBottomAreaViewController.smali |   55 +-
 .../SecStatusBarKeyguardViewManager$1.smali   |   20 +-
 .../SecStatusBarKeyguardViewManager.smali     |   69 +-
 ...mponent$CentralSurfacesComponentImpl.smali |    4 +-
 .../android/systemui/util/DeviceState.smali   |  444 +--
 .../android/systemui/util/DeviceType.smali    |    2 +
 46 files changed, 2797 insertions(+), 4944 deletions(-)

diff --git a/smali/com/android/keyguard/DualDarInnerLockScreenController.smali b/smali/com/android/keyguard/DualDarInnerLockScreenController.smali
index a5bf631e..cdccb3a6 100644
--- a/smali/com/android/keyguard/DualDarInnerLockScreenController.smali
+++ b/smali/com/android/keyguard/DualDarInnerLockScreenController.smali
@@ -249,7 +249,7 @@
 
     sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_NAVBAR_ENABLED:Z
 
-    if-eqz v1, :cond_d
+    if-eqz v1, :cond_b
 
     if-nez p2, :cond_0
 
@@ -312,33 +312,25 @@
 
     iget-object v3, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    if-eqz v1, :cond_6
-
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    if-eqz v1, :cond_5
 
     invoke-virtual {p1}, Landroid/view/ViewGroup;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v6
-
-    const v7, 0x7f0704b0
-
-    invoke-virtual {v6, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v6
+    move-result-object v1
 
-    add-int/2addr v6, v1
+    const v6, 0x7f0704b0
 
-    invoke-interface {v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    invoke-virtual {v1, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v1
+    invoke-interface {v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    if-eq v0, v4, :cond_4
+    if-eq v0, v4, :cond_3
 
-    const/4 v3, 0x2
+    const/4 v1, 0x2
 
-    if-eq v0, v3, :cond_4
+    if-eq v0, v1, :cond_3
 
-    if-eq v0, v2, :cond_4
+    if-eq v0, v2, :cond_3
 
     iget-boolean v0, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mIsPassword:Z
 
@@ -351,35 +343,28 @@
     goto :goto_1
 
     :cond_2
-    if-eqz v1, :cond_3
-
-    move v9, v6
+    iget v5, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mNavigationBarHeight:I
 
     goto :goto_2
 
     :cond_3
-    iget v5, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mNavigationBarHeight:I
-
-    goto :goto_1
-
-    :cond_4
     iget-boolean v0, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mIsPassword:Z
 
-    if-eqz v0, :cond_5
+    if-eqz v0, :cond_4
 
     iget-boolean v0, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mIsImeShown:Z
 
-    if-eqz v0, :cond_5
+    if-eqz v0, :cond_4
 
-    goto :goto_1
+    :goto_1
+    goto :goto_2
 
-    :cond_5
+    :cond_4
     iget v5, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mNavigationBarHeight:I
 
-    :goto_1
+    :goto_2
     move v9, v5
 
-    :goto_2
     const/4 v7, 0x0
 
     const/4 v8, 0x0
@@ -392,20 +377,16 @@
 
     invoke-virtual/range {v6 .. v11}, Lcom/android/keyguard/DualDarInnerLockScreenController;->updateLayoutParams(IIILcom/android/keyguard/KeyguardSecurityContainer;Lcom/android/keyguard/KeyguardInputView;)V
 
-    goto/16 :goto_7
+    goto :goto_7
 
-    :cond_6
+    :cond_5
     iget-object v1, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mContext:Landroid/content/Context;
 
     invoke-static {v1}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
 
     move-result v1
 
-    if-nez v1, :cond_7
-
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez v1, :cond_7
+    if-nez v1, :cond_6
 
     iget-object v1, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mBaseViewController:Lcom/android/keyguard/KeyguardInputViewController;
 
@@ -413,7 +394,7 @@
 
     move-result v1
 
-    if-eqz v1, :cond_7
+    if-eqz v1, :cond_6
 
     move v7, v5
 
@@ -423,16 +404,12 @@
 
     goto :goto_6
 
-    :cond_7
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    invoke-interface {v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result v3
+    :cond_6
+    invoke-interface {v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    if-eq v0, v4, :cond_c
+    if-eq v0, v4, :cond_a
 
-    if-eq v0, v2, :cond_a
+    if-eq v0, v2, :cond_9
 
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
 
@@ -440,30 +417,31 @@
 
     xor-int/2addr v0, v4
 
-    and-int/2addr v0, v3
-
-    iget-boolean v2, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mIsPassword:Z
+    and-int/2addr v0, v5
 
-    if-eqz v2, :cond_8
+    iget-boolean v1, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mIsPassword:Z
 
-    iget-boolean v2, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mIsImeShown:Z
+    if-eqz v1, :cond_7
 
-    if-eqz v2, :cond_8
+    iget-boolean v1, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mIsImeShown:Z
 
-    move v1, v5
+    if-eqz v1, :cond_7
 
     goto :goto_3
 
-    :cond_8
-    if-eqz v0, :cond_9
+    :cond_7
+    if-eqz v0, :cond_8
 
-    goto :goto_3
+    :goto_3
+    move v0, v5
 
-    :cond_9
-    iget v1, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mNavigationBarHeight:I
+    goto :goto_4
 
-    :goto_3
-    move v9, v1
+    :cond_8
+    iget v0, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mNavigationBarHeight:I
+
+    :goto_4
+    move v9, v0
 
     move v7, v5
 
@@ -471,25 +449,17 @@
 
     goto :goto_6
 
-    :cond_a
-    if-eqz v3, :cond_b
-
-    goto :goto_4
-
-    :cond_b
-    iget v1, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mNavigationBarHeight:I
-
-    :goto_4
+    :cond_9
     iget v0, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mNavigationBarHeight:I
 
     goto :goto_5
 
-    :cond_c
-    iget v1, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mNavigationBarHeight:I
-
-    move v0, v1
+    :cond_a
+    iget v0, p0, Lcom/android/keyguard/DualDarInnerLockScreenController;->mNavigationBarHeight:I
 
     :goto_5
+    move v1, v0
+
     move v8, v0
 
     move v7, v1
@@ -505,7 +475,7 @@
 
     invoke-virtual/range {v6 .. v11}, Lcom/android/keyguard/DualDarInnerLockScreenController;->updateLayoutParams(IIILcom/android/keyguard/KeyguardSecurityContainer;Lcom/android/keyguard/KeyguardInputView;)V
 
-    :cond_d
+    :cond_b
     :goto_7
     return-void
 .end method
@@ -563,9 +533,7 @@
 
     invoke-virtual {p4}, Landroid/view/ViewGroup;->getContext()Landroid/content/Context;
 
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/systemui/util/DeviceState;->isSmartViewDisplayWithFitToAspectRatio(Landroid/content/Context;)Z
+    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isSmartViewFitToActiveDisplay()Z
 
     move-result v0
 
diff --git a/smali/com/android/keyguard/KeyguardArrowViewController.smali b/smali/com/android/keyguard/KeyguardArrowViewController.smali
index 137a57cd..6d83b17f 100644
--- a/smali/com/android/keyguard/KeyguardArrowViewController.smali
+++ b/smali/com/android/keyguard/KeyguardArrowViewController.smali
@@ -681,7 +681,7 @@
 
     const/4 v6, 0x0
 
-    if-eqz v5, :cond_10
+    if-eqz v5, :cond_f
 
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isSmartViewFitToActiveDisplay()Z
 
@@ -941,46 +941,15 @@
     :goto_5
     invoke-virtual {v8, v11}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v7
+    move-result v6
 
-    sub-int/2addr v10, v7
+    sub-int/2addr v10, v6
 
     :cond_b
-    iget-object v7, p0, Lcom/android/keyguard/KeyguardArrowViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v7}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result v7
-
-    if-eqz v7, :cond_c
-
-    invoke-virtual {v8}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
-
-    move-result-object v7
-
-    iget-object v7, v7, Landroid/content/res/Configuration;->windowConfiguration:Landroid/app/WindowConfiguration;
-
-    invoke-virtual {v7}, Landroid/app/WindowConfiguration;->getRotation()I
-
-    move-result v7
-
-    if-nez v7, :cond_c
-
-    sget v7, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    const v9, 0x7f0704b0
-
-    invoke-virtual {v8, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v8
-
-    add-int/2addr v8, v7
-
-    sub-int/2addr v8, v6
+    iget-object v6, p0, Lcom/android/keyguard/KeyguardArrowViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    add-int/2addr v10, v8
+    invoke-interface {v6}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    :cond_c
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
     move-result-object v6
@@ -993,59 +962,55 @@
 
     move-result v8
 
-    if-eqz v8, :cond_e
+    if-eqz v8, :cond_d
 
-    if-eqz v7, :cond_d
+    if-eqz v7, :cond_c
 
-    const v7, 0x7f07050b
+    const p0, 0x7f07050b
 
-    invoke-virtual {v6, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v6, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v6
+    move-result p0
 
     goto :goto_6
 
-    :cond_d
+    :cond_c
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    move-result-object v6
+    move-result-object p0
 
-    invoke-static {v6}, Lcom/android/keyguard/SecurityUtils;->getTabletPINContainerHeight(Landroid/content/Context;)I
+    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getTabletPINContainerHeight(Landroid/content/Context;)I
 
-    move-result v6
+    move-result p0
 
     goto :goto_6
 
-    :cond_e
-    if-eqz v7, :cond_f
+    :cond_d
+    if-eqz v7, :cond_e
 
-    const v7, 0x7f07050a
+    const p0, 0x7f07050a
 
-    invoke-virtual {v6, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v6, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v6
+    move-result p0
 
     goto :goto_6
 
-    :cond_f
+    :cond_e
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    move-result-object v6
+    move-result-object p0
 
-    invoke-static {v6}, Lcom/android/keyguard/SecurityUtils;->getFoldPINContainerHeight(Landroid/content/Context;)I
+    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getFoldPINContainerHeight(Landroid/content/Context;)I
 
-    move-result v6
+    move-result p0
 
     :goto_6
     invoke-virtual {v0, v12}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    iget p0, p0, Lcom/android/keyguard/KeyguardArrowViewController;->mLastOrientation:I
-
-    const/4 v0, 0x2
+    iput p0, v2, Landroid/widget/FrameLayout$LayoutParams;->height:I
 
-    iput v6, v2, Landroid/widget/FrameLayout$LayoutParams;->height:I
-
-    iput v6, v4, Landroid/widget/FrameLayout$LayoutParams;->height:I
+    iput p0, v4, Landroid/widget/FrameLayout$LayoutParams;->height:I
 
     iput v5, v2, Landroid/widget/FrameLayout$LayoutParams;->leftMargin:I
 
@@ -1057,7 +1022,7 @@
 
     goto :goto_8
 
-    :cond_10
+    :cond_f
     :goto_7
     iput v6, v2, Landroid/widget/FrameLayout$LayoutParams;->leftMargin:I
 
diff --git a/smali/com/android/keyguard/KeyguardPasswordViewController.smali b/smali/com/android/keyguard/KeyguardPasswordViewController.smali
index 87f73aaa..19a8a281 100644
--- a/smali/com/android/keyguard/KeyguardPasswordViewController.smali
+++ b/smali/com/android/keyguard/KeyguardPasswordViewController.smali
@@ -299,87 +299,53 @@
 .end method
 
 .method public final isHideKeyboardByDefault()Z
-    .locals 5
+    .locals 3
 
     invoke-static {}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getCurrentUser()I
 
     move-result v0
 
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    const/4 v2, 0x0
-
-    const/4 v3, 0x1
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     iget-object p0, p0, Lcom/android/keyguard/KeyguardAbsKeyInputViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    if-eqz v1, :cond_0
-
-    invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    move v1, v3
-
-    goto :goto_0
-
-    :cond_0
-    move v1, v2
-
-    :goto_0
     invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getUserUnlockedWithBiometric(I)Z
 
     move-result v0
 
     invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->is2StepVerification()Z
 
-    move-result v4
-
-    if-eqz v4, :cond_2
-
-    if-eqz v1, :cond_1
+    move-result v1
 
-    if-nez v0, :cond_1
+    const/4 v2, 0x0
 
-    move v2, v3
+    if-eqz v1, :cond_0
 
-    :cond_1
     return v2
 
-    :cond_2
-    if-eqz v1, :cond_3
-
-    invoke-virtual {p0, v3}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isUnlockingWithBiometricAllowed(Z)Z
-
-    move-result v1
-
-    if-nez v1, :cond_4
-
-    :cond_3
-    if-nez v0, :cond_4
+    :cond_0
+    if-nez v0, :cond_1
 
     sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v0, :cond_5
+    if-eqz v0, :cond_2
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFingerprintDetectionRunning()Z
 
     move-result v0
 
-    if-nez v0, :cond_4
+    if-nez v0, :cond_1
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFaceDetectionRunning()Z
 
     move-result p0
 
-    if-eqz p0, :cond_5
+    if-eqz p0, :cond_2
 
-    :cond_4
-    move v2, v3
+    :cond_1
+    const/4 v2, 0x1
 
-    :cond_5
+    :cond_2
     return v2
 .end method
 
diff --git a/smali/com/android/keyguard/KeyguardSecAbsKeyInputViewController.smali b/smali/com/android/keyguard/KeyguardSecAbsKeyInputViewController.smali
index 69577609..8cacc7ae 100644
--- a/smali/com/android/keyguard/KeyguardSecAbsKeyInputViewController.smali
+++ b/smali/com/android/keyguard/KeyguardSecAbsKeyInputViewController.smali
@@ -513,88 +513,6 @@
     return-void
 .end method
 
-.method public final getInDisplayFpContainerBottomMargin(Z)I
-    .locals 3
-
-    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v0
-
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    if-eqz p1, :cond_0
-
-    const v2, 0x7f070500
-
-    goto :goto_0
-
-    :cond_0
-    const v2, 0x7f070512
-
-    :goto_0
-    invoke-virtual {v0, v2}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v2
-
-    add-int/2addr v2, v1
-
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mEcaView:Landroid/view/View;
-
-    if-eqz p0, :cond_1
-
-    const v1, 0x7f0a0397
-
-    invoke-virtual {p0, v1}, Landroid/view/View;->findViewById(I)Landroid/view/View;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Landroid/view/View;->getVisibility()I
-
-    move-result p0
-
-    if-nez p0, :cond_1
-
-    const p0, 0x7f07040b
-
-    invoke-virtual {v0, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result p0
-
-    goto :goto_1
-
-    :cond_1
-    const/4 p0, 0x0
-
-    :goto_1
-    sub-int/2addr v2, p0
-
-    if-eqz p1, :cond_2
-
-    const p0, 0x7f070501
-
-    goto :goto_2
-
-    :cond_2
-    const p0, 0x7f070514
-
-    :goto_2
-    invoke-virtual {v0, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result p0
-
-    sub-int/2addr v2, p0
-
-    const p0, 0x105024e
-
-    invoke-virtual {v0, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result p0
-
-    sub-int/2addr v2, p0
-
-    return v2
-.end method
-
 .method public getSecurityViewId()I
     .locals 0
 
@@ -972,26 +890,21 @@
 
     add-int/2addr v2, v0
 
-    const/4 v0, 0x0
-
     if-eqz p0, :cond_1
 
-    sget p0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    goto :goto_1
+    sget-object p0, Lcom/android/systemui/util/DeviceState;->sDisplaySize:Landroid/graphics/Point;
 
     :cond_1
-    move p0, v0
+    const/4 p0, 0x0
 
-    :goto_1
     add-int/2addr v2, p0
 
     if-ge v1, v2, :cond_2
 
-    const/4 v0, 0x1
+    const/4 p0, 0x1
 
     :cond_2
-    return v0
+    return p0
 .end method
 
 .method public final isBiometricLockoutLandscape()Z
@@ -1995,45 +1908,18 @@
 
     if-eqz p2, :cond_0
 
-    move p2, v0
-
     goto :goto_0
 
     :cond_0
-    move p2, v1
+    move v0, v1
 
     :goto_0
-    invoke-virtual {p1, v1, v1, p2, v1}, Landroid/widget/LinearLayout;->setPadding(IIII)V
-
-    iget-object p2, p0, Lcom/android/keyguard/KeyguardAbsKeyInputViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {p2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result p2
-
-    if-eqz p2, :cond_2
-
-    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getCurrentRotation(Landroid/content/Context;)I
-
-    move-result p0
-
-    const/4 p2, 0x1
-
-    if-ne p0, p2, :cond_1
-
     invoke-virtual {p1, v1, v1, v0, v1}, Landroid/widget/LinearLayout;->setPadding(IIII)V
 
-    goto :goto_1
+    iget-object p0, p0, Lcom/android/keyguard/KeyguardAbsKeyInputViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    :cond_1
-    invoke-virtual {p1, v0, v1, v1, v1}, Landroid/widget/LinearLayout;->setPadding(IIII)V
+    invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    :cond_2
-    :goto_1
     return-void
 .end method
 
@@ -3534,11 +3420,11 @@
 
     const/4 v10, -0x2
 
-    if-eqz v9, :cond_12
+    if-eqz v9, :cond_10
 
     iget-object v11, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mInputContainer:Landroid/widget/LinearLayout;
 
-    if-eqz v11, :cond_12
+    if-eqz v11, :cond_10
 
     invoke-virtual {v9}, Landroid/widget/LinearLayout;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
@@ -3598,7 +3484,7 @@
 
     iget-object v4, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mContainer:Landroid/widget/LinearLayout;
 
-    if-eqz v4, :cond_11
+    if-eqz v4, :cond_f
 
     invoke-virtual {v4}, Landroid/widget/LinearLayout;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
@@ -3608,7 +3494,7 @@
 
     iget-object v15, v0, Lcom/android/keyguard/KeyguardAbsKeyInputViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    if-eqz v2, :cond_a
+    if-eqz v2, :cond_9
 
     iput v8, v4, Landroid/widget/LinearLayout$LayoutParams;->width:I
 
@@ -3641,38 +3527,7 @@
 
     iput v3, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
-    invoke-interface {v15}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_9
-
-    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_9
-
-    iget v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mSecondsRemaining:I
-
-    if-ne v3, v8, :cond_9
-
-    iget-boolean v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mIsImeShown:Z
-
-    if-nez v3, :cond_9
-
-    const/4 v14, 0x1
-
-    invoke-virtual {v0, v14}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->getInDisplayFpContainerBottomMargin(Z)I
-
-    move-result v3
-
-    iput v3, v4, Landroid/widget/LinearLayout$LayoutParams;->bottomMargin:I
-
-    goto/16 :goto_6
-
-    :cond_9
-    const/4 v14, 0x1
+    invoke-interface {v15}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
     const v3, 0x7f070500
 
@@ -3684,43 +3539,18 @@
 
     goto :goto_6
 
-    :cond_a
-    const/4 v14, 0x1
-
+    :cond_9
     iput v10, v4, Landroid/widget/LinearLayout$LayoutParams;->width:I
 
     iput v10, v4, Landroid/widget/LinearLayout$LayoutParams;->height:I
 
     iput v5, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
-    invoke-interface {v15}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result v15
-
-    if-eqz v15, :cond_b
-
-    iget v15, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mSecondsRemaining:I
-
-    if-ne v15, v8, :cond_b
-
-    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
-
-    move-result v15
-
-    if-eqz v15, :cond_b
-
-    invoke-virtual {v0, v5}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->getInDisplayFpContainerBottomMargin(Z)I
+    invoke-interface {v15}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    move-result v3
-
-    iput v3, v4, Landroid/widget/LinearLayout$LayoutParams;->bottomMargin:I
-
-    goto :goto_6
-
-    :cond_b
-    if-eqz v3, :cond_10
+    if-eqz v3, :cond_e
 
-    if-eqz v6, :cond_f
+    if-eqz v6, :cond_d
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->isLandscapeDisplay()Z
 
@@ -3728,33 +3558,33 @@
 
     const v6, 0x7f0704bf
 
-    if-eqz v3, :cond_e
+    if-eqz v3, :cond_c
 
     invoke-virtual {v1, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v3
 
-    const v15, 0x7f0704c0
+    const v14, 0x7f0704c0
 
-    invoke-virtual {v1, v15}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v1, v14}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v14
+    move-result v15
 
-    if-ne v3, v14, :cond_c
+    if-ne v3, v15, :cond_a
 
     const/4 v3, 0x1
 
     goto :goto_4
 
-    :cond_c
+    :cond_a
     move v3, v5
 
     :goto_4
-    if-nez v3, :cond_d
+    if-nez v3, :cond_b
 
-    move v6, v15
+    move v6, v14
 
-    :cond_d
+    :cond_b
     invoke-virtual {v1, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v3
@@ -3763,7 +3593,7 @@
 
     goto :goto_5
 
-    :cond_e
+    :cond_c
     invoke-virtual {v1, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v3
@@ -3777,7 +3607,7 @@
 
     goto :goto_6
 
-    :cond_f
+    :cond_d
     const v3, 0x7f0704c1
 
     invoke-virtual {v1, v3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
@@ -3788,7 +3618,7 @@
 
     goto :goto_6
 
-    :cond_10
+    :cond_e
     const v3, 0x7f070512
 
     invoke-virtual {v1, v3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
@@ -3802,23 +3632,23 @@
 
     invoke-virtual {v3, v4}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    :cond_11
+    :cond_f
     invoke-virtual {v9, v12}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
     invoke-virtual {v11, v13}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
     invoke-virtual {v11, v5}, Landroid/widget/LinearLayout;->setVisibility(I)V
 
-    :cond_12
+    :cond_10
     iget-object v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mPasswordEntryBoxLayout:Landroid/view/ViewGroup;
 
-    if-eqz v3, :cond_13
+    if-eqz v3, :cond_11
 
     invoke-static/range {p1 .. p1}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->isPINSecurityView(I)Z
 
     move-result v4
 
-    if-eqz v4, :cond_13
+    if-eqz v4, :cond_11
 
     invoke-virtual {v3}, Landroid/view/ViewGroup;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
@@ -3836,10 +3666,10 @@
 
     invoke-virtual {v3, v4}, Landroid/view/ViewGroup;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    :cond_13
+    :cond_11
     iget-object v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mEcaView:Landroid/view/View;
 
-    if-eqz v3, :cond_18
+    if-eqz v3, :cond_16
 
     invoke-virtual {v3}, Landroid/view/View;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
@@ -3851,7 +3681,7 @@
 
     iput v10, v3, Landroid/widget/LinearLayout$LayoutParams;->height:I
 
-    if-eqz v2, :cond_14
+    if-eqz v2, :cond_12
 
     const v4, 0x7f070501
 
@@ -3859,28 +3689,28 @@
 
     goto :goto_8
 
-    :cond_14
+    :cond_12
     const v4, 0x7f0a050a
 
     move/from16 v6, p1
 
-    if-ne v6, v4, :cond_15
+    if-ne v6, v4, :cond_13
 
     const/4 v4, 0x1
 
     goto :goto_7
 
-    :cond_15
+    :cond_13
     move v4, v5
 
     :goto_7
-    if-eqz v4, :cond_16
+    if-eqz v4, :cond_14
 
     const v4, 0x7f0704b9
 
     goto :goto_8
 
-    :cond_16
+    :cond_14
     const v4, 0x7f070514
 
     :goto_8
@@ -3898,11 +3728,11 @@
 
     iget-object v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mEcaFlexContainer:Landroid/widget/LinearLayout;
 
-    if-eqz v3, :cond_17
+    if-eqz v3, :cond_15
 
     invoke-virtual {v3, v1}, Landroid/widget/LinearLayout;->setVisibility(I)V
 
-    :cond_17
+    :cond_15
     iget-object v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mEcaView:Landroid/view/View;
 
     invoke-virtual {v3, v5}, Landroid/view/View;->setVisibility(I)V
@@ -3919,34 +3749,34 @@
 
     invoke-virtual {v4, v3}, Lcom/android/keyguard/EmergencyButtonController;->setEmergencyView(Landroid/view/View;)V
 
-    if-eqz v2, :cond_19
+    if-eqz v2, :cond_17
 
     iget-object v2, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mDummyEcaSpace:Landroid/widget/Space;
 
-    if-eqz v2, :cond_19
+    if-eqz v2, :cond_17
 
     invoke-virtual {v2, v1}, Landroid/widget/Space;->setVisibility(I)V
 
     goto :goto_9
 
-    :cond_18
+    :cond_16
     move/from16 v6, p1
 
-    :cond_19
+    :cond_17
     :goto_9
-    if-eqz v7, :cond_1a
+    if-eqz v7, :cond_18
 
     invoke-static/range {p1 .. p1}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->isPINSecurityView(I)Z
 
     move-result v1
 
-    if-eqz v1, :cond_1a
+    if-eqz v1, :cond_18
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->isAllowedToAdjustSecurityView()Z
 
     move-result v1
 
-    if-eqz v1, :cond_1a
+    if-eqz v1, :cond_18
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
@@ -3966,14 +3796,14 @@
 
     invoke-virtual {v2, v5, v1}, Landroid/widget/TextView;->setTextSize(IF)V
 
-    :cond_1a
+    :cond_18
     iget-object v1, v0, Lcom/android/keyguard/KeyguardInputViewController;->mSubMessageAreaController:Lcom/android/keyguard/KeyguardSecMessageAreaController;
 
-    if-eqz v1, :cond_1b
+    if-eqz v1, :cond_19
 
     invoke-virtual {v1, v5}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->setVisibility(I)V
 
-    :cond_1b
+    :cond_19
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardInputViewController;->updatePrevInfoTextSize()V
 
     return-void
diff --git a/smali/com/android/keyguard/KeyguardSecPatternViewController.smali b/smali/com/android/keyguard/KeyguardSecPatternViewController.smali
index fc69ac7f..0ef3af4d 100644
--- a/smali/com/android/keyguard/KeyguardSecPatternViewController.smali
+++ b/smali/com/android/keyguard/KeyguardSecPatternViewController.smali
@@ -2167,7 +2167,7 @@
 .end method
 
 .method public final updatePortraitLayout()V
-    .locals 13
+    .locals 10
 
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
@@ -2196,302 +2196,236 @@
     invoke-virtual {v2, v3}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
     :cond_0
-    const v2, 0x7f0a0397
-
-    const v3, 0x7f070508
-
-    iget-object v4, p0, Lcom/android/keyguard/KeyguardPatternViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    const/4 v5, 0x1
-
-    iget-object v6, p0, Lcom/android/keyguard/KeyguardPatternViewController;->mLockPatternView:Lcom/android/internal/widget/LockPatternView;
-
-    iget-object v7, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mEcaView:Landroid/view/View;
-
-    const/4 v8, 0x0
-
-    if-eqz v6, :cond_3
-
-    iget-object v9, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mSecurityView:Landroid/widget/LinearLayout;
-
-    if-eqz v9, :cond_3
-
-    invoke-virtual {v6}, Lcom/android/internal/widget/LockPatternView;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
-
-    move-result-object v10
-
-    check-cast v10, Landroid/widget/FrameLayout$LayoutParams;
-
-    const/16 v11, 0x51
-
-    invoke-virtual {v9, v11}, Landroid/widget/LinearLayout;->setGravity(I)V
-
-    invoke-virtual {v9, v5}, Landroid/widget/LinearLayout;->setOrientation(I)V
-
-    const v9, 0x7f07050e
-
-    invoke-virtual {v0, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v9
-
-    iput v9, v10, Landroid/widget/FrameLayout$LayoutParams;->width:I
-
-    const v9, 0x7f07050a
-
-    invoke-virtual {v0, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    iget-object v2, p0, Lcom/android/keyguard/KeyguardPatternViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    move-result v9
+    const/4 v3, 0x1
 
-    iput v9, v10, Landroid/widget/FrameLayout$LayoutParams;->height:I
+    iget-object v4, p0, Lcom/android/keyguard/KeyguardPatternViewController;->mLockPatternView:Lcom/android/internal/widget/LockPatternView;
 
-    invoke-interface {v4}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    if-eqz v4, :cond_1
 
-    move-result v9
+    iget-object v5, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mSecurityView:Landroid/widget/LinearLayout;
 
-    const v11, 0x7f07050c
+    if-eqz v5, :cond_1
 
-    if-eqz v9, :cond_2
+    invoke-virtual {v4}, Lcom/android/internal/widget/LockPatternView;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
-    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
+    move-result-object v6
 
-    move-result v9
+    check-cast v6, Landroid/widget/FrameLayout$LayoutParams;
 
-    if-eqz v9, :cond_2
+    const/16 v7, 0x51
 
-    iget v9, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mSecondsRemaining:I
+    invoke-virtual {v5, v7}, Landroid/widget/LinearLayout;->setGravity(I)V
 
-    if-ne v9, v1, :cond_2
+    invoke-virtual {v5, v3}, Landroid/widget/LinearLayout;->setOrientation(I)V
 
-    sget v9, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    const v5, 0x7f07050e
 
-    invoke-virtual {v0, v11}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v0, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v11
+    move-result v5
 
-    add-int/2addr v11, v9
+    iput v5, v6, Landroid/widget/FrameLayout$LayoutParams;->width:I
 
-    invoke-virtual {v0, v3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    const v5, 0x7f07050a
 
-    move-result v9
+    invoke-virtual {v0, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    sub-int/2addr v11, v9
+    move-result v5
 
-    const v9, 0x105024e
+    iput v5, v6, Landroid/widget/FrameLayout$LayoutParams;->height:I
 
-    invoke-virtual {v0, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    move-result v9
+    const v5, 0x7f07050c
 
-    sub-int/2addr v11, v9
+    invoke-virtual {v0, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    if-eqz v7, :cond_1
+    move-result v5
 
-    invoke-virtual {v7, v2}, Landroid/view/View;->findViewById(I)Landroid/view/View;
+    iput v5, v6, Landroid/widget/FrameLayout$LayoutParams;->bottomMargin:I
 
-    move-result-object v9
+    invoke-virtual {v4, v6}, Lcom/android/internal/widget/LockPatternView;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    invoke-virtual {v9}, Landroid/view/View;->getVisibility()I
+    :cond_1
+    iget-object v4, p0, Lcom/android/keyguard/KeyguardInputViewController;->mMessageAreaController:Lcom/android/keyguard/KeyguardSecMessageAreaController;
 
-    move-result v9
+    if-eqz v4, :cond_2
 
-    if-nez v9, :cond_1
+    invoke-virtual {v4}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
-    const v9, 0x7f07040b
+    move-result-object v5
 
-    invoke-virtual {v0, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    check-cast v5, Landroid/view/ViewGroup$MarginLayoutParams;
 
-    move-result v9
+    const v6, 0x7f070510
 
-    goto :goto_0
+    invoke-virtual {v0, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    :cond_1
-    move v9, v8
+    move-result v6
 
-    :goto_0
-    sub-int/2addr v11, v9
+    iput v6, v5, Landroid/view/ViewGroup$MarginLayoutParams;->bottomMargin:I
 
-    goto :goto_1
+    invoke-virtual {v4, v5}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
     :cond_2
-    invoke-virtual {v0, v11}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v11
+    const/4 v4, 0x0
 
-    :goto_1
-    iput v11, v10, Landroid/widget/FrameLayout$LayoutParams;->bottomMargin:I
+    iget-object v5, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mMessageArea:Landroid/widget/LinearLayout;
 
-    invoke-virtual {v6, v10}, Lcom/android/internal/widget/LockPatternView;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
+    if-eqz v5, :cond_4
 
-    :cond_3
-    iget-object v6, p0, Lcom/android/keyguard/KeyguardInputViewController;->mMessageAreaController:Lcom/android/keyguard/KeyguardSecMessageAreaController;
+    iget-object v6, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mContainer:Landroid/widget/LinearLayout;
 
     if-eqz v6, :cond_4
 
-    invoke-virtual {v6}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
-
-    move-result-object v9
-
-    check-cast v9, Landroid/view/ViewGroup$MarginLayoutParams;
-
-    const v10, 0x7f070510
-
-    invoke-virtual {v0, v10}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v10
-
-    iput v10, v9, Landroid/view/ViewGroup$MarginLayoutParams;->bottomMargin:I
-
-    invoke-virtual {v6, v9}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
-
-    :cond_4
-    iget-object v6, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mMessageArea:Landroid/widget/LinearLayout;
-
-    if-eqz v6, :cond_6
+    invoke-virtual {v5}, Landroid/widget/LinearLayout;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
-    iget-object v9, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mContainer:Landroid/widget/LinearLayout;
+    move-result-object v7
 
-    if-eqz v9, :cond_6
+    check-cast v7, Landroid/widget/LinearLayout$LayoutParams;
 
     invoke-virtual {v6}, Landroid/widget/LinearLayout;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
-    move-result-object v10
-
-    check-cast v10, Landroid/widget/LinearLayout$LayoutParams;
+    move-result-object v8
 
-    invoke-virtual {v9}, Landroid/widget/LinearLayout;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
+    check-cast v8, Landroid/widget/LinearLayout$LayoutParams;
 
-    move-result-object v11
+    sget-boolean v9, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
 
-    check-cast v11, Landroid/widget/LinearLayout$LayoutParams;
+    if-eqz v9, :cond_3
 
-    sget-boolean v12, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
+    const-class v9, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
-    if-eqz v12, :cond_5
+    invoke-static {v9}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    const-class v12, Lcom/android/systemui/keyguard/DisplayLifecycle;
+    move-result-object v9
 
-    invoke-static {v12}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+    check-cast v9, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
-    move-result-object v12
+    iget-boolean v9, v9, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
 
-    check-cast v12, Lcom/android/systemui/keyguard/DisplayLifecycle;
+    if-eqz v9, :cond_3
 
-    iget-boolean v12, v12, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
+    move v9, v4
 
-    if-eqz v12, :cond_5
+    goto :goto_0
 
-    move v12, v8
+    :cond_3
+    const v9, 0x7f0704fc
 
-    goto :goto_2
+    invoke-virtual {v0, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    :cond_5
-    const v12, 0x7f0704fc
+    move-result v9
 
-    invoke-virtual {v0, v12}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    :goto_0
+    invoke-virtual {v5, v9, v4, v9, v4}, Landroid/widget/LinearLayout;->setPadding(IIII)V
 
-    move-result v12
+    invoke-virtual {v6, v4, v4, v4, v4}, Landroid/widget/LinearLayout;->setPadding(IIII)V
 
-    :goto_2
-    invoke-virtual {v6, v12, v8, v12, v8}, Landroid/widget/LinearLayout;->setPadding(IIII)V
+    iput v1, v7, Landroid/widget/LinearLayout$LayoutParams;->width:I
 
-    invoke-virtual {v9, v8, v8, v8, v8}, Landroid/widget/LinearLayout;->setPadding(IIII)V
+    const/4 v9, -0x2
 
-    iput v1, v10, Landroid/widget/LinearLayout$LayoutParams;->width:I
+    iput v9, v7, Landroid/widget/LinearLayout$LayoutParams;->height:I
 
-    const/4 v12, -0x2
+    iput v4, v7, Landroid/widget/LinearLayout$LayoutParams;->bottomMargin:I
 
-    iput v12, v10, Landroid/widget/LinearLayout$LayoutParams;->height:I
+    iput v1, v8, Landroid/widget/LinearLayout$LayoutParams;->width:I
 
-    iput v8, v10, Landroid/widget/LinearLayout$LayoutParams;->bottomMargin:I
+    iput v9, v8, Landroid/widget/LinearLayout$LayoutParams;->height:I
 
-    iput v1, v11, Landroid/widget/LinearLayout$LayoutParams;->width:I
+    invoke-virtual {v6, v4}, Landroid/widget/LinearLayout;->setVisibility(I)V
 
-    iput v12, v11, Landroid/widget/LinearLayout$LayoutParams;->height:I
+    invoke-virtual {v5, v7}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    invoke-virtual {v9, v8}, Landroid/widget/LinearLayout;->setVisibility(I)V
+    invoke-virtual {v6, v8}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    invoke-virtual {v6, v10}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
+    :cond_4
+    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mBottomView:Landroid/widget/LinearLayout;
 
-    invoke-virtual {v9, v11}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
+    if-eqz v1, :cond_5
 
-    :cond_6
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mBottomView:Landroid/widget/LinearLayout;
+    const/16 v5, 0x50
 
-    if-eqz v1, :cond_7
+    invoke-virtual {v1, v5}, Landroid/widget/LinearLayout;->setGravity(I)V
 
-    const/16 v6, 0x50
+    invoke-virtual {v1, v3}, Landroid/widget/LinearLayout;->setOrientation(I)V
 
-    invoke-virtual {v1, v6}, Landroid/widget/LinearLayout;->setGravity(I)V
+    :cond_5
+    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mEcaView:Landroid/view/View;
 
-    invoke-virtual {v1, v5}, Landroid/widget/LinearLayout;->setOrientation(I)V
+    if-eqz v1, :cond_6
 
-    :cond_7
-    if-eqz v7, :cond_8
+    invoke-virtual {v1}, Landroid/view/View;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
-    invoke-virtual {v7}, Landroid/view/View;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
+    move-result-object v3
 
-    move-result-object v1
+    check-cast v3, Landroid/view/ViewGroup$MarginLayoutParams;
 
-    check-cast v1, Landroid/view/ViewGroup$MarginLayoutParams;
+    iget v5, v3, Landroid/view/ViewGroup$MarginLayoutParams;->leftMargin:I
 
-    iget v5, v1, Landroid/view/ViewGroup$MarginLayoutParams;->leftMargin:I
+    iget v6, v3, Landroid/view/ViewGroup$MarginLayoutParams;->topMargin:I
 
-    iget v6, v1, Landroid/view/ViewGroup$MarginLayoutParams;->topMargin:I
+    iget v7, v3, Landroid/view/ViewGroup$MarginLayoutParams;->rightMargin:I
 
-    iget v9, v1, Landroid/view/ViewGroup$MarginLayoutParams;->rightMargin:I
+    const v8, 0x7f070508
 
-    invoke-virtual {v0, v3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v0, v8}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v0
 
-    invoke-virtual {v1, v5, v6, v9, v0}, Landroid/view/ViewGroup$MarginLayoutParams;->setMargins(IIII)V
+    invoke-virtual {v3, v5, v6, v7, v0}, Landroid/view/ViewGroup$MarginLayoutParams;->setMargins(IIII)V
 
-    invoke-virtual {v7, v1}, Landroid/view/View;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
+    invoke-virtual {v1, v3}, Landroid/view/View;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    invoke-virtual {v7, v8}, Landroid/view/View;->setVisibility(I)V
+    invoke-virtual {v1, v4}, Landroid/view/View;->setVisibility(I)V
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mEmergencyButtonController:Lcom/android/keyguard/EmergencyButtonController;
 
-    invoke-virtual {v7, v2}, Landroid/view/View;->findViewById(I)Landroid/view/View;
+    const v3, 0x7f0a0397
+
+    invoke-virtual {v1, v3}, Landroid/view/View;->findViewById(I)Landroid/view/View;
 
     move-result-object v1
 
     invoke-virtual {v0, v1}, Lcom/android/keyguard/EmergencyButtonController;->setEmergencyView(Landroid/view/View;)V
 
-    :cond_8
+    :cond_6
     iget-object v0, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mEcaFlexContainer:Landroid/widget/LinearLayout;
 
-    if-eqz v0, :cond_9
+    if-eqz v0, :cond_7
 
     const/16 v1, 0x8
 
     invoke-virtual {v0, v1}, Landroid/widget/LinearLayout;->setVisibility(I)V
 
-    :cond_9
-    invoke-interface {v4}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->is2StepVerification()Z
+    :cond_7
+    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->is2StepVerification()Z
 
     move-result v0
 
-    if-eqz v0, :cond_a
+    if-eqz v0, :cond_8
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardInputViewController;->mSubMessageAreaController:Lcom/android/keyguard/KeyguardSecMessageAreaController;
 
-    if-eqz v0, :cond_a
+    if-eqz v0, :cond_8
 
-    invoke-virtual {v0, v8}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->setVisibility(I)V
+    invoke-virtual {v0, v4}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->setVisibility(I)V
 
-    :cond_a
+    :cond_8
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecPatternViewController;->isHintText()Z
 
     move-result v0
 
-    if-eqz v0, :cond_b
+    if-eqz v0, :cond_9
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mHintText:Lcom/android/keyguard/KeyguardHintTextArea;
 
-    invoke-virtual {v0, v8}, Lcom/android/keyguard/KeyguardHintTextArea;->setVisibility(I)V
+    invoke-virtual {v0, v4}, Lcom/android/keyguard/KeyguardHintTextArea;->setVisibility(I)V
 
-    :cond_b
+    :cond_9
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardInputViewController;->updatePrevInfoTextSize()V
 
     return-void
diff --git a/smali/com/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode.smali b/smali/com/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode.smali
index b0fa1aa4..2ff87318 100644
--- a/smali/com/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode.smali
+++ b/smali/com/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode.smali
@@ -96,7 +96,7 @@
 .end method
 
 .method public final updateSecurityViewPosition(IZ)V
-    .locals 9
+    .locals 8
 
     if-eqz p2, :cond_0
 
@@ -181,45 +181,33 @@
 
     check-cast v2, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    move-result v2
-
-    if-eqz v2, :cond_3
-
-    sget v2, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    goto :goto_2
+    const/4 v2, 0x1
 
-    :cond_3
-    move v2, v3
+    const/4 v4, 0x2
 
-    :goto_2
-    const/4 v4, 0x1
+    if-eqz p1, :cond_4
 
-    const/4 v5, 0x2
+    if-eq p1, v4, :cond_3
 
-    if-eqz p1, :cond_5
+    goto :goto_3
 
-    if-eq p1, v5, :cond_4
+    :cond_3
+    if-ne v0, v2, :cond_5
 
-    goto :goto_4
+    goto :goto_2
 
     :cond_4
-    if-ne v0, v4, :cond_6
+    const/4 v5, 0x3
 
-    goto :goto_3
-
-    :cond_5
-    const/4 v6, 0x3
+    if-ne v0, v5, :cond_5
 
-    if-ne v0, v6, :cond_6
+    :goto_2
+    add-int/lit8 v1, v1, 0x0
 
+    :cond_5
     :goto_3
-    add-int/2addr v1, v2
-
-    :cond_6
-    :goto_4
     move v6, v1
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mView:Landroidx/constraintlayout/widget/ConstraintLayout;
@@ -230,7 +218,7 @@
 
     sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_NAVBAR_ENABLED:Z
 
-    if-eqz v1, :cond_7
+    if-eqz v1, :cond_6
 
     const v1, 0x105024e
 
@@ -238,23 +226,25 @@
 
     move-result v1
 
-    goto :goto_5
+    move v7, v1
 
-    :cond_7
-    move v1, v3
+    goto :goto_4
 
-    :goto_5
-    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mView:Landroidx/constraintlayout/widget/ConstraintLayout;
+    :cond_6
+    move v7, v3
 
-    invoke-virtual {v2}, Landroid/view/ViewGroup;->getContext()Landroid/content/Context;
+    :goto_4
+    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mView:Landroidx/constraintlayout/widget/ConstraintLayout;
 
-    move-result-object v2
+    invoke-virtual {v1}, Landroid/view/ViewGroup;->getContext()Landroid/content/Context;
 
-    invoke-static {v2}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
+    move-result-object v1
 
-    move-result v2
+    invoke-static {v1}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
 
-    if-eqz v2, :cond_8
+    move-result v1
+
+    if-eqz v1, :cond_7
 
     invoke-virtual {v0}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
@@ -270,72 +260,23 @@
 
     move-result v0
 
-    goto :goto_6
+    goto :goto_5
 
-    :cond_8
+    :cond_7
     move v0, v3
 
-    :goto_6
-    const-class v2, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-static {v2}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_9
-
-    sget v2, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
-
-    move-result v7
-
-    if-eqz v7, :cond_a
-
-    iget-object v7, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mView:Landroidx/constraintlayout/widget/ConstraintLayout;
-
-    invoke-virtual {v7}, Landroid/view/ViewGroup;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v7
-
-    const v8, 0x7f0704b0
-
-    invoke-virtual {v7, v8}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v7
-
-    add-int/2addr v2, v7
-
-    goto :goto_7
-
-    :cond_9
-    move v2, v3
-
-    :cond_a
-    :goto_7
-    if-nez v0, :cond_c
-
-    if-nez v2, :cond_b
+    :goto_5
+    const-class v1, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    goto :goto_8
+    invoke-static {v1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    :cond_b
-    move v0, v2
+    move-result-object v1
 
-    goto :goto_9
+    check-cast v1, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    :cond_c
-    :goto_8
-    move v0, v1
+    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    :goto_9
-    if-nez p1, :cond_d
+    if-nez p1, :cond_8
 
     iget-object p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mViewFlipper:Lcom/android/keyguard/KeyguardSecurityViewFlipper;
 
@@ -353,10 +294,10 @@
 
     invoke-virtual/range {v1 .. v6}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
-    goto :goto_a
+    goto :goto_6
 
-    :cond_d
-    if-ne p1, v5, :cond_e
+    :cond_8
+    if-ne p1, v4, :cond_9
 
     iget-object p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mViewFlipper:Lcom/android/keyguard/KeyguardSecurityViewFlipper;
 
@@ -374,16 +315,16 @@
 
     invoke-virtual/range {v1 .. v6}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
-    goto :goto_a
+    goto :goto_6
 
-    :cond_e
+    :cond_9
     iget-object p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mViewFlipper:Lcom/android/keyguard/KeyguardSecurityViewFlipper;
 
     invoke-virtual {p1}, Landroid/widget/ViewFlipper;->getId()I
 
     move-result p1
 
-    invoke-virtual {p2, p1, v4, v3, v4}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
+    invoke-virtual {p2, p1, v2, v3, v2}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
     iget-object p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mViewFlipper:Lcom/android/keyguard/KeyguardSecurityViewFlipper;
 
@@ -391,9 +332,9 @@
 
     move-result p1
 
-    invoke-virtual {p2, p1, v5, v3, v5}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
+    invoke-virtual {p2, p1, v4, v3, v4}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
-    :goto_a
+    :goto_6
     iget-object p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mViewFlipper:Lcom/android/keyguard/KeyguardSecurityViewFlipper;
 
     invoke-virtual {p1}, Landroid/widget/ViewFlipper;->getId()I
@@ -408,7 +349,7 @@
 
     move-object v1, p2
 
-    move v6, v0
+    move v6, v7
 
     invoke-virtual/range {v1 .. v6}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
diff --git a/smali/com/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener.smali b/smali/com/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener.smali
index 8e9cda1f..ec2030cd 100644
--- a/smali/com/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener.smali
+++ b/smali/com/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener.smali
@@ -42,17 +42,15 @@
 
     move-result p1
 
-    const/4 v0, 0x1
+    const/4 v0, 0x0
 
-    const/4 v1, 0x0
-
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_6
 
     sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_NAVBAR_ENABLED:Z
 
     if-eqz p1, :cond_0
 
-    move p1, v1
+    move p1, v0
 
     goto :goto_0
 
@@ -70,162 +68,116 @@
     :goto_0
     invoke-static {}, Landroid/view/WindowInsets$Type;->ime()I
 
-    move-result v2
+    move-result v1
 
-    invoke-virtual {p2, v2}, Landroid/view/WindowInsets;->getInsets(I)Landroid/graphics/Insets;
+    invoke-virtual {p2, v1}, Landroid/view/WindowInsets;->getInsets(I)Landroid/graphics/Insets;
 
-    move-result-object v2
+    move-result-object v1
 
-    iget v2, v2, Landroid/graphics/Insets;->bottom:I
+    iget v1, v1, Landroid/graphics/Insets;->bottom:I
 
-    iget-object v3, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
+    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
 
-    iget v4, v3, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mImeBottom:I
+    iget v3, v2, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mImeBottom:I
 
-    if-eq v4, v2, :cond_6
+    if-eq v3, v1, :cond_5
 
-    iput v2, v3, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mImeBottom:I
+    iput v1, v2, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mImeBottom:I
 
-    if-eqz v2, :cond_1
+    const/4 v3, 0x1
 
-    move v4, v0
+    if-eqz v1, :cond_1
+
+    move v4, v3
 
     goto :goto_1
 
     :cond_1
-    move v4, v1
+    move v4, v0
 
     :goto_1
-    iput-boolean v4, v3, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
+    iput-boolean v4, v2, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
 
-    invoke-virtual {v3}, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->updateLayoutMargins()V
+    invoke-virtual {v2}, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->updateLayoutMargins()V
 
-    iget-object v3, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
+    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
 
-    invoke-virtual {v3}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    invoke-virtual {v2}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    move-result-object v3
+    move-result-object v2
 
     iget-object v4, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
 
     iget v4, v4, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mImeBottom:I
 
-    invoke-virtual {v3}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {v2}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v3
+    move-result-object v2
 
-    invoke-virtual {v3}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    invoke-virtual {v2}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
-    move-result-object v3
+    move-result-object v2
 
-    iget-object v3, v3, Landroid/content/res/Configuration;->windowConfiguration:Landroid/app/WindowConfiguration;
+    iget-object v2, v2, Landroid/content/res/Configuration;->windowConfiguration:Landroid/app/WindowConfiguration;
 
-    invoke-virtual {v3}, Landroid/app/WindowConfiguration;->getRotation()I
+    invoke-virtual {v2}, Landroid/app/WindowConfiguration;->getRotation()I
 
-    move-result v3
+    move-result v2
 
-    invoke-static {v3}, Lcom/android/systemui/util/DeviceState;->getRotation(I)I
+    invoke-static {v2}, Lcom/android/systemui/util/DeviceState;->getRotation(I)I
 
-    move-result v3
+    move-result v2
 
-    if-eq v3, v0, :cond_3
+    if-eq v2, v3, :cond_3
 
     const/4 v5, 0x3
 
-    if-ne v3, v5, :cond_2
+    if-ne v2, v5, :cond_2
 
     goto :goto_2
 
     :cond_2
-    move v0, v1
+    move v3, v0
 
     :cond_3
     :goto_2
-    sget-object v3, Lcom/android/keyguard/SecurityUtils;->sImeHeight:[I
+    sget-object v2, Lcom/android/keyguard/SecurityUtils;->sImeHeight:[I
 
-    aget v5, v3, v0
+    aget v5, v2, v3
 
     if-eqz v5, :cond_4
 
     if-eq v5, v4, :cond_5
 
     :cond_4
-    aput v4, v3, v0
+    aput v4, v2, v3
 
     :cond_5
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_6
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
-
-    iget-object v3, v0, Lcom/android/keyguard/KeyguardSecurityContainerController;->mUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    iget-boolean v0, v0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
-
-    invoke-interface {v3, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->updateSIPShownState(Z)V
-
-    :cond_6
-    invoke-static {p1, v2}, Ljava/lang/Integer;->max(II)I
+    invoke-static {p1, v1}, Ljava/lang/Integer;->max(II)I
 
     move-result p1
 
-    goto :goto_4
-
-    :cond_7
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_9
-
-    invoke-static {}, Landroid/view/WindowInsets$Type;->ime()I
-
-    move-result p1
-
-    invoke-virtual {p2, p1}, Landroid/view/WindowInsets;->getInsets(I)Landroid/graphics/Insets;
-
-    move-result-object p1
-
-    iget p1, p1, Landroid/graphics/Insets;->bottom:I
-
-    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
-
-    iget v3, v2, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mImeBottom:I
-
-    if-eq v3, p1, :cond_9
-
-    iput p1, v2, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mImeBottom:I
-
-    if-eqz p1, :cond_8
-
     goto :goto_3
 
-    :cond_8
-    move v0, v1
-
-    :goto_3
-    iput-boolean v0, v2, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
-
-    iget-object p1, v2, Lcom/android/keyguard/KeyguardSecurityContainerController;->mUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {p1, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->updateSIPShownState(Z)V
+    :cond_6
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_9
-    move p1, v1
+    move p1, v0
 
-    :goto_4
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
+    :goto_3
+    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
 
-    iget-object v0, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, v1, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    move-object v2, v0
+    move-object v2, v1
 
     check-cast v2, Lcom/android/keyguard/KeyguardSecSecurityContainer;
 
-    check-cast v0, Lcom/android/keyguard/KeyguardSecSecurityContainer;
+    check-cast v1, Lcom/android/keyguard/KeyguardSecSecurityContainer;
 
-    invoke-virtual {v0}, Landroid/view/ViewGroup;->getPaddingLeft()I
+    invoke-virtual {v1}, Landroid/view/ViewGroup;->getPaddingLeft()I
 
-    move-result v0
+    move-result v1
 
     iget-object v3, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
 
@@ -247,9 +199,9 @@
 
     move-result p0
 
-    invoke-virtual {v2, v0, v3, p0, p1}, Landroid/view/ViewGroup;->setPadding(IIII)V
+    invoke-virtual {v2, v1, v3, p0, p1}, Landroid/view/ViewGroup;->setPadding(IIII)V
 
-    invoke-virtual {p2, v1, v1, v1, p1}, Landroid/view/WindowInsets;->inset(IIII)Landroid/view/WindowInsets;
+    invoke-virtual {p2, v0, v0, v0, p1}, Landroid/view/WindowInsets;->inset(IIII)Landroid/view/WindowInsets;
 
     move-result-object p0
 
diff --git a/smali/com/android/keyguard/KeyguardSecSecurityContainerController.smali b/smali/com/android/keyguard/KeyguardSecSecurityContainerController.smali
index 3d6fd475..e1821b60 100644
--- a/smali/com/android/keyguard/KeyguardSecSecurityContainerController.smali
+++ b/smali/com/android/keyguard/KeyguardSecSecurityContainerController.smali
@@ -2915,93 +2915,66 @@
 
     move-result v0
 
-    if-eqz v0, :cond_11
+    if-eqz v0, :cond_f
 
-    sget v0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    sget-object v0, Lcom/android/systemui/util/DeviceState;->sDisplaySize:Landroid/graphics/Point;
 
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v1
+    move-result-object v0
 
-    const v6, 0x7f0704b0
+    const v1, 0x7f0704b0
 
-    invoke-virtual {v1, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v0, v1}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v1
+    invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    add-int/2addr v1, v0
+    if-eq p1, v2, :cond_d
 
-    invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    const/4 v0, 0x2
 
-    move-result v0
+    if-eq p1, v0, :cond_d
 
-    if-eqz v0, :cond_c
+    if-eq p1, v4, :cond_d
 
-    invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isHiddenInputContainer()Z
+    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsPassword:Z
 
-    move-result v0
+    if-eqz p1, :cond_c
 
-    if-nez v0, :cond_c
+    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
 
-    move v0, v2
+    if-eqz p1, :cond_c
 
     goto :goto_7
 
     :cond_c
-    move v0, v3
-
-    :goto_7
-    if-eq p1, v2, :cond_f
-
-    const/4 v2, 0x2
-
-    if-eq p1, v2, :cond_f
-
-    if-eq p1, v4, :cond_f
-
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsPassword:Z
-
-    if-eqz p1, :cond_d
-
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
-
-    if-eqz p1, :cond_d
+    iget p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
 
     goto :goto_8
 
     :cond_d
-    if-eqz v0, :cond_e
-
-    goto :goto_9
-
-    :cond_e
-    iget v1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
-
-    goto :goto_9
-
-    :cond_f
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsPassword:Z
 
-    if-eqz p1, :cond_10
+    if-eqz p1, :cond_e
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
 
-    if-eqz p1, :cond_10
+    if-eqz p1, :cond_e
 
-    :goto_8
-    move v1, v3
+    :goto_7
+    move p1, v3
 
-    goto :goto_9
+    goto :goto_8
 
-    :cond_10
-    iget v1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
+    :cond_e
+    iget p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
 
-    :goto_9
-    invoke-virtual {p0, v3, v3, v1}, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->updateLayoutParams(III)V
+    :goto_8
+    invoke-virtual {p0, v3, v3, p1}, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->updateLayoutParams(III)V
 
     return-void
 
-    :cond_11
+    :cond_f
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
     move-result-object v0
@@ -3010,66 +2983,42 @@
 
     move-result v0
 
-    if-nez v0, :cond_12
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez v0, :cond_12
+    if-nez v0, :cond_10
 
     iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNeedsInput:Z
 
-    if-eqz v0, :cond_12
+    if-eqz v0, :cond_10
 
     sget-object v0, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->KNOXGUARD:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
 
-    if-eq v1, v0, :cond_12
+    if-eq v1, v0, :cond_10
 
     move p1, v3
 
     move v0, p1
 
-    goto :goto_f
-
-    :cond_12
-    sget v0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_13
-
-    invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isHiddenInputContainer()Z
-
-    move-result v1
-
-    if-nez v1, :cond_13
-
-    move v1, v2
-
-    goto :goto_a
+    goto :goto_c
 
-    :cond_13
-    move v1, v3
+    :cond_10
+    invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    :goto_a
     invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isHiddenInputContainer()Z
 
-    move-result v5
+    move-result v0
 
-    if-eqz v5, :cond_14
+    if-eqz v0, :cond_11
 
-    move v5, v3
+    move v0, v3
 
-    goto :goto_b
+    goto :goto_9
 
-    :cond_14
-    iget v5, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
+    :cond_11
+    iget v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
 
-    :goto_b
-    if-eq p1, v2, :cond_19
+    :goto_9
+    if-eq p1, v2, :cond_14
 
-    if-eq p1, v4, :cond_17
+    if-eq p1, v4, :cond_14
 
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
 
@@ -3077,66 +3026,40 @@
 
     xor-int/2addr p1, v2
 
-    and-int/2addr p1, v1
-
-    iget-boolean v1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsPassword:Z
+    and-int/2addr p1, v3
 
-    if-eqz v1, :cond_15
+    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsPassword:Z
 
-    iget-boolean v1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
+    if-eqz v0, :cond_12
 
-    if-eqz v1, :cond_15
+    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
 
-    move v0, v3
+    if-eqz v0, :cond_12
 
-    goto :goto_c
+    goto :goto_a
 
-    :cond_15
-    if-eqz p1, :cond_16
+    :cond_12
+    if-eqz p1, :cond_13
 
-    goto :goto_c
+    :goto_a
+    move p1, v3
 
-    :cond_16
-    iget v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
+    goto :goto_b
 
-    :goto_c
-    move p1, v0
+    :cond_13
+    iget p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
 
+    :goto_b
     move v0, v3
 
-    goto :goto_f
-
-    :cond_17
-    if-eqz v1, :cond_18
-
-    goto :goto_d
-
-    :cond_18
-    move v0, v5
-
-    :goto_d
-    move v7, v5
-
-    move v5, v0
-
-    move v0, v7
-
-    goto :goto_e
-
-    :cond_19
-    if-eqz v1, :cond_1a
-
-    goto :goto_e
-
-    :cond_1a
-    move v0, v5
+    goto :goto_c
 
-    :goto_e
+    :cond_14
     move p1, v3
 
-    move v3, v5
+    move v3, v0
 
-    :goto_f
+    :goto_c
     invoke-virtual {p0, v3, v0, p1}, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->updateLayoutParams(III)V
 
     return-void
diff --git a/smali/com/android/keyguard/KeyguardSecUpdateMonitor.smali b/smali/com/android/keyguard/KeyguardSecUpdateMonitor.smali
index f4906c73..2ac804ee 100644
--- a/smali/com/android/keyguard/KeyguardSecUpdateMonitor.smali
+++ b/smali/com/android/keyguard/KeyguardSecUpdateMonitor.smali
@@ -598,12 +598,10 @@
     return p0
 .end method
 
-.method public isInDisplayFingerprintMarginAccepted()Z
+.method public isInDisplayFingerprintMarginAccepted()V
     .locals 0
 
-    const/4 p0, 0x0
-
-    return p0
+    return-void
 .end method
 
 .method public isKeyguardUnlocking()Z
@@ -932,6 +930,12 @@
     return-void
 .end method
 
+.method public setShowingKeepScreenOnPopup(Z)V
+    .locals 0
+
+    return-void
+.end method
+
 .method public setUnlockingKeyguard(Z)V
     .locals 0
 
@@ -980,12 +984,6 @@
     return-void
 .end method
 
-.method public updateSIPShownState(Z)V
-    .locals 0
-
-    return-void
-.end method
-
 .method public updateUserUnlockNotification(I)V
     .locals 0
 
diff --git a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda6.smali b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda6.smali
index a9c15b97..12eb3791 100644
--- a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda6.smali
+++ b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda6.smali
@@ -28,12 +28,10 @@
 
 # virtual methods
 .method public final onChanged(Landroid/net/Uri;)V
-    .locals 1
+    .locals 0
 
     iget p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda6;->$r8$classId:I
 
-    const/4 v0, 0x2
-
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda6;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     packed-switch p1, :pswitch_data_0
@@ -58,22 +56,21 @@
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchLockModeChanged()V
 
     :cond_0
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_1
-
-    invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_1
     return-void
 
     :goto_0
-    invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    const/4 p1, 0x2
+
+    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
 
     sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     return-void
 
+    nop
+
     :pswitch_data_0
     .packed-switch 0x0
         :pswitch_0
diff --git a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7.smali b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7.smali
index 6e2be652..56d574c3 100644
--- a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7.smali
+++ b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7.smali
@@ -32,20 +32,21 @@
 
     iget v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->$r8$classId:I
 
-    const/4 v1, 0x0
+    const/4 v1, 0x2
 
-    const/4 v2, 0x2
+    const/4 v2, 0x0
 
     packed-switch v0, :pswitch_data_0
 
+    :pswitch_0
     goto/16 :goto_0
 
-    :pswitch_0
+    :pswitch_1
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFastUnlockController:Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;
 
-    new-array v0, v1, [Ljava/lang/Object;
+    new-array v0, v2, [Ljava/lang/Object;
 
     const-string v1, "onFpAuthenticationSucceeded end"
 
@@ -53,7 +54,7 @@
 
     return-void
 
-    :pswitch_1
+    :pswitch_2
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFaceOptionEnabled()Z
@@ -73,7 +74,7 @@
     invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->stopListeningForFace(Lcom/android/keyguard/FaceAuthUiEvent;)V
 
     :cond_0
-    invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFaceAuthenticated(Z)V
+    invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFaceAuthenticated(Z)V
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFaceManager:Landroid/hardware/face/FaceManager;
 
@@ -92,12 +93,12 @@
     :cond_1
     return-void
 
-    :pswitch_2
+    :pswitch_3
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFastUnlockController:Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;
 
-    new-array v0, v1, [Ljava/lang/Object;
+    new-array v0, v2, [Ljava/lang/Object;
 
     const-string v1, "onFaceAuthenticationSucceeded end"
 
@@ -105,7 +106,7 @@
 
     return-void
 
-    :pswitch_3
+    :pswitch_4
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mDeviceInteractive:Z
@@ -154,7 +155,7 @@
     :cond_3
     return-void
 
-    :pswitch_4
+    :pswitch_5
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mLooperSlowLogController:Lcom/android/systemui/uithreadmonitor/LooperSlowLogController;
@@ -179,7 +180,7 @@
 
     return-void
 
-    :pswitch_5
+    :pswitch_6
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mLooperSlowLogController:Lcom/android/systemui/uithreadmonitor/LooperSlowLogController;
@@ -204,32 +205,25 @@
 
     return-void
 
-    :pswitch_6
+    :pswitch_7
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     sget-object v0, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_FULL_SCREEN_FACE_WIDGET:Lcom/android/keyguard/FaceAuthUiEvent;
 
-    invoke-virtual {p0, v2, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateBiometricListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
+    invoke-virtual {p0, v1, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateBiometricListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
     return-void
 
-    :pswitch_7
+    :pswitch_8
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     sget-object v0, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_WINDOW_FOCUS_CHANGED:Lcom/android/keyguard/FaceAuthUiEvent;
 
-    invoke-virtual {p0, v2, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
-
-    return-void
-
-    :pswitch_8
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
-
-    invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    invoke-virtual {p0, v1, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
     return-void
 
@@ -261,19 +255,14 @@
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string v0, "KeyguardFingerprint"
-
-    const-string v1, "Waiting window focus change"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+    const-string p0, "KeyguardFingerprint"
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    const-string v0, "Waiting window focus change"
 
-    if-eqz v0, :cond_4
+    invoke-static {p0, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_4
     return-void
 
     :goto_0
@@ -283,16 +272,19 @@
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
 
-    move-result-wide v2
+    move-result-wide v0
 
-    invoke-virtual {p0, v2, v3, v1, v1}, Landroid/os/PowerManager;->userActivity(JII)V
+    invoke-virtual {p0, v0, v1, v2, v2}, Landroid/os/PowerManager;->userActivity(JII)V
 
     return-void
 
+    nop
+
     :pswitch_data_0
     .packed-switch 0x0
         :pswitch_a
         :pswitch_9
+        :pswitch_0
         :pswitch_8
         :pswitch_7
         :pswitch_6
@@ -301,6 +293,5 @@
         :pswitch_3
         :pswitch_2
         :pswitch_1
-        :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda9.smali b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda9.smali
index 01e45f38..3da77b4f 100644
--- a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda9.smali
+++ b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda9.smali
@@ -40,26 +40,15 @@
 
     const/4 v1, 0x1
 
-    if-ne p1, v1, :cond_2
+    if-ne p1, v1, :cond_1
 
     :cond_0
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-eqz p1, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_1
-
-    invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
-
-    :cond_1
     sget-object p1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_COCKTAIL_BAR_SHOWING_CHANGED:Lcom/android/keyguard/FaceAuthUiEvent;
 
     invoke-virtual {p0, v0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
-    :cond_2
+    :cond_1
     return-void
 .end method
diff --git a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl.smali b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl.smali
index af6afc59..5133a943 100644
--- a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl.smali
+++ b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl.smali
@@ -72,8 +72,6 @@
 
 .field public mForceStartFinger:Z
 
-.field public mFpInDisplayState:I
-
 .field public final mFpMessages:Ljava/util/concurrent/ConcurrentLinkedQueue;
 
 .field public final mFpMsgConsumer:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda8;
@@ -102,8 +100,6 @@
 
 .field public mIsEarlyWakeUp:Z
 
-.field public mIsFODStrictMode:Z
-
 .field public mIsFPCanceledByForegroundApp:Z
 
 .field public mIsFPCanceledByProximity:Z
@@ -122,8 +118,6 @@
 
 .field public mIsOwnerInfoEnabled:Z
 
-.field public mIsPanelExpandingStarted:Z
-
 .field public mIsQsFullyExpanded:Z
 
 .field public mIsRunningBlackMemo:Z
@@ -184,8 +178,6 @@
 
 .field public mRemoteLockSimulationInfo:Lcom/android/internal/widget/RemoteLockInfo;
 
-.field public mSIPShown:Z
-
 .field public final mSecureLockChangedCallback:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$2;
 
 .field public mSemFaceCancelSignal:Landroid/os/CancellationSignal;
@@ -216,8 +208,6 @@
 
 .field public final mWaitingFocusRunnable:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
 
-.field public final mWindowManagerService:Landroid/view/IWindowManager;
-
 
 # direct methods
 .method public constructor <init>(Lcom/android/internal/app/IBatteryStats;Landroid/app/NotificationManager;Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;Lcom/android/systemui/uithreadmonitor/BinderCallMonitor;Lcom/android/systemui/uithreadmonitor/LooperSlowLogController;Lcom/android/systemui/util/SettingsHelper;Landroid/app/AlarmManager;Landroid/os/PowerManager;Ldagger/Lazy;Ldagger/Lazy;Ldagger/Lazy;Ldagger/Lazy;Landroid/view/IWindowManager;Landroid/content/Context;Lcom/android/systemui/settings/UserTracker;Landroid/os/Looper;Lcom/android/systemui/broadcast/BroadcastDispatcher;Lcom/android/systemui/util/settings/SecureSettings;Lcom/android/systemui/dump/DumpManager;Ljava/util/concurrent/Executor;Ljava/util/concurrent/Executor;Lcom/android/systemui/plugins/statusbar/StatusBarStateController;Lcom/android/internal/widget/LockPatternUtils;Lcom/android/systemui/biometrics/AuthController;Lcom/android/systemui/telephony/TelephonyListenerManager;Lcom/android/internal/jank/InteractionJankMonitor;Lcom/android/internal/util/LatencyTracker;Lcom/android/keyguard/ActiveUnlockConfig;Lcom/android/keyguard/logging/KeyguardUpdateMonitorLogger;Lcom/android/internal/logging/UiEventLogger;Ljavax/inject/Provider;Landroid/app/trust/TrustManager;Landroid/telephony/SubscriptionManager;Landroid/os/UserManager;Landroid/service/dreams/IDreamManager;Landroid/app/admin/DevicePolicyManager;Landroid/hardware/SensorPrivacyManager;Landroid/telephony/TelephonyManager;Landroid/content/pm/PackageManager;Landroid/hardware/face/FaceManager;Landroid/hardware/fingerprint/FingerprintManager;Landroid/hardware/biometrics/BiometricManager;Lcom/android/keyguard/FaceWakeUpTriggersConfig;Landroid/telephony/CarrierConfigManager;Lcom/android/systemui/statusbar/policy/DevicePostureController;Ljava/util/Optional;)V
@@ -488,12 +478,8 @@
 
     iput-object v1, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mESimRemoved:[Z
 
-    iput v4, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpInDisplayState:I
-
     iput-boolean v4, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
 
-    iput-boolean v4, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsPanelExpandingStarted:Z
-
     iput v4, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mCocktailBarWindowType:I
 
     new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda6;
@@ -918,15 +904,8 @@
 
     invoke-virtual {v5, v0, v1}, Lcom/android/systemui/broadcast/BroadcastDispatcher;->registerReceiver(Landroid/content/IntentFilter;Landroid/content/BroadcastReceiver;)V
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_3
-
-    move-object/from16 v1, p13
-
-    iput-object v1, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWindowManagerService:Landroid/view/IWindowManager;
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_3
     return-void
 .end method
 
@@ -1084,9 +1063,7 @@
 
     invoke-virtual {v1, v0}, Landroid/util/SparseIntArray;->delete(I)V
 
-    const/4 v1, 0x0
-
-    invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFodStrictMode(Z)V
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_1
     const-class v1, Lcom/android/systemui/UiOffloadThread;
@@ -4552,6 +4529,46 @@
     return-void
 .end method
 
+.method public final handleDlsBiometricMode(Z)V
+    .locals 2
+
+    const-string v0, "handleDlsBiometricMode(), enabled="
+
+    const-string v1, "KeyguardUpdateMonitor"
+
+    invoke-static {v0, p1, v1}, Lcom/android/keyguard/KeyguardCarrierPasswordViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ZLjava/lang/String;)V
+
+    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDynamicLockViewMode:Z
+
+    if-eq v0, p1, :cond_1
+
+    iput-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDynamicLockViewMode:Z
+
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
+
+    move-result p1
+
+    const/4 v0, 0x2
+
+    if-eqz p1, :cond_0
+
+    invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+
+    :cond_0
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFaceOptionEnabled()Z
+
+    move-result p1
+
+    if-eqz p1, :cond_1
+
+    sget-object p1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_DYNAMIC_LOCK:Lcom/android/keyguard/FaceAuthUiEvent;
+
+    invoke-virtual {p0, v0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
+
+    :cond_1
+    return-void
+.end method
+
 .method public final handleDlsViewMode(I)V
     .locals 2
 
@@ -4798,25 +4815,8 @@
     sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :goto_0
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_1
-
-    iget v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mFingerprintRunningState:I
-
-    const/4 v1, 0x1
-
-    if-ne v0, v1, :cond_1
-
-    const-string v0, "KeyguardFingerprint"
-
-    const-string v1, "Face onAuthenticationSucceeded. FP will be stop!"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->stopListeningForFingerprint()V
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_1
     new-instance v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda18;
 
     const/4 v1, 0x0
@@ -4839,11 +4839,11 @@
 
     sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
 
-    if-eqz p1, :cond_2
+    if-eqz p1, :cond_1
 
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubBioAuth:Z
 
-    :cond_2
+    :cond_1
     return-void
 .end method
 
@@ -5450,17 +5450,17 @@
 
     iget-boolean v3, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
 
-    const-string v4, "KeyguardFingerprint"
+    const/4 v4, 0x0
 
-    const/4 v5, 0x0
+    const-string v5, "KeyguardFingerprint"
 
     if-eqz v3, :cond_0
 
-    iput-boolean v5, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+    iput-boolean v4, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
 
     const-string v0, "handleFingerprintHelp( skipped FP response )"
 
-    invoke-static {v4, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
     return-void
 
@@ -5479,7 +5479,7 @@
 
     const-string v1, "handleFingerprintHelp( unlock is not allowed. )"
 
-    invoke-static {v4, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->stopListeningForFingerprint()V
 
@@ -5500,20 +5500,20 @@
 
     if-nez v7, :cond_2
 
-    if-eq v1, v8, :cond_11
+    if-eq v1, v8, :cond_12
 
     iget-object v2, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mPowerManager:Landroid/os/PowerManager;
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
 
-    move-result-wide v6
+    move-result-wide v5
 
-    invoke-virtual {v2, v6, v7, v5, v5}, Landroid/os/PowerManager;->userActivity(JII)V
+    invoke-virtual {v2, v5, v6, v4, v4}, Landroid/os/PowerManager;->userActivity(JII)V
 
     goto/16 :goto_7
 
     :cond_2
-    if-eq v1, v8, :cond_13
+    if-eq v1, v8, :cond_14
 
     const/16 v7, 0x3ed
 
@@ -5536,7 +5536,7 @@
 
     move-result v2
 
-    invoke-virtual {v1, v2, v5}, Landroid/util/SparseIntArray;->get(II)I
+    invoke-virtual {v1, v2, v4}, Landroid/util/SparseIntArray;->get(II)I
 
     move-result v1
 
@@ -5564,7 +5564,7 @@
 
     const-string v6, " )"
 
-    invoke-static {v2, v6, v4}, Landroidx/exifinterface/media/ExifInterface$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v2, v6, v5}, Landroidx/exifinterface/media/ExifInterface$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
 
     const/16 v2, 0x32
 
@@ -5595,7 +5595,7 @@
     goto :goto_0
 
     :cond_4
-    move v3, v5
+    move v3, v4
 
     :goto_0
     if-eqz v3, :cond_5
@@ -5632,19 +5632,19 @@
 
     invoke-direct {v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda23;-><init>()V
 
-    const v4, 0x7f13087d
+    const v5, 0x7f13087d
 
-    invoke-virtual {v2, v4, v3}, Lcom/android/systemui/statusbar/phone/SystemUIDialog;->setPositiveButton(ILandroid/content/DialogInterface$OnClickListener;)V
+    invoke-virtual {v2, v5, v3}, Lcom/android/systemui/statusbar/phone/SystemUIDialog;->setPositiveButton(ILandroid/content/DialogInterface$OnClickListener;)V
 
     new-instance v13, Landroid/widget/CheckBox;
 
     new-instance v3, Landroid/view/ContextThemeWrapper;
 
-    iget-object v4, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mContext:Landroid/content/Context;
+    iget-object v5, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mContext:Landroid/content/Context;
 
     const v6, 0x7f140560
 
-    invoke-direct {v3, v4, v6}, Landroid/view/ContextThemeWrapper;-><init>(Landroid/content/Context;I)V
+    invoke-direct {v3, v5, v6}, Landroid/view/ContextThemeWrapper;-><init>(Landroid/content/Context;I)V
 
     invoke-direct {v13, v3}, Landroid/widget/CheckBox;-><init>(Landroid/content/Context;)V
 
@@ -5662,7 +5662,7 @@
 
     move-result v3
 
-    invoke-virtual {v13, v3, v5, v5, v5}, Landroid/widget/CheckBox;->setPadding(IIII)V
+    invoke-virtual {v13, v3, v4, v4, v4}, Landroid/widget/CheckBox;->setPadding(IIII)V
 
     new-instance v3, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda24;
 
@@ -5688,7 +5688,7 @@
 
     invoke-virtual/range {v12 .. v17}, Landroid/app/AlertDialog;->setView(Landroid/view/View;IIII)V
 
-    invoke-virtual {v2, v5}, Landroid/app/AlertDialog;->setCancelable(Z)V
+    invoke-virtual {v2, v4}, Landroid/app/AlertDialog;->setCancelable(Z)V
 
     invoke-virtual {v2}, Landroid/app/AlertDialog;->show()V
 
@@ -5697,12 +5697,12 @@
     :cond_5
     const-string v1, "Skip to show fingerprint sensor block popup"
 
-    invoke-static {v4, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     :goto_1
     invoke-virtual {v0, v7}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
 
-    invoke-virtual {v0, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFodStrictMode(Z)V
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     goto :goto_2
 
@@ -5711,7 +5711,7 @@
 
     if-ne v1, v2, :cond_7
 
-    invoke-virtual {v0, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFodStrictMode(Z)V
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_7
     :goto_2
@@ -5763,21 +5763,21 @@
 
     move-result-object v12
 
-    invoke-static {v4, v12}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v12}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getFailedBiometricUnlockAttempts(I)I
 
-    move-result v4
+    move-result v5
 
     const/4 v12, 0x3
 
-    if-ne v4, v12, :cond_a
+    if-ne v5, v12, :cond_a
 
-    iget-object v4, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mKeyguardBatteryStatus:Lcom/android/systemui/statusbar/KeyguardBatteryStatus;
+    iget-object v5, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mKeyguardBatteryStatus:Lcom/android/systemui/statusbar/KeyguardBatteryStatus;
 
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    sget-object v4, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-object v5, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_a
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getFailedBiometricUnlockAttempts(I)I
@@ -5793,11 +5793,11 @@
 
     if-nez v2, :cond_c
 
-    move v5, v3
+    move v4, v3
 
     :cond_c
     :goto_3
-    if-eqz v5, :cond_10
+    if-eqz v4, :cond_11
 
     new-instance v2, Lcom/samsung/android/aod/AODToast$Builder;
 
@@ -5839,15 +5839,17 @@
 
     move-result-object v6
 
-    if-eqz v8, :cond_d
+    if-eqz v8, :cond_e
 
-    sget-object v5, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v5, :cond_d
 
     invoke-static {v6}, Landroidx/constraintlayout/core/ArrayLinkedVariables$$ExternalSyntheticOutline0;->m(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     move-result-object v5
 
-    const v6, 0x7f13096c
+    const v6, 0x7f13096d
 
     invoke-virtual {v4, v6}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
@@ -5862,6 +5864,25 @@
     goto :goto_5
 
     :cond_d
+    invoke-static {v6}, Landroidx/constraintlayout/core/ArrayLinkedVariables$$ExternalSyntheticOutline0;->m(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    const v6, 0x7f13096c
+
+    invoke-virtual {v4, v6}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    goto :goto_5
+
+    :cond_e
     sget-object v8, Lcom/android/keyguard/KeyguardTextBuilder$2;->$SwitchMap$com$android$keyguard$KeyguardSecurityModel$SecurityMode:[I
 
     invoke-virtual {v5}, Ljava/lang/Enum;->ordinal()I
@@ -5870,9 +5891,9 @@
 
     aget v5, v8, v5
 
-    if-eq v5, v3, :cond_f
+    if-eq v5, v3, :cond_10
 
-    if-eq v5, v7, :cond_e
+    if-eq v5, v7, :cond_f
 
     const v5, 0x7f13096a
 
@@ -5882,7 +5903,7 @@
 
     goto :goto_4
 
-    :cond_e
+    :cond_f
     const v5, 0x7f130969
 
     invoke-virtual {v4, v5}, Landroid/content/Context;->getString(I)Ljava/lang/String;
@@ -5891,7 +5912,7 @@
 
     goto :goto_4
 
-    :cond_f
+    :cond_10
     const v5, 0x7f13096b
 
     invoke-virtual {v4, v5}, Landroid/content/Context;->getString(I)Ljava/lang/String;
@@ -5908,11 +5929,11 @@
 
     goto :goto_6
 
-    :cond_10
+    :cond_11
     move-object v2, v9
 
     :goto_6
-    if-eqz v2, :cond_11
+    if-eqz v2, :cond_12
 
     const-wide/16 v10, 0x2710
 
@@ -5930,7 +5951,7 @@
 
     invoke-virtual {v4, v2}, Lcom/samsung/android/aod/AODManager;->requestAODToast(Lcom/samsung/android/aod/AODToast;)V
 
-    :cond_11
+    :cond_12
     :goto_7
     new-instance v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda16;
 
@@ -5950,18 +5971,18 @@
 
     iget-object v0, v0, Lcom/android/systemui/doze/PluginAODManager;->mAODPlugin:Lcom/android/systemui/plugins/aod/PluginAOD;
 
-    if-eqz v0, :cond_12
+    if-eqz v0, :cond_13
 
     invoke-interface {v0, v10, v11}, Lcom/android/systemui/plugins/aod/PluginAOD;->hideChargingInfoByFinger(J)V
 
-    :cond_12
+    :cond_13
     return-void
 
-    :cond_13
+    :cond_14
     :goto_8
     const-string v0, "handleFingerprintHelp( skip TSP block/unblock )"
 
-    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return-void
 .end method
@@ -6067,6 +6088,35 @@
     return-void
 .end method
 
+.method public final handlePackageDataCleared(Ljava/lang/String;)V
+    .locals 2
+
+    const-string v0, "com.android.settings"
+
+    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v0
+
+    if-eqz v0, :cond_0
+
+    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSettingsHelper:Lcom/android/systemui/util/SettingsHelper;
+
+    invoke-virtual {v0}, Lcom/android/systemui/util/SettingsHelper;->readSettingsDB()V
+
+    :cond_0
+    new-instance v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda22;
+
+    const/4 v1, 0x0
+
+    invoke-direct {v0, p1, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda22;-><init>(Ljava/lang/String;I)V
+
+    const/4 p1, 0x0
+
+    invoke-virtual {p0, p1, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
+
+    return-void
+.end method
+
 .method public final handlePackageRemoved(Ljava/lang/String;Z)V
     .locals 2
 
@@ -6290,32 +6340,21 @@
     invoke-virtual {p0, v3, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
     :cond_9
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_a
-
-    iget-object p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpm:Landroid/hardware/fingerprint/FingerprintManager;
-
-    if-eqz p1, :cond_a
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
-
-    invoke-virtual {p1, v0}, Landroid/hardware/fingerprint/FingerprintManager;->semShowBouncerScreen(I)I
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_a
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isKeyguardVisible()Z
 
     move-result p1
 
-    if-nez p1, :cond_b
+    if-nez p1, :cond_a
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    if-nez p1, :cond_b
+    if-nez p1, :cond_a
 
     invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setUnlockingKeyguard(Z)V
 
-    :cond_b
+    :cond_a
     invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setShortcutLaunchInProgress(Z)V
 
     sget-object p1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_PRIMARY_BOUNCER_SHOWN:Lcom/android/keyguard/FaceAuthUiEvent;
@@ -6324,7 +6363,7 @@
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    if-eqz p1, :cond_c
+    if-eqz p1, :cond_b
 
     sget-object p1, Lcom/android/systemui/util/SystemUIAnalytics;->sCurrentScreenID:Ljava/lang/String;
 
@@ -6334,7 +6373,7 @@
 
     invoke-static {p1, p2, v0}, Lcom/android/systemui/util/SystemUIAnalytics;->sendEventLog(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
 
-    :cond_c
+    :cond_b
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mPluginAODManagerLazy:Ldagger/Lazy;
 
     invoke-interface {p0}, Ldagger/Lazy;->get()Ljava/lang/Object;
@@ -6380,6 +6419,50 @@
     return-void
 .end method
 
+.method public final handleReconnectPluginFaceWidget()V
+    .locals 7
+
+    sget-boolean v0, Landroid/os/Build;->IS_USERDEBUG:Z
+
+    if-nez v0, :cond_0
+
+    sget-boolean v0, Landroid/os/Build;->IS_ENG:Z
+
+    if-eqz v0, :cond_1
+
+    :cond_0
+    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mPluginFaceWidgetManagerLazy:Ldagger/Lazy;
+
+    invoke-interface {p0}, Ldagger/Lazy;->get()Ljava/lang/Object;
+
+    move-result-object p0
+
+    move-object v2, p0
+
+    check-cast v2, Lcom/android/systemui/facewidget/plugin/PluginFaceWidgetManager;
+
+    iget-object p0, v2, Lcom/android/systemui/facewidget/plugin/PluginFaceWidgetManager;->mPluginManager:Lcom/android/systemui/plugins/PluginManager;
+
+    invoke-interface {p0, v2}, Lcom/android/systemui/plugins/PluginManager;->removePluginListener(Lcom/android/systemui/plugins/PluginListener;)V
+
+    iget-object v0, v2, Lcom/android/systemui/facewidget/plugin/PluginFaceWidgetManager;->mPluginManager:Lcom/android/systemui/plugins/PluginManager;
+
+    const-string v1, "com.samsung.systemui.action.PLUGIN_FACE_WIDGET"
+
+    const-class v3, Lcom/android/systemui/plugins/keyguardstatusview/PluginKeyguardStatusView;
+
+    const/4 v4, 0x0
+
+    const/4 v5, 0x1
+
+    const/4 v6, 0x0
+
+    invoke-interface/range {v0 .. v6}, Lcom/android/systemui/plugins/PluginManager;->addPluginListener(Ljava/lang/String;Lcom/android/systemui/plugins/PluginListener;Ljava/lang/Class;ZZI)V
+
+    :cond_1
+    return-void
+.end method
+
 .method public final handleSecMessage(Landroid/os/Message;)V
     .locals 25
 
@@ -6425,21 +6508,25 @@
 
     packed-switch v2, :pswitch_data_1
 
-    const/4 v4, 0x5
+    const/4 v4, -0x1
 
-    const/4 v5, -0x1
+    const/4 v5, 0x5
 
     packed-switch v2, :pswitch_data_2
 
     packed-switch v2, :pswitch_data_3
 
+    const/4 v3, 0x0
+
     packed-switch v2, :pswitch_data_4
 
+    const/4 v3, 0x0
+
     packed-switch v2, :pswitch_data_5
 
     packed-switch v2, :pswitch_data_6
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_0
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getLockoutAttemptDeadline()J
@@ -6464,7 +6551,7 @@
 
     invoke-virtual {v0, v6}, Lcom/android/systemui/util/DesktopManagerImpl;->notifyKeyguardLockout(Z)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :cond_0
     invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J
@@ -6475,13 +6562,13 @@
 
     cmp-long v3, v1, v3
 
-    if-lez v3, :cond_68
+    if-lez v3, :cond_67
 
     iget-object v0, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
 
     invoke-virtual {v0, v7, v1, v2}, Landroid/os/Handler;->sendEmptyMessageDelayed(IJ)Z
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_1
     iget v1, v1, Landroid/os/Message;->arg1:I
@@ -6561,41 +6648,16 @@
     invoke-virtual {v0, v6, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
     :cond_3
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v1, :cond_4
-
-    iget-boolean v1, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardShowing:Z
-
-    if-eqz v1, :cond_4
-
-    iget-object v1, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
-
-    iget-object v2, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWaitingFocusRunnable:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
-
-    invoke-virtual {v1, v2}, Landroid/os/Handler;->hasCallbacks(Ljava/lang/Runnable;)Z
-
-    move-result v1
-
-    if-nez v1, :cond_4
-
-    iget-object v1, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
-
-    iget-object v0, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWaitingFocusRunnable:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
-
-    const-wide/16 v2, 0x1f4
-
-    invoke-virtual {v1, v0, v2, v3}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_4
     invoke-static {}, Landroid/os/Trace;->endSection()V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_2
     invoke-virtual {v0, v6}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setIsRunningBlackMemo(Z)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_3
     new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda10;
@@ -6604,12 +6666,12 @@
 
     invoke-virtual {v0, v11, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_4
     invoke-virtual {v0, v11}, Lcom/android/keyguard/KeyguardUpdateMonitor;->callbacksRefreshCarrierInfo(Landroid/content/Intent;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_5
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -6634,20 +6696,20 @@
 
     move-result v2
 
-    if-eqz v2, :cond_5
+    if-eqz v2, :cond_4
 
     sget-object v2, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_STOPPED_PREV_CREDENTIAL_VIEW:Lcom/android/keyguard/FaceAuthUiEvent;
 
     invoke-virtual {v0, v5, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateBiometricListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
-    :cond_5
+    :cond_4
     new-instance v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda19;
 
     invoke-direct {v2, v1, v6}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda19;-><init>(Ljava/lang/Object;I)V
 
     invoke-virtual {v0, v11, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_6
     new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda10;
@@ -6656,7 +6718,7 @@
 
     invoke-virtual {v0, v11, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_7
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -6681,7 +6743,7 @@
 
     move-result v3
 
-    if-eqz v3, :cond_6
+    if-eqz v3, :cond_5
 
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateLockscreenDisabled(I)Z
 
@@ -6691,7 +6753,7 @@
 
     goto :goto_0
 
-    :cond_6
+    :cond_5
     move v3, v6
 
     :goto_0
@@ -6699,7 +6761,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_7
+    if-eqz v4, :cond_6
 
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateCredentialType(I)Z
 
@@ -6709,7 +6771,7 @@
 
     goto :goto_1
 
-    :cond_7
+    :cond_6
     move v4, v6
 
     :goto_1
@@ -6717,7 +6779,7 @@
 
     move-result v7
 
-    if-eqz v7, :cond_8
+    if-eqz v7, :cond_7
 
     invoke-virtual {v0, v2, v6}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFMMLock(IZ)Z
 
@@ -6725,12 +6787,12 @@
 
     or-int/2addr v4, v7
 
-    :cond_8
+    :cond_7
     invoke-static {v1, v10}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->containsFlag(II)Z
 
     move-result v7
 
-    if-eqz v7, :cond_9
+    if-eqz v7, :cond_8
 
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateCarrierLock(I)Z
 
@@ -6738,14 +6800,14 @@
 
     or-int/2addr v4, v7
 
-    :cond_9
+    :cond_8
     const/16 v7, 0x10
 
     invoke-static {v1, v7}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->containsFlag(II)Z
 
     move-result v7
 
-    if-eqz v7, :cond_a
+    if-eqz v7, :cond_9
 
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateBiometricsOptionState(I)Z
 
@@ -6753,14 +6815,14 @@
 
     or-int/2addr v4, v7
 
-    :cond_a
+    :cond_9
     const/16 v7, 0x20
 
     invoke-static {v1, v7}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->containsFlag(II)Z
 
     move-result v7
 
-    if-eqz v7, :cond_b
+    if-eqz v7, :cond_a
 
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateSecureLockTimeout(I)Z
 
@@ -6768,14 +6830,14 @@
 
     or-int/2addr v4, v7
 
-    :cond_b
+    :cond_a
     const/16 v7, 0x40
 
     invoke-static {v1, v7}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->containsFlag(II)Z
 
     move-result v7
 
-    if-eqz v7, :cond_c
+    if-eqz v7, :cond_b
 
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateBiometricLockTimeout(I)Z
 
@@ -6783,12 +6845,12 @@
 
     or-int/2addr v4, v7
 
-    :cond_c
+    :cond_b
     invoke-static {v1, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->containsFlag(II)Z
 
     move-result v7
 
-    if-eqz v7, :cond_1b
+    if-eqz v7, :cond_1a
 
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateCredentialType(I)Z
 
@@ -6812,22 +6874,22 @@
 
     or-int/2addr v7, v8
 
-    if-nez v7, :cond_e
+    if-nez v7, :cond_d
 
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateBiometricsOptionState(I)Z
 
     move-result v7
 
-    if-eqz v7, :cond_d
+    if-eqz v7, :cond_c
 
     goto :goto_2
 
-    :cond_d
+    :cond_c
     move v7, v6
 
     goto :goto_3
 
-    :cond_e
+    :cond_d
     :goto_2
     move v7, v5
 
@@ -6885,21 +6947,21 @@
 
     and-int/2addr v10, v12
 
-    if-eqz v10, :cond_f
+    if-eqz v10, :cond_e
 
     move v10, v5
 
     goto :goto_4
 
-    :cond_f
+    :cond_e
     move v10, v6
 
     :goto_4
-    if-eqz v10, :cond_10
+    if-eqz v10, :cond_f
 
     invoke-virtual {v7}, Ljava/lang/Object;->toString()Ljava/lang/String;
 
-    :cond_10
+    :cond_f
     iget-object v12, v8, Landroidx/localbroadcastmanager/content/LocalBroadcastManager;->mActions:Ljava/util/HashMap;
 
     invoke-virtual {v7}, Landroid/content/Intent;->getAction()Ljava/lang/String;
@@ -6914,19 +6976,19 @@
 
     check-cast v15, Ljava/util/ArrayList;
 
-    if-eqz v15, :cond_1a
+    if-eqz v15, :cond_19
 
-    if-eqz v10, :cond_11
+    if-eqz v10, :cond_10
 
     invoke-virtual {v15}, Ljava/lang/Object;->toString()Ljava/lang/String;
 
-    :cond_11
+    :cond_10
     :goto_5
     invoke-virtual {v15}, Ljava/util/ArrayList;->size()I
 
     move-result v12
 
-    if-ge v6, v12, :cond_17
+    if-ge v6, v12, :cond_16
 
     invoke-virtual {v15, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
@@ -6936,22 +6998,22 @@
 
     check-cast v14, Landroidx/localbroadcastmanager/content/LocalBroadcastManager$ReceiverRecord;
 
-    if-eqz v10, :cond_12
+    if-eqz v10, :cond_11
 
     iget-object v12, v14, Landroidx/localbroadcastmanager/content/LocalBroadcastManager$ReceiverRecord;->filter:Landroid/content/IntentFilter;
 
     invoke-static {v12}, Ljava/util/Objects;->toString(Ljava/lang/Object;)Ljava/lang/String;
 
-    :cond_12
+    :cond_11
     iget-boolean v12, v14, Landroidx/localbroadcastmanager/content/LocalBroadcastManager$ReceiverRecord;->broadcasting:Z
 
-    if-eqz v12, :cond_13
+    if-eqz v12, :cond_12
 
     move-object/from16 v24, v15
 
     goto :goto_6
 
-    :cond_13
+    :cond_12
     iget-object v12, v14, Landroidx/localbroadcastmanager/content/LocalBroadcastManager$ReceiverRecord;->filter:Landroid/content/IntentFilter;
 
     const-string v18, "LocalBroadcastManager"
@@ -6974,27 +7036,27 @@
 
     move-result v12
 
-    if-ltz v12, :cond_16
+    if-ltz v12, :cond_15
 
-    if-eqz v10, :cond_14
+    if-eqz v10, :cond_13
 
     invoke-static {v12}, Ljava/lang/Integer;->toHexString(I)Ljava/lang/String;
 
-    :cond_14
-    if-nez v11, :cond_15
+    :cond_13
+    if-nez v11, :cond_14
 
     new-instance v11, Ljava/util/ArrayList;
 
     invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V
 
-    :cond_15
+    :cond_14
     invoke-virtual {v11, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
 
     const/4 v12, 0x1
 
     iput-boolean v12, v5, Landroidx/localbroadcastmanager/content/LocalBroadcastManager$ReceiverRecord;->broadcasting:Z
 
-    :cond_16
+    :cond_15
     :goto_6
     add-int/lit8 v6, v6, 0x1
 
@@ -7004,8 +7066,8 @@
 
     goto :goto_5
 
-    :cond_17
-    if-eqz v11, :cond_1a
+    :cond_16
+    if-eqz v11, :cond_19
 
     const/4 v5, 0x0
 
@@ -7014,7 +7076,7 @@
 
     move-result v6
 
-    if-ge v5, v6, :cond_18
+    if-ge v5, v6, :cond_17
 
     invoke-virtual {v11, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
@@ -7030,7 +7092,7 @@
 
     goto :goto_7
 
-    :cond_18
+    :cond_17
     iget-object v5, v8, Landroidx/localbroadcastmanager/content/LocalBroadcastManager;->mPendingBroadcasts:Ljava/util/ArrayList;
 
     new-instance v6, Landroidx/localbroadcastmanager/content/LocalBroadcastManager$BroadcastRecord;
@@ -7047,18 +7109,18 @@
 
     move-result v5
 
-    if-nez v5, :cond_19
+    if-nez v5, :cond_18
 
     iget-object v5, v8, Landroidx/localbroadcastmanager/content/LocalBroadcastManager;->mHandler:Landroidx/localbroadcastmanager/content/LocalBroadcastManager$1;
 
     invoke-virtual {v5, v6}, Landroid/os/Handler;->sendEmptyMessage(I)Z
 
-    :cond_19
+    :cond_18
     monitor-exit v9
 
     goto :goto_8
 
-    :cond_1a
+    :cond_19
     monitor-exit v9
 
     goto :goto_8
@@ -7072,7 +7134,7 @@
 
     throw v0
 
-    :cond_1b
+    :cond_1a
     :goto_8
     const/16 v5, 0x80
 
@@ -7080,7 +7142,7 @@
 
     move-result v5
 
-    if-eqz v5, :cond_1c
+    if-eqz v5, :cond_1b
 
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateOwnerInfo(I)Z
 
@@ -7090,7 +7152,7 @@
 
     goto :goto_9
 
-    :cond_1c
+    :cond_1b
     const/4 v2, 0x0
 
     :goto_9
@@ -7100,7 +7162,7 @@
 
     move-result v5
 
-    if-eqz v5, :cond_1d
+    if-eqz v5, :cond_1c
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateDeviceOwnerInfo()Z
 
@@ -7108,7 +7170,7 @@
 
     or-int/2addr v2, v5
 
-    :cond_1d
+    :cond_1c
     const-string v5, "KeyguardUpdateMonitor"
 
     const-string v6, "handleSecureStateChanged secureState : "
@@ -7123,7 +7185,7 @@
 
     invoke-static {v1, v2, v5}, Landroidx/appcompat/widget/ActionBarContextView$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;)V
 
-    if-eqz v4, :cond_1e
+    if-eqz v4, :cond_1d
 
     new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda10;
 
@@ -7143,13 +7205,13 @@
 
     goto :goto_a
 
-    :cond_1e
+    :cond_1d
     const/4 v4, 0x0
 
     const/4 v5, 0x2
 
     :goto_a
-    if-eqz v3, :cond_1f
+    if-eqz v3, :cond_1e
 
     new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda8;
 
@@ -7157,8 +7219,8 @@
 
     invoke-virtual {v0, v4, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    :cond_1f
-    if-eqz v2, :cond_68
+    :cond_1e
+    if-eqz v2, :cond_67
 
     new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda10;
 
@@ -7166,7 +7228,7 @@
 
     invoke-virtual {v0, v4, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_8
     const-string v1, "handleUpdateLockModeCallback, userID = "
@@ -7185,12 +7247,12 @@
 
     invoke-static {v3, v2, v4}, Landroidx/appcompat/widget/ListPopupWindow$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;)V
 
-    if-nez v2, :cond_68
+    if-nez v2, :cond_67
 
     :try_start_1
     iget-object v3, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
 
-    if-nez v3, :cond_20
+    if-nez v3, :cond_1f
 
     const-string v3, "lock_settings"
 
@@ -7204,7 +7266,7 @@
 
     iput-object v3, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
 
-    :cond_20
+    :cond_1f
     iget-object v3, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
 
     iget-object v0, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSecureLockChangedCallback:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$2;
@@ -7225,7 +7287,7 @@
     :try_end_1
     .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :catch_0
     move-exception v0
@@ -7244,7 +7306,7 @@
 
     invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_9
     const-string v1, "KeyguardUpdateMonitor"
@@ -7261,7 +7323,7 @@
 
     invoke-virtual {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_a
     const/4 v2, 0x2
@@ -7282,33 +7344,33 @@
 
     invoke-virtual {v0, v1, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_b
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
 
     check-cast v1, Lcom/android/keyguard/SecFaceMsg;
 
-    invoke-static {v5}, Lcom/android/systemui/util/LogUtil;->startTime(I)I
+    invoke-static {v4}, Lcom/android/systemui/util/LogUtil;->startTime(I)I
 
     move-result v2
 
     const/4 v3, 0x0
 
     :goto_b
-    iget-object v5, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFaceMessages:Ljava/util/concurrent/ConcurrentLinkedQueue;
+    iget-object v4, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFaceMessages:Ljava/util/concurrent/ConcurrentLinkedQueue;
 
-    invoke-virtual {v5}, Ljava/util/concurrent/ConcurrentLinkedQueue;->poll()Ljava/lang/Object;
+    invoke-virtual {v4}, Ljava/util/concurrent/ConcurrentLinkedQueue;->poll()Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v4
 
-    check-cast v5, Lcom/android/keyguard/SecFaceMsg;
+    check-cast v4, Lcom/android/keyguard/SecFaceMsg;
 
     const-string v6, "KeyguardFace"
 
-    if-eqz v5, :cond_34
+    if-eqz v4, :cond_33
 
-    if-ne v5, v1, :cond_21
+    if-ne v4, v1, :cond_20
 
     const-string v7, "handleFaceAuth faceMsg index = "
 
@@ -7322,73 +7384,73 @@
 
     invoke-static {v7, v11, v6}, Landroidx/recyclerview/widget/RecyclerView$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
 
-    :cond_21
-    iget v7, v5, Lcom/android/keyguard/SecFaceMsg;->type:I
+    :cond_20
+    iget v7, v4, Lcom/android/keyguard/SecFaceMsg;->type:I
 
-    if-eqz v7, :cond_31
+    if-eqz v7, :cond_30
 
     const/4 v11, 0x1
 
-    if-eq v7, v11, :cond_2f
+    if-eq v7, v11, :cond_2e
 
     const/4 v11, 0x2
 
-    if-eq v7, v11, :cond_2c
+    if-eq v7, v11, :cond_2b
 
-    if-eq v7, v9, :cond_27
+    if-eq v7, v9, :cond_26
 
-    if-eq v7, v12, :cond_22
+    if-eq v7, v12, :cond_21
 
     goto :goto_b
 
-    :cond_22
-    iget v5, v5, Lcom/android/keyguard/SecFaceMsg;->arg:I
+    :cond_21
+    iget v4, v4, Lcom/android/keyguard/SecFaceMsg;->arg:I
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFaceDetectionRunning()Z
 
     move-result v7
 
-    if-nez v7, :cond_23
+    if-nez v7, :cond_22
 
-    const-string v5, "onAuthenticationAcquired(), Face is not running"
+    const-string v4, "onAuthenticationAcquired(), Face is not running"
 
-    invoke-static {v6, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v6, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     goto/16 :goto_f
 
-    :cond_23
+    :cond_22
     iget-boolean v7, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFaceReady:Z
 
-    if-nez v7, :cond_24
+    if-nez v7, :cond_23
 
     const/4 v7, 0x1
 
     iput-boolean v7, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFaceReady:Z
 
-    :cond_24
+    :cond_23
     const-string v7, "onAuthenticationAcquired(), acquireInfo="
 
-    invoke-static {v7, v5, v6}, Landroidx/appcompat/widget/ListPopupWindow$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;)V
+    invoke-static {v7, v4, v6}, Landroidx/appcompat/widget/ListPopupWindow$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;)V
 
     const/4 v6, 0x2
 
-    if-eq v5, v6, :cond_26
+    if-eq v4, v6, :cond_25
 
-    if-eq v5, v9, :cond_25
+    if-eq v4, v9, :cond_24
 
-    if-eq v5, v12, :cond_25
+    if-eq v4, v12, :cond_24
 
-    if-eq v5, v4, :cond_25
+    if-eq v4, v5, :cond_24
 
-    if-eq v5, v8, :cond_25
+    if-eq v4, v8, :cond_24
 
-    packed-switch v5, :pswitch_data_7
+    packed-switch v4, :pswitch_data_7
 
-    packed-switch v5, :pswitch_data_8
+    packed-switch v4, :pswitch_data_8
 
     goto :goto_c
 
-    :cond_25
+    :cond_24
     :pswitch_c
     const/4 v6, 0x0
 
@@ -7396,19 +7458,19 @@
 
     goto :goto_c
 
-    :cond_26
+    :cond_25
     const/4 v6, 0x1
 
     iput-boolean v6, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mTimeoutWithoutFace:Z
 
     :goto_c
-    invoke-virtual {v0, v5}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleFaceAcquired(I)V
+    invoke-virtual {v0, v4}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleFaceAcquired(I)V
 
     iget-object v6, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mActiveUnlockConfig:Lcom/android/keyguard/ActiveUnlockConfig;
 
     iget-object v6, v6, Lcom/android/keyguard/ActiveUnlockConfig;->faceAcquireInfoToTriggerBiometricFailOn:Ljava/util/Set;
 
-    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v7
 
@@ -7416,7 +7478,7 @@
 
     move-result v6
 
-    if-eqz v6, :cond_33
+    if-eqz v6, :cond_32
 
     sget-object v6, Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;->BIOMETRIC_FAIL:Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;
 
@@ -7426,113 +7488,113 @@
 
     invoke-direct {v7, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v4
 
-    invoke-virtual {v0, v6, v5}, Lcom/android/keyguard/KeyguardUpdateMonitor;->requestActiveUnlock(Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;Ljava/lang/String;)V
+    invoke-virtual {v0, v6, v4}, Lcom/android/keyguard/KeyguardUpdateMonitor;->requestActiveUnlock(Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;Ljava/lang/String;)V
 
     goto/16 :goto_f
 
-    :cond_27
+    :cond_26
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFaceDetectionRunning()Z
 
-    move-result v5
+    move-result v4
 
-    if-nez v5, :cond_28
+    if-nez v4, :cond_27
 
-    const-string v5, "onAuthenticationFailed(), Face is not running"
+    const-string v4, "onAuthenticationFailed(), Face is not running"
 
-    invoke-static {v6, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v6, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     goto/16 :goto_f
 
-    :cond_28
-    const-string v5, "onAuthenticationFailed()"
+    :cond_27
+    const-string v4, "onAuthenticationFailed()"
 
-    invoke-static {v6, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v6, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    const-string v5, "2"
+    const-string v4, "2"
 
-    invoke-virtual {v0, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->sendFaceSALog(Ljava/lang/String;)V
+    invoke-virtual {v0, v4}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->sendFaceSALog(Ljava/lang/String;)V
 
-    iget-object v5, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardBypassController:Lcom/android/systemui/statusbar/phone/KeyguardBypassController;
+    iget-object v4, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardBypassController:Lcom/android/systemui/statusbar/phone/KeyguardBypassController;
 
-    invoke-virtual {v5}, Lcom/android/systemui/statusbar/phone/KeyguardBypassController;->canBypass()Z
+    invoke-virtual {v4}, Lcom/android/systemui/statusbar/phone/KeyguardBypassController;->canBypass()Z
 
-    move-result v5
+    move-result v4
 
-    if-eqz v5, :cond_29
+    if-eqz v4, :cond_28
 
-    const-string v5, "bypass"
+    const-string v4, "bypass"
 
     goto :goto_d
 
-    :cond_29
-    iget-boolean v5, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mAlternateBouncerShowing:Z
+    :cond_28
+    iget-boolean v4, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mAlternateBouncerShowing:Z
 
-    if-eqz v5, :cond_2a
+    if-eqz v4, :cond_29
 
-    const-string v5, "alternateBouncer"
+    const-string v4, "alternateBouncer"
 
     goto :goto_d
 
-    :cond_2a
-    iget-boolean v5, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
+    :cond_29
+    iget-boolean v4, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    if-eqz v5, :cond_2b
+    if-eqz v4, :cond_2a
 
-    const-string v5, "bouncer"
+    const-string v4, "bouncer"
 
     goto :goto_d
 
-    :cond_2b
-    const-string/jumbo v5, "udfpsFpDown"
+    :cond_2a
+    const-string/jumbo v4, "udfpsFpDown"
 
     :goto_d
     sget-object v6, Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;->BIOMETRIC_FAIL:Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;
 
     const-string v7, "faceFailure-"
 
-    invoke-virtual {v7, v5}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
+    invoke-virtual {v7, v4}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v4
 
-    invoke-virtual {v0, v6, v5}, Lcom/android/keyguard/KeyguardUpdateMonitor;->requestActiveUnlock(Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;Ljava/lang/String;)V
+    invoke-virtual {v0, v6, v4}, Lcom/android/keyguard/KeyguardUpdateMonitor;->requestActiveUnlock(Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;Ljava/lang/String;)V
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleFaceAuthFailed()V
 
     goto/16 :goto_f
 
-    :cond_2c
-    iget-object v5, v5, Lcom/android/keyguard/SecFaceMsg;->result:Lcom/samsung/android/bio/face/SemBioFaceManager$AuthenticationResult;
+    :cond_2b
+    iget-object v4, v4, Lcom/android/keyguard/SecFaceMsg;->result:Lcom/samsung/android/bio/face/SemBioFaceManager$AuthenticationResult;
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFaceDetectionRunning()Z
 
     move-result v7
 
-    if-nez v7, :cond_2d
+    if-nez v7, :cond_2c
 
-    const-string v5, "onAuthenticationSucceeded(), Face is not running"
+    const-string v4, "onAuthenticationSucceeded(), Face is not running"
 
-    invoke-static {v6, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v6, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     goto/16 :goto_f
 
-    :cond_2d
+    :cond_2c
     iget-boolean v7, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardGoingAway:Z
 
-    if-eqz v7, :cond_2e
+    if-eqz v7, :cond_2d
 
-    const-string v5, "onAuthenticationSucceeded() - return, goingAway is true"
+    const-string v4, "onAuthenticationSucceeded() - return, goingAway is true"
 
-    invoke-static {v6, v5}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v6, v4}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     goto/16 :goto_f
 
-    :cond_2e
+    :cond_2d
     const-class v7, Lcom/android/systemui/statusbar/phone/CentralSurfaces;
 
     invoke-static {v7}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
@@ -7577,38 +7639,38 @@
 
     invoke-virtual {v0, v6}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->sendFaceSALog(Ljava/lang/String;)V
 
-    invoke-virtual {v5}, Lcom/samsung/android/bio/face/SemBioFaceManager$AuthenticationResult;->isStrongBiometric()Z
+    invoke-virtual {v4}, Lcom/samsung/android/bio/face/SemBioFaceManager$AuthenticationResult;->isStrongBiometric()Z
 
-    move-result v5
+    move-result v4
 
-    invoke-virtual {v0, v15, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleFaceAuthenticated(IZ)V
+    invoke-virtual {v0, v15, v4}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleFaceAuthenticated(IZ)V
 
-    new-instance v5, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
+    new-instance v4, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
 
-    invoke-direct {v5, v0, v10}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;-><init>(Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;I)V
+    invoke-direct {v4, v0, v10}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;-><init>(Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;I)V
 
-    invoke-static {v5, v11}, Lcom/android/systemui/Rune;->runIf(Ljava/lang/Runnable;Z)V
+    invoke-static {v4, v11}, Lcom/android/systemui/Rune;->runIf(Ljava/lang/Runnable;Z)V
 
     goto :goto_f
 
-    :cond_2f
-    iget v7, v5, Lcom/android/keyguard/SecFaceMsg;->arg:I
+    :cond_2e
+    iget v7, v4, Lcom/android/keyguard/SecFaceMsg;->arg:I
 
-    iget-object v5, v5, Lcom/android/keyguard/SecFaceMsg;->msgString:Ljava/lang/CharSequence;
+    iget-object v4, v4, Lcom/android/keyguard/SecFaceMsg;->msgString:Ljava/lang/CharSequence;
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFaceDetectionRunning()Z
 
     move-result v11
 
-    if-nez v11, :cond_30
+    if-nez v11, :cond_2f
 
-    const-string v5, "onAuthenticationHelp(), Face is not running"
+    const-string v4, "onAuthenticationHelp(), Face is not running"
 
-    invoke-static {v6, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v6, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     goto :goto_f
 
-    :cond_30
+    :cond_2f
     new-instance v11, Ljava/lang/StringBuilder;
 
     const-string v13, "onAuthenticationHelp(), helpCode="
@@ -7621,7 +7683,7 @@
 
     invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v11, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+    invoke-virtual {v11, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -7629,48 +7691,48 @@
 
     invoke-static {v6, v11}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-interface {v5}, Ljava/lang/CharSequence;->toString()Ljava/lang/String;
+    invoke-interface {v4}, Ljava/lang/CharSequence;->toString()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v4
 
-    invoke-virtual {v0, v7, v5}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleFaceHelp(ILjava/lang/String;)V
+    invoke-virtual {v0, v7, v4}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleFaceHelp(ILjava/lang/String;)V
 
     goto :goto_f
 
-    :cond_31
-    iget v6, v5, Lcom/android/keyguard/SecFaceMsg;->arg:I
+    :cond_30
+    iget v6, v4, Lcom/android/keyguard/SecFaceMsg;->arg:I
 
-    iget-object v5, v5, Lcom/android/keyguard/SecFaceMsg;->msgString:Ljava/lang/CharSequence;
+    iget-object v4, v4, Lcom/android/keyguard/SecFaceMsg;->msgString:Ljava/lang/CharSequence;
 
-    if-nez v5, :cond_32
+    if-nez v4, :cond_31
 
-    const/4 v5, 0x0
+    const/4 v4, 0x0
 
     goto :goto_e
 
-    :cond_32
-    invoke-interface {v5}, Ljava/lang/CharSequence;->toString()Ljava/lang/String;
+    :cond_31
+    invoke-interface {v4}, Ljava/lang/CharSequence;->toString()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v4
 
     :goto_e
-    invoke-virtual {v0, v6, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleFaceError(ILjava/lang/String;)V
+    invoke-virtual {v0, v6, v4}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleFaceError(ILjava/lang/String;)V
 
-    iget-object v5, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mActiveUnlockConfig:Lcom/android/keyguard/ActiveUnlockConfig;
+    iget-object v4, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mActiveUnlockConfig:Lcom/android/keyguard/ActiveUnlockConfig;
 
-    iget-object v5, v5, Lcom/android/keyguard/ActiveUnlockConfig;->faceErrorsToTriggerBiometricFailOn:Ljava/util/Set;
+    iget-object v4, v4, Lcom/android/keyguard/ActiveUnlockConfig;->faceErrorsToTriggerBiometricFailOn:Ljava/util/Set;
 
     invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v7
 
-    invoke-interface {v5, v7}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z
+    invoke-interface {v4, v7}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z
 
-    move-result v5
+    move-result v4
 
-    if-eqz v5, :cond_33
+    if-eqz v4, :cond_32
 
-    sget-object v5, Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;->BIOMETRIC_FAIL:Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;
+    sget-object v4, Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;->BIOMETRIC_FAIL:Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;
 
     new-instance v7, Ljava/lang/StringBuilder;
 
@@ -7684,15 +7746,15 @@
 
     move-result-object v6
 
-    invoke-virtual {v0, v5, v6}, Lcom/android/keyguard/KeyguardUpdateMonitor;->requestActiveUnlock(Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;Ljava/lang/String;)V
+    invoke-virtual {v0, v4, v6}, Lcom/android/keyguard/KeyguardUpdateMonitor;->requestActiveUnlock(Lcom/android/keyguard/ActiveUnlockConfig$ActiveUnlockRequestOrigin;Ljava/lang/String;)V
 
-    :cond_33
+    :cond_32
     :goto_f
     add-int/lit8 v3, v3, 0x1
 
     goto/16 :goto_b
 
-    :cond_34
+    :cond_33
     const-string v0, "handleFaceAuth dispatchCount = "
 
     invoke-static {v0, v3}, Landroid/support/v4/media/MediaBrowserCompat$MediaBrowserImplBase$$ExternalSyntheticOutline0;->m(Ljava/lang/String;I)Ljava/lang/String;
@@ -7705,18 +7767,18 @@
 
     invoke-static {v2, v6, v0, v1}, Lcom/android/systemui/util/LogUtil;->endTime(ILjava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_d
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
 
     check-cast v1, Lcom/android/keyguard/SecFpMsg;
 
-    invoke-static {v5}, Lcom/android/systemui/util/LogUtil;->startTime(I)I
+    invoke-static {v4}, Lcom/android/systemui/util/LogUtil;->startTime(I)I
 
     move-result v2
 
-    const/4 v5, 0x0
+    const/4 v4, 0x0
 
     :goto_10
     iget-object v6, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpMessages:Ljava/util/concurrent/ConcurrentLinkedQueue;
@@ -7729,15 +7791,15 @@
 
     const-string v8, "KeyguardFingerprint"
 
-    if-eqz v6, :cond_47
+    if-eqz v6, :cond_46
 
-    if-ne v6, v1, :cond_35
+    if-ne v6, v1, :cond_34
 
     const-string v11, "handleFingerprintAuth fpMsg index = "
 
     const-string v12, " / type = "
 
-    invoke-static {v11, v5, v12}, Landroid/support/v4/media/MediaBrowserCompat$MediaBrowserImplBase$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-static {v11, v4, v12}, Landroid/support/v4/media/MediaBrowserCompat$MediaBrowserImplBase$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;)Ljava/lang/StringBuilder;
 
     move-result-object v11
 
@@ -7745,7 +7807,7 @@
 
     invoke-static {v11, v12, v8}, Landroidx/recyclerview/widget/RecyclerView$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
 
-    :cond_35
+    :cond_34
     iget v11, v6, Lcom/android/keyguard/SecFpMsg;->type:I
 
     const-string v12, ")"
@@ -7765,7 +7827,7 @@
 
     iget v6, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFingerprintAuthenticationSequence:I
 
-    if-eq v6, v3, :cond_36
+    if-eq v6, v3, :cond_35
 
     const-string v6, "onUdfpsFingerUp() - return, sequence error ("
 
@@ -7779,7 +7841,7 @@
 
     goto/16 :goto_12
 
-    :cond_36
+    :cond_35
     const-string v3, "onUdfpsFingerUp()"
 
     invoke-static {v8, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
@@ -7803,7 +7865,7 @@
 
     iget v11, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFingerprintAuthenticationSequence:I
 
-    if-eq v11, v6, :cond_37
+    if-eq v11, v6, :cond_36
 
     const-string v3, "onUdfpsFingerDown() - return, sequence error ("
 
@@ -7817,7 +7879,7 @@
 
     goto/16 :goto_12
 
-    :cond_37
+    :cond_36
     const-string v6, "onUdfpsFingerDown()"
 
     invoke-static {v8, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
@@ -7839,7 +7901,7 @@
 
     iget v11, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFingerprintAuthenticationSequence:I
 
-    if-eq v11, v3, :cond_38
+    if-eq v11, v3, :cond_37
 
     const-string v6, "onAuthenticationAcquired() - return, sequence error ("
 
@@ -7853,7 +7915,7 @@
 
     goto/16 :goto_12
 
-    :cond_38
+    :cond_37
     new-instance v3, Ljava/lang/StringBuilder;
 
     const-string v11, "onAuthenticationAcquired( "
@@ -7881,7 +7943,7 @@
 
     iget v6, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFingerprintAuthenticationSequence:I
 
-    if-eq v6, v3, :cond_39
+    if-eq v6, v3, :cond_38
 
     const-string v6, "onAuthenticationFailed() - return, sequence error ("
 
@@ -7895,12 +7957,12 @@
 
     goto/16 :goto_12
 
-    :cond_39
+    :cond_38
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isTimerRunning()Z
 
     move-result v3
 
-    if-eqz v3, :cond_3a
+    if-eqz v3, :cond_39
 
     const-string v3, "onAuthenticationFailed() - return, isTimerRunning is true"
 
@@ -7908,7 +7970,7 @@
 
     goto/16 :goto_12
 
-    :cond_3a
+    :cond_39
     const-string v3, "onAuthenticationFailed()"
 
     invoke-static {v8, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
@@ -7934,7 +7996,7 @@
 
     iget v11, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFingerprintAuthenticationSequence:I
 
-    if-eq v11, v3, :cond_3b
+    if-eq v11, v3, :cond_3a
 
     const-string v6, "onAuthenticationSucceeded() - return, sequence error ("
 
@@ -7948,12 +8010,12 @@
 
     goto/16 :goto_12
 
-    :cond_3b
+    :cond_3a
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isTimerRunning()Z
 
     move-result v3
 
-    if-eqz v3, :cond_3c
+    if-eqz v3, :cond_3b
 
     const-string v3, "onAuthenticationSucceeded() - return, isTimerRunning is true"
 
@@ -7961,10 +8023,10 @@
 
     goto/16 :goto_12
 
-    :cond_3c
+    :cond_3b
     iget-boolean v3, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardGoingAway:Z
 
-    if-eqz v3, :cond_3d
+    if-eqz v3, :cond_3c
 
     const-string v3, "onAuthenticationSucceeded() - return, goingAway is true"
 
@@ -7972,7 +8034,7 @@
 
     goto/16 :goto_12
 
-    :cond_3d
+    :cond_3c
     invoke-virtual {v6}, Landroid/hardware/fingerprint/FingerprintManager$AuthenticationResult;->isStrongBiometric()Z
 
     move-result v3
@@ -8062,7 +8124,7 @@
 
     iget v14, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFingerprintAuthenticationSequence:I
 
-    if-eq v14, v3, :cond_3e
+    if-eq v14, v3, :cond_3d
 
     const-string v6, "onAuthenticationHelp() - return, sequence error ("
 
@@ -8076,12 +8138,12 @@
 
     goto/16 :goto_12
 
-    :cond_3e
+    :cond_3d
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isTimerRunning()Z
 
     move-result v3
 
-    if-eqz v3, :cond_3f
+    if-eqz v3, :cond_3e
 
     const-string v3, "onAuthenticationHelp() - return, isTimerRunning is true"
 
@@ -8089,7 +8151,7 @@
 
     goto/16 :goto_12
 
-    :cond_3f
+    :cond_3e
     new-instance v3, Ljava/lang/StringBuilder;
 
     const-string v12, "onAuthenticationHelp( helpMsgId = "
@@ -8116,49 +8178,49 @@
 
     const/4 v3, 0x1
 
-    if-eq v11, v3, :cond_44
+    if-eq v11, v3, :cond_43
 
     const/4 v3, 0x2
 
-    if-eq v11, v3, :cond_43
+    if-eq v11, v3, :cond_42
 
-    if-eq v11, v9, :cond_42
+    if-eq v11, v9, :cond_41
 
-    if-eq v11, v4, :cond_41
+    if-eq v11, v5, :cond_40
 
-    if-eq v11, v7, :cond_40
+    if-eq v11, v7, :cond_3f
 
     goto :goto_11
 
-    :cond_40
+    :cond_3f
     const-string v3, "7"
 
     invoke-virtual {v0, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->sendFingerprintSALog(Ljava/lang/String;)V
 
     goto :goto_11
 
-    :cond_41
+    :cond_40
     const-string v3, "3"
 
     invoke-virtual {v0, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->sendFingerprintSALog(Ljava/lang/String;)V
 
     goto :goto_11
 
-    :cond_42
+    :cond_41
     const-string v3, "6"
 
     invoke-virtual {v0, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->sendFingerprintSALog(Ljava/lang/String;)V
 
     goto :goto_11
 
-    :cond_43
+    :cond_42
     const-string v3, "5"
 
     invoke-virtual {v0, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->sendFingerprintSALog(Ljava/lang/String;)V
 
     goto :goto_11
 
-    :cond_44
+    :cond_43
     const-string v3, "4"
 
     invoke-virtual {v0, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->sendFingerprintSALog(Ljava/lang/String;)V
@@ -8181,7 +8243,7 @@
 
     iget v14, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFingerprintAuthenticationSequence:I
 
-    if-eq v14, v3, :cond_45
+    if-eq v14, v3, :cond_44
 
     const-string v6, "onAuthenticationError() - return, sequence error ("
 
@@ -8195,12 +8257,12 @@
 
     goto :goto_12
 
-    :cond_45
+    :cond_44
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isTimerRunning()Z
 
     move-result v3
 
-    if-eqz v3, :cond_46
+    if-eqz v3, :cond_45
 
     const-string v3, "onAuthenticationError() - return, isTimerRunning is true"
 
@@ -8208,7 +8270,7 @@
 
     goto :goto_12
 
-    :cond_46
+    :cond_45
     const-string v3, "onAuthenticationError()"
 
     invoke-static {v8, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
@@ -8220,20 +8282,20 @@
     invoke-virtual {v0, v11, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleFingerprintError(ILjava/lang/String;)V
 
     :goto_12
-    add-int/lit8 v5, v5, 0x1
+    add-int/lit8 v4, v4, 0x1
 
     const/4 v3, 0x7
 
     goto/16 :goto_10
 
-    :cond_47
+    :cond_46
     iget-object v1, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpMessages:Ljava/util/concurrent/ConcurrentLinkedQueue;
 
     invoke-virtual {v1}, Ljava/util/concurrent/ConcurrentLinkedQueue;->size()I
 
     move-result v1
 
-    if-lez v1, :cond_48
+    if-lez v1, :cond_47
 
     iget-object v1, v0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
 
@@ -8243,21 +8305,21 @@
 
     move-result v1
 
-    if-nez v1, :cond_48
+    if-nez v1, :cond_47
 
     new-instance v1, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v4, "remained message size : "
+    const-string/jumbo v5, "remained message size : "
 
-    invoke-direct {v1, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v1, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget-object v4, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpMessages:Ljava/util/concurrent/ConcurrentLinkedQueue;
+    iget-object v5, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpMessages:Ljava/util/concurrent/ConcurrentLinkedQueue;
 
-    invoke-virtual {v4}, Ljava/util/concurrent/ConcurrentLinkedQueue;->size()I
+    invoke-virtual {v5}, Ljava/util/concurrent/ConcurrentLinkedQueue;->size()I
 
-    move-result v4
+    move-result v5
 
-    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -8269,10 +8331,10 @@
 
     invoke-virtual {v0, v3}, Landroid/os/Handler;->sendEmptyMessage(I)Z
 
-    :cond_48
+    :cond_47
     const-string v0, "handleFingerprintAuth dispatchCount = "
 
-    invoke-static {v0, v5}, Landroid/support/v4/media/MediaBrowserCompat$MediaBrowserImplBase$$ExternalSyntheticOutline0;->m(Ljava/lang/String;I)Ljava/lang/String;
+    invoke-static {v0, v4}, Landroid/support/v4/media/MediaBrowserCompat$MediaBrowserImplBase$$ExternalSyntheticOutline0;->m(Ljava/lang/String;I)Ljava/lang/String;
 
     move-result-object v0
 
@@ -8282,7 +8344,7 @@
 
     invoke-static {v2, v8, v0, v1}, Lcom/android/systemui/util/LogUtil;->endTime(ILjava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_15
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -8295,7 +8357,7 @@
 
     iget-boolean v2, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsQsFullyExpanded:Z
 
-    if-eq v2, v1, :cond_68
+    if-eq v2, v1, :cond_67
 
     new-instance v2, Ljava/lang/StringBuilder;
 
@@ -8331,43 +8393,33 @@
 
     move-result v1
 
-    if-nez v1, :cond_49
-
-    goto/16 :goto_1b
-
-    :cond_49
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v1, :cond_4a
-
-    const/4 v1, 0x2
+    if-nez v1, :cond_48
 
-    invoke-virtual {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    goto/16 :goto_19
 
-    goto :goto_13
+    :cond_48
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_4a
-    const/4 v1, 0x2
+    sget-object v1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_QS_FULLY_EXPANDED:Lcom/android/keyguard/FaceAuthUiEvent;
 
-    :goto_13
-    sget-object v2, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_QS_FULLY_EXPANDED:Lcom/android/keyguard/FaceAuthUiEvent;
+    const/4 v2, 0x2
 
-    invoke-virtual {v0, v1, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
+    invoke-virtual {v0, v2, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_16
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFaceDetectionRunning()Z
 
     move-result v1
 
-    if-eqz v1, :cond_4b
+    if-eqz v1, :cond_49
 
     sget-object v1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_STOPPED_USER_INPUT_ON_BOUNCER:Lcom/android/keyguard/FaceAuthUiEvent;
 
     invoke-virtual {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->stopListeningForFace(Lcom/android/keyguard/FaceAuthUiEvent;)V
 
-    :cond_4b
+    :cond_49
     new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda10;
 
     invoke-direct {v1, v12}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda10;-><init>(I)V
@@ -8376,7 +8428,7 @@
 
     invoke-virtual {v0, v2, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_17
     iget v2, v1, Landroid/os/Message;->arg1:I
@@ -8387,128 +8439,258 @@
 
     check-cast v1, Landroid/telephony/ServiceState;
 
-    invoke-virtual {v0, v2, v3, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleServiceStateChange(IILandroid/telephony/ServiceState;)V
+    const-string v4, "handleServiceStateChange(subId="
 
-    goto/16 :goto_1b
+    const-string v6, ", slotId="
 
-    :pswitch_18
-    iget v2, v1, Landroid/os/Message;->arg1:I
+    const-string v7, ", serviceState="
 
-    iget v1, v1, Landroid/os/Message;->arg2:I
+    invoke-static {v4, v2, v6, v3, v7}, Landroidx/recyclerview/widget/GridLayoutManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;ILjava/lang/String;)Ljava/lang/StringBuilder;
 
-    const/4 v3, 0x1
+    move-result-object v4
 
-    if-ne v1, v3, :cond_4c
+    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
-    const/4 v5, 0x1
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    goto :goto_14
+    move-result-object v4
 
-    :cond_4c
-    const/4 v5, 0x0
+    const-string v6, "KeyguardUpdateMonitor"
 
-    :goto_14
-    invoke-virtual {v0, v2, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleDualDarInnerLockScreenStateChanged(IZ)V
+    invoke-static {v6, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_1b
+    sget-boolean v4, Lcom/android/systemui/LsRune;->SECURITY_DISABLE_EMERGENCY_CALL_WHEN_OFFLINE:Z
 
-    :pswitch_19
-    sget-object v1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_SUB_SCREEN:Lcom/android/keyguard/FaceAuthUiEvent;
+    if-eqz v4, :cond_4e
 
-    const/4 v2, 0x2
+    iget-object v4, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mServiceStatesBySlotId:Ljava/util/HashMap;
 
-    invoke-virtual {v0, v2, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateBiometricListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
+    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    goto/16 :goto_1b
+    move-result-object v3
 
-    :pswitch_1a
-    const/4 v1, 0x2
+    invoke-virtual {v4, v3, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
 
-    invoke-virtual {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    iget-object v3, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mServiceStatesBySlotId:Ljava/util/HashMap;
 
-    goto/16 :goto_1b
+    invoke-virtual {v3}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
 
-    :pswitch_1b
-    const-class v0, Lcom/android/systemui/keyguard/DisplayLifecycle;
+    move-result-object v3
 
-    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+    invoke-interface {v3}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
 
-    move-result-object v0
+    move-result-object v3
 
-    check-cast v0, Lcom/android/systemui/keyguard/DisplayLifecycle;
+    :cond_4a
+    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z
 
-    invoke-virtual {v0}, Lcom/android/systemui/keyguard/DisplayLifecycle;->updateSmartViewFitToActiveDisplay()V
+    move-result v4
 
-    goto/16 :goto_1b
+    if-eqz v4, :cond_4d
 
-    :pswitch_1c
-    iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
+    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
-    check-cast v1, Ljava/lang/String;
+    move-result-object v4
 
-    new-instance v2, Ljava/lang/StringBuilder;
+    check-cast v4, Ljava/util/Map$Entry;
 
-    const-string v3, "handleFailToUnlockSimulation unlockType : "
+    invoke-interface {v4}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    move-result-object v4
 
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    check-cast v4, Landroid/telephony/ServiceState;
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    if-eqz v4, :cond_4a
 
-    move-result-object v2
+    invoke-virtual {v4}, Landroid/telephony/ServiceState;->getVoiceRegState()I
 
-    const-string v3, "KeyguardUpdateMonitor"
+    move-result v7
 
-    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    const/4 v8, 0x1
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    if-eq v7, v8, :cond_4b
 
-    const-string v2, "finger"
+    invoke-virtual {v4}, Landroid/telephony/ServiceState;->getVoiceRegState()I
 
-    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    move-result v7
 
-    move-result v2
+    if-ne v7, v9, :cond_4c
 
-    const-string v3, "onAuthenticationFailed()"
+    :cond_4b
+    invoke-virtual {v4}, Landroid/telephony/ServiceState;->getVoiceRegState()I
 
-    if-nez v2, :cond_4e
+    move-result v7
 
-    const-string v2, "face"
+    if-ne v7, v8, :cond_4a
 
-    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v4}, Landroid/telephony/ServiceState;->isEmergencyOnly()Z
 
-    move-result v1
+    move-result v4
 
-    if-nez v1, :cond_4d
+    if-eqz v4, :cond_4a
 
-    new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda8;
+    :cond_4c
+    const/4 v3, 0x0
 
-    invoke-direct {v1, v0, v9}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda8;-><init>(Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;I)V
+    goto :goto_13
 
-    const/4 v2, 0x0
+    :cond_4d
+    const/4 v3, 0x1
 
-    invoke-virtual {v0, v2, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
+    :goto_13
+    iget-boolean v4, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsOutOfService:Z
 
-    goto/16 :goto_1b
+    if-eq v4, v3, :cond_4e
 
-    :cond_4d
-    const-string v1, "KeyguardFace"
+    iput-boolean v3, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsOutOfService:Z
 
-    invoke-static {v1, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    new-instance v3, Ljava/lang/StringBuilder;
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleFaceAuthFailed()V
+    const-string/jumbo v4, "updateOfflineState isOutOfService : "
 
-    goto/16 :goto_1b
+    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    iget-boolean v4, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsOutOfService:Z
+
+    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v3
+
+    invoke-static {v6, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    new-instance v3, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda10;
+
+    invoke-direct {v3, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda10;-><init>(I)V
+
+    const/4 v4, 0x0
+
+    invoke-virtual {v0, v4, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
     :cond_4e
+    invoke-super {v0, v2, v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleServiceStateChange(ILandroid/telephony/ServiceState;)V
+
+    goto/16 :goto_19
+
+    :pswitch_18
+    iget v2, v1, Landroid/os/Message;->arg1:I
+
+    iget v1, v1, Landroid/os/Message;->arg2:I
+
+    const/4 v3, 0x1
+
+    if-ne v1, v3, :cond_4f
+
+    const/4 v5, 0x1
+
+    goto :goto_14
+
+    :cond_4f
+    const/4 v5, 0x0
+
+    :goto_14
+    invoke-virtual {v0, v2, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleDualDarInnerLockScreenStateChanged(IZ)V
+
+    goto/16 :goto_19
+
+    :pswitch_19
+    sget-object v1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_SUB_SCREEN:Lcom/android/keyguard/FaceAuthUiEvent;
+
+    const/4 v2, 0x2
+
+    invoke-virtual {v0, v2, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateBiometricListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
+
+    goto/16 :goto_19
+
+    :pswitch_1a
+    const/4 v1, 0x2
+
+    invoke-virtual {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+
+    goto/16 :goto_19
+
+    :pswitch_1b
+    const-class v0, Lcom/android/systemui/keyguard/DisplayLifecycle;
+
+    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v0
+
+    check-cast v0, Lcom/android/systemui/keyguard/DisplayLifecycle;
+
+    invoke-virtual {v0}, Lcom/android/systemui/keyguard/DisplayLifecycle;->updateSmartViewFitToActiveDisplay()V
+
+    goto/16 :goto_19
+
+    :pswitch_1c
+    iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
+
+    check-cast v1, Ljava/lang/String;
+
+    new-instance v2, Ljava/lang/StringBuilder;
+
+    const-string v3, "handleFailToUnlockSimulation unlockType : "
+
+    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string v3, "KeyguardUpdateMonitor"
+
+    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    const-string v2, "finger"
+
+    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v2
+
+    const-string v3, "onAuthenticationFailed()"
+
+    if-nez v2, :cond_51
+
+    const-string v2, "face"
+
+    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v1
+
+    if-nez v1, :cond_50
+
+    new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda8;
+
+    invoke-direct {v1, v0, v9}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda8;-><init>(Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;I)V
+
+    const/4 v2, 0x0
+
+    invoke-virtual {v0, v2, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
+
+    goto/16 :goto_19
+
+    :cond_50
+    const-string v1, "KeyguardFace"
+
+    invoke-static {v1, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleFaceAuthFailed()V
+
+    goto/16 :goto_19
+
+    :cond_51
     const-string v1, "KeyguardFingerprint"
 
     invoke-static {v1, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleFingerprintAuthFailed()V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_1d
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -8527,20 +8709,20 @@
 
     const-string v4, "face"
 
-    if-nez v3, :cond_4f
+    if-nez v3, :cond_52
 
     invoke-virtual {v4, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v3
 
-    if-eqz v3, :cond_50
+    if-eqz v3, :cond_53
 
-    :cond_4f
+    :cond_52
     iget-object v3, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFastUnlockController:Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;
 
     invoke-virtual {v3}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->setEnabled()V
 
-    :cond_50
+    :cond_53
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
@@ -8549,13 +8731,13 @@
 
     const-string v3, "onAuthenticationSucceeded()"
 
-    if-nez v2, :cond_52
+    if-nez v2, :cond_55
 
     invoke-virtual {v1, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v1
 
-    if-nez v1, :cond_51
+    if-nez v1, :cond_54
 
     iget-object v1, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mViewMediatorCallbackLazy:Ldagger/Lazy;
 
@@ -8575,9 +8757,9 @@
 
     invoke-interface {v1, v0}, Lcom/android/keyguard/ViewMediatorCallback;->keyguardDone(I)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
-    :cond_51
+    :cond_54
     const-string v1, "KeyguardFace"
 
     invoke-static {v1, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
@@ -8590,9 +8772,9 @@
 
     invoke-virtual {v0, v1, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleFaceAuthenticated(IZ)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
-    :cond_52
+    :cond_55
     const/4 v1, 0x0
 
     const-string v2, "KeyguardFingerprint"
@@ -8601,7 +8783,7 @@
 
     invoke-virtual {v0, v1, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleFingerprintAuthenticated(IZ)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_1e
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -8633,11 +8815,11 @@
 
     move-result v1
 
-    if-nez v1, :cond_53
+    if-nez v1, :cond_56
 
     goto :goto_15
 
-    :cond_53
+    :cond_56
     move v1, v12
 
     goto :goto_16
@@ -8649,11 +8831,11 @@
 
     move-result v1
 
-    if-nez v1, :cond_54
+    if-nez v1, :cond_57
 
     goto :goto_15
 
-    :cond_54
+    :cond_57
     move v1, v9
 
     goto :goto_16
@@ -8665,11 +8847,11 @@
 
     move-result v1
 
-    if-nez v1, :cond_55
+    if-nez v1, :cond_58
 
     goto :goto_15
 
-    :cond_55
+    :cond_58
     const/4 v1, 0x2
 
     goto :goto_16
@@ -8681,11 +8863,11 @@
 
     move-result v1
 
-    if-nez v1, :cond_56
+    if-nez v1, :cond_59
 
     goto :goto_15
 
-    :cond_56
+    :cond_59
     const/4 v1, 0x1
 
     goto :goto_16
@@ -8697,63 +8879,63 @@
 
     move-result v1
 
-    if-nez v1, :cond_57
+    if-nez v1, :cond_5a
 
     goto :goto_15
 
-    :cond_57
+    :cond_5a
     const/4 v1, 0x0
 
     goto :goto_16
 
     :goto_15
-    move v1, v5
+    move v1, v4
 
     :goto_16
     const-string v3, "KeyguardUpdateMonitor"
 
-    if-eqz v1, :cond_5d
+    if-eqz v1, :cond_60
 
-    const/4 v5, 0x1
+    const/4 v4, 0x1
 
-    if-eq v1, v5, :cond_5c
+    if-eq v1, v4, :cond_5f
 
-    const/4 v5, 0x2
+    const/4 v4, 0x2
 
-    if-eq v1, v5, :cond_5a
+    if-eq v1, v4, :cond_5d
 
-    if-eq v1, v9, :cond_59
+    if-eq v1, v9, :cond_5c
 
-    if-eq v1, v12, :cond_58
+    if-eq v1, v12, :cond_5b
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
-    :cond_58
+    :cond_5b
     new-instance v1, Landroid/os/Bundle;
 
     invoke-direct {v1}, Landroid/os/Bundle;-><init>()V
 
     const-string v2, "customer_package_name"
 
-    const-string v5, "com.samsung.android.calendar"
+    const-string v4, "com.samsung.android.calendar"
 
-    invoke-virtual {v1, v2, v5}, Landroid/os/Bundle;->putCharSequence(Ljava/lang/String;Ljava/lang/CharSequence;)V
+    invoke-virtual {v1, v2, v4}, Landroid/os/Bundle;->putCharSequence(Ljava/lang/String;Ljava/lang/CharSequence;)V
 
     const-string v2, "customer_app_name"
 
-    const-string v5, "Samsung Calendar"
+    const-string v4, "Samsung Calendar"
 
-    invoke-virtual {v1, v2, v5}, Landroid/os/Bundle;->putCharSequence(Ljava/lang/String;Ljava/lang/CharSequence;)V
+    invoke-virtual {v1, v2, v4}, Landroid/os/Bundle;->putCharSequence(Ljava/lang/String;Ljava/lang/CharSequence;)V
 
     new-instance v2, Lcom/android/internal/widget/RemoteLockInfo$Builder;
 
-    const/4 v5, 0x1
+    const/4 v4, 0x1
 
-    invoke-direct {v2, v9, v5}, Lcom/android/internal/widget/RemoteLockInfo$Builder;-><init>(IZ)V
+    invoke-direct {v2, v9, v4}, Lcom/android/internal/widget/RemoteLockInfo$Builder;-><init>(IZ)V
 
-    const-string v5, "KnoxGuard Lockscreen"
+    const-string v4, "KnoxGuard Lockscreen"
 
-    invoke-virtual {v2, v5}, Lcom/android/internal/widget/RemoteLockInfo$Builder;->setClientName(Ljava/lang/CharSequence;)Lcom/android/internal/widget/RemoteLockInfo$Builder;
+    invoke-virtual {v2, v4}, Lcom/android/internal/widget/RemoteLockInfo$Builder;->setClientName(Ljava/lang/CharSequence;)Lcom/android/internal/widget/RemoteLockInfo$Builder;
 
     move-result-object v2
 
@@ -8779,13 +8961,13 @@
 
     move-result-object v1
 
-    const-wide/32 v5, 0xea60
+    const-wide/32 v6, 0xea60
 
-    invoke-virtual {v1, v5, v6}, Lcom/android/internal/widget/RemoteLockInfo$Builder;->setLockTimeOut(J)Lcom/android/internal/widget/RemoteLockInfo$Builder;
+    invoke-virtual {v1, v6, v7}, Lcom/android/internal/widget/RemoteLockInfo$Builder;->setLockTimeOut(J)Lcom/android/internal/widget/RemoteLockInfo$Builder;
 
     move-result-object v1
 
-    invoke-virtual {v1, v4}, Lcom/android/internal/widget/RemoteLockInfo$Builder;->setAllowFailCount(I)Lcom/android/internal/widget/RemoteLockInfo$Builder;
+    invoke-virtual {v1, v5}, Lcom/android/internal/widget/RemoteLockInfo$Builder;->setAllowFailCount(I)Lcom/android/internal/widget/RemoteLockInfo$Builder;
 
     move-result-object v1
 
@@ -8812,7 +8994,7 @@
     :try_end_2
     .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_1
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :catch_1
     move-exception v0
@@ -8831,14 +9013,14 @@
 
     invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
-    :cond_59
+    :cond_5c
     check-cast v2, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
 
     iget-object v0, v2, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->mEdmMonitor:Lcom/android/systemui/knox/EdmMonitor;
 
-    if-eqz v0, :cond_68
+    if-eqz v0, :cond_67
 
     const/4 v1, 0x0
 
@@ -8846,24 +9028,24 @@
 
     invoke-virtual {v0, v1, v2}, Lcom/android/systemui/knox/EdmMonitor;->setAdminLock(ZZ)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
-    :cond_5a
+    :cond_5d
     const/4 v1, 0x0
 
     check-cast v2, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
 
     iget-object v2, v2, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->mEdmMonitor:Lcom/android/systemui/knox/EdmMonitor;
 
-    if-eqz v2, :cond_5b
+    if-eqz v2, :cond_5e
 
     invoke-virtual {v2, v1, v1}, Lcom/android/systemui/knox/EdmMonitor;->setAdminLock(ZZ)V
 
-    :cond_5b
+    :cond_5e
     :try_start_3
     iget-object v2, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mRemoteLockSimulationInfo:Lcom/android/internal/widget/RemoteLockInfo;
 
-    if-eqz v2, :cond_68
+    if-eqz v2, :cond_67
 
     iput-boolean v1, v2, Lcom/android/internal/widget/RemoteLockInfo;->lockState:Z
 
@@ -8887,7 +9069,7 @@
     :try_end_3
     .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_2
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :catch_2
     move-exception v0
@@ -8906,14 +9088,14 @@
 
     invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
-    :cond_5c
+    :cond_5f
     check-cast v2, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
 
     iget-object v0, v2, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->mEdmMonitor:Lcom/android/systemui/knox/EdmMonitor;
 
-    if-eqz v0, :cond_68
+    if-eqz v0, :cond_67
 
     const/4 v1, 0x0
 
@@ -8921,9 +9103,9 @@
 
     invoke-virtual {v0, v2, v1}, Lcom/android/systemui/knox/EdmMonitor;->setAdminLock(ZZ)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
-    :cond_5d
+    :cond_60
     const/4 v2, 0x1
 
     new-instance v1, Lcom/android/internal/widget/RemoteLockInfo$Builder;
@@ -8973,7 +9155,7 @@
     :try_end_4
     .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_3
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :catch_3
     move-exception v0
@@ -8992,7 +9174,7 @@
 
     invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_1f
     iget-object v2, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -9001,24 +9183,24 @@
 
     iget v1, v1, Landroid/os/Message;->arg1:I
 
-    const/4 v3, 0x1
+    const/4 v4, 0x1
 
-    if-ne v1, v3, :cond_5e
+    if-ne v1, v4, :cond_61
 
-    move v5, v3
+    move v5, v4
 
     goto :goto_17
 
-    :cond_5e
-    const/4 v5, 0x0
+    :cond_61
+    move v5, v3
 
     :goto_17
     invoke-virtual {v0, v2, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handlePackageRemoved(Ljava/lang/String;Z)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_20
-    const/4 v3, 0x1
+    const/4 v4, 0x1
 
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
 
@@ -9026,13 +9208,13 @@
 
     new-instance v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda22;
 
-    invoke-direct {v2, v1, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda22;-><init>(Ljava/lang/String;I)V
+    invoke-direct {v2, v1, v4}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda22;-><init>(Ljava/lang/String;I)V
 
     const/4 v1, 0x0
 
     invoke-virtual {v0, v1, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_21
     const/4 v2, 0x0
@@ -9049,47 +9231,12 @@
 
     invoke-virtual {v0, v2, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_22
-    sget-boolean v1, Landroid/os/Build;->IS_USERDEBUG:Z
-
-    if-nez v1, :cond_5f
-
-    sget-boolean v1, Landroid/os/Build;->IS_ENG:Z
-
-    if-eqz v1, :cond_68
-
-    :cond_5f
-    iget-object v0, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mPluginFaceWidgetManagerLazy:Ldagger/Lazy;
-
-    invoke-interface {v0}, Ldagger/Lazy;->get()Ljava/lang/Object;
-
-    move-result-object v0
-
-    move-object v3, v0
-
-    check-cast v3, Lcom/android/systemui/facewidget/plugin/PluginFaceWidgetManager;
-
-    iget-object v0, v3, Lcom/android/systemui/facewidget/plugin/PluginFaceWidgetManager;->mPluginManager:Lcom/android/systemui/plugins/PluginManager;
-
-    invoke-interface {v0, v3}, Lcom/android/systemui/plugins/PluginManager;->removePluginListener(Lcom/android/systemui/plugins/PluginListener;)V
-
-    iget-object v1, v3, Lcom/android/systemui/facewidget/plugin/PluginFaceWidgetManager;->mPluginManager:Lcom/android/systemui/plugins/PluginManager;
-
-    const-string v2, "com.samsung.systemui.action.PLUGIN_FACE_WIDGET"
-
-    const-class v4, Lcom/android/systemui/plugins/keyguardstatusview/PluginKeyguardStatusView;
-
-    const/4 v5, 0x0
-
-    const/4 v6, 0x1
-
-    const/4 v7, 0x0
-
-    invoke-interface/range {v1 .. v7}, Lcom/android/systemui/plugins/PluginManager;->addPluginListener(Ljava/lang/String;Lcom/android/systemui/plugins/PluginListener;Ljava/lang/Class;ZZI)V
+    invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleReconnectPluginFaceWidget()V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_23
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -9104,41 +9251,18 @@
 
     invoke-direct {v2, v1, v9}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda11;-><init>(II)V
 
-    const/4 v1, 0x0
-
-    invoke-virtual {v0, v1, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
+    invoke-virtual {v0, v3, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_24
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
 
     check-cast v1, Ljava/lang/String;
 
-    const-string v2, "com.android.settings"
-
-    invoke-virtual {v2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_60
-
-    iget-object v2, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSettingsHelper:Lcom/android/systemui/util/SettingsHelper;
-
-    invoke-virtual {v2}, Lcom/android/systemui/util/SettingsHelper;->readSettingsDB()V
-
-    :cond_60
-    new-instance v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda22;
-
-    const/4 v3, 0x0
-
-    invoke-direct {v2, v1, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda22;-><init>(Ljava/lang/String;I)V
-
-    const/4 v1, 0x0
-
-    invoke-virtual {v0, v1, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
+    invoke-virtual {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handlePackageDataCleared(Ljava/lang/String;)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_25
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -9151,7 +9275,7 @@
 
     invoke-virtual {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleDlsViewMode(I)V
 
-    goto/16 :goto_1b
+    goto/16 :goto_19
 
     :pswitch_26
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -9162,50 +9286,14 @@
 
     move-result v1
 
-    const-string v2, "handleDlsBiometricMode(), enabled="
-
-    const-string v3, "KeyguardUpdateMonitor"
-
-    invoke-static {v2, v1, v3}, Lcom/android/keyguard/KeyguardCarrierPasswordViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ZLjava/lang/String;)V
-
-    iget-boolean v2, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDynamicLockViewMode:Z
-
-    if-eq v2, v1, :cond_68
-
-    iput-boolean v1, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDynamicLockViewMode:Z
-
-    invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_61
+    invoke-virtual {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleDlsBiometricMode(Z)V
 
-    const/4 v1, 0x2
-
-    invoke-virtual {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
-
-    goto :goto_18
-
-    :cond_61
-    const/4 v1, 0x2
-
-    :goto_18
-    invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFaceOptionEnabled()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_68
-
-    sget-object v2, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_DYNAMIC_LOCK:Lcom/android/keyguard/FaceAuthUiEvent;
-
-    invoke-virtual {v0, v1, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
-
-    goto/16 :goto_1b
+    goto :goto_19
 
     :pswitch_27
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleLocaleChanged()V
 
-    goto/16 :goto_1b
+    goto :goto_19
 
     :cond_62
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -9214,7 +9302,7 @@
 
     invoke-virtual {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handleUpdateCoverState(Lcom/samsung/android/cover/CoverState;)V
 
-    goto :goto_1b
+    goto :goto_19
 
     :cond_63
     iget v1, v1, Landroid/os/Message;->arg1:I
@@ -9225,15 +9313,15 @@
 
     move v5, v2
 
-    goto :goto_19
+    goto :goto_18
 
     :cond_64
     move v5, v6
 
-    :goto_19
+    :goto_18
     invoke-virtual {v0, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->handlePrimaryBouncerVisibilityChanged(Z)V
 
-    goto :goto_1b
+    goto :goto_19
 
     :cond_65
     iget-object v1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -9246,7 +9334,7 @@
 
     iget-boolean v2, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsNotiStarShown:Z
 
-    if-eq v2, v1, :cond_68
+    if-eq v2, v1, :cond_67
 
     new-instance v2, Ljava/lang/StringBuilder;
 
@@ -9292,7 +9380,7 @@
 
     move-result v1
 
-    if-nez v1, :cond_68
+    if-nez v1, :cond_67
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isUnlockCompleted()Z
 
@@ -9300,29 +9388,19 @@
 
     if-nez v1, :cond_66
 
-    goto :goto_1b
+    goto :goto_19
 
     :cond_66
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-eqz v1, :cond_67
-
-    const/4 v1, 0x2
+    sget-object v1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_NOTI_STAR_STATE_CHANGED:Lcom/android/keyguard/FaceAuthUiEvent;
 
-    invoke-virtual {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    const/4 v2, 0x2
 
-    goto :goto_1a
+    invoke-virtual {v0, v2, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
     :cond_67
-    const/4 v1, 0x2
-
-    :goto_1a
-    sget-object v2, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_NOTI_STAR_STATE_CHANGED:Lcom/android/keyguard/FaceAuthUiEvent;
-
-    invoke-virtual {v0, v1, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
-
-    :cond_68
-    :goto_1b
+    :goto_19
     return-void
 
     :pswitch_data_0
@@ -9422,163 +9500,88 @@
     .end sparse-switch
 .end method
 
-.method public final handleServiceStateChange(IILandroid/telephony/ServiceState;)V
-    .locals 5
-
-    const-string v0, "handleServiceStateChange(subId="
-
-    const-string v1, ", slotId="
-
-    const-string v2, ", serviceState="
-
-    invoke-static {v0, p1, v1, p2, v2}, Landroidx/recyclerview/widget/GridLayoutManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;ILjava/lang/String;)Ljava/lang/StringBuilder;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
+.method public final handleSimStateChange(III)V
+    .locals 0
 
-    const-string v1, "KeyguardUpdateMonitor"
+    invoke-super {p0, p1, p2, p3}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleSimStateChange(III)V
 
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    return-void
+.end method
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_DISABLE_EMERGENCY_CALL_WHEN_OFFLINE:Z
+.method public final handleStartedGoingToSleep(I)V
+    .locals 5
 
-    if-eqz v0, :cond_4
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mServiceStatesBySlotId:Ljava/util/HashMap;
+    const/4 v1, 0x0
 
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    if-eqz v0, :cond_2
 
-    move-result-object p2
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isEnabledWof()Z
 
-    invoke-virtual {v0, p2, p3}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
+    move-result v0
 
-    iget-object p2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mServiceStatesBySlotId:Ljava/util/HashMap;
+    if-eqz v0, :cond_2
 
-    invoke-virtual {p2}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
+    sget v0, Lcom/android/systemui/util/DeviceType;->supportSideFingerprintExclusive:I
 
-    move-result-object p2
+    const/4 v2, -0x1
 
-    invoke-interface {p2}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
+    if-ne v0, v2, :cond_0
 
-    move-result-object p2
+    sput v1, Lcom/android/systemui/util/DeviceType;->supportSideFingerprintExclusive:I
 
     :cond_0
-    invoke-interface {p2}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v0
+    sget v0, Lcom/android/systemui/util/DeviceType;->supportSideFingerprintExclusive:I
 
     const/4 v2, 0x1
 
-    if-eqz v0, :cond_3
-
-    invoke-interface {p2}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Ljava/util/Map$Entry;
-
-    invoke-interface {v0}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/telephony/ServiceState;
-
-    if-eqz v0, :cond_0
-
-    invoke-virtual {v0}, Landroid/telephony/ServiceState;->getVoiceRegState()I
-
-    move-result v3
-
-    if-eq v3, v2, :cond_1
+    if-ne v0, v2, :cond_1
 
-    invoke-virtual {v0}, Landroid/telephony/ServiceState;->getVoiceRegState()I
-
-    move-result v3
-
-    const/4 v4, 0x3
+    move v0, v2
 
-    if-ne v3, v4, :cond_2
+    goto :goto_0
 
     :cond_1
-    invoke-virtual {v0}, Landroid/telephony/ServiceState;->getVoiceRegState()I
-
-    move-result v3
-
-    if-ne v3, v2, :cond_0
-
-    invoke-virtual {v0}, Landroid/telephony/ServiceState;->isEmergencyOnly()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    :cond_2
-    const/4 v2, 0x0
-
-    :cond_3
-    iget-boolean p2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsOutOfService:Z
-
-    if-eq p2, v2, :cond_4
-
-    iput-boolean v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsOutOfService:Z
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "updateOfflineState isOutOfService : "
-
-    invoke-direct {p2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsOutOfService:Z
-
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    move v0, v1
 
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    :goto_0
+    if-nez v0, :cond_2
 
-    move-result-object p2
+    const/4 v0, 0x2
 
-    invoke-static {v1, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    if-ne p1, v0, :cond_2
 
-    new-instance p2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda10;
+    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
 
-    const/4 v0, 0x5
+    iget-object v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mTimeoutSkipFPResponse:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$1;
 
-    invoke-direct {p2, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda10;-><init>(I)V
+    invoke-virtual {v0, v3}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V
 
-    const/4 v0, 0x0
+    iput-boolean v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
 
-    invoke-virtual {p0, v0, p2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
+    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
 
-    :cond_4
-    invoke-super {p0, p1, p3}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleServiceStateChange(ILandroid/telephony/ServiceState;)V
+    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mTimeoutSkipFPResponse:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$1;
 
-    return-void
-.end method
+    const-wide/16 v3, 0x2bc
 
-.method public final handleSimStateChange(III)V
-    .locals 0
+    invoke-virtual {v0, v2, v3, v4}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
 
-    invoke-super {p0, p1, p2, p3}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleSimStateChange(III)V
+    const-string v0, "KeyguardFingerprint"
 
-    return-void
-.end method
+    const-string v2, "ScreenOff by the powerKey. If it receives a response within 700ms, it will skip."
 
-.method public final handleStartedGoingToSleep(I)V
-    .locals 2
+    invoke-static {v0, v2}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
+    :cond_2
     sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_BACKGROUND_AUTHENTICATION:Z
 
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_0
+    if-eqz v0, :cond_3
 
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFPCanceledByForegroundApp:Z
 
-    :cond_0
+    :cond_3
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
 
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFaceWidgetFullScreenMode:Z
@@ -9587,22 +9590,22 @@
 
     sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
 
-    if-eqz v0, :cond_1
+    if-eqz v0, :cond_4
 
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mForceStartFinger:Z
 
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubBioAuth:Z
 
-    :cond_1
+    :cond_4
     invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFaceAuthenticated(Z)V
 
     sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_ESIM:Z
 
-    if-eqz v0, :cond_2
+    if-eqz v0, :cond_5
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->clearESimRemoved()V
 
-    :cond_2
+    :cond_5
     invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setUnlockingKeyguard(Z)V
 
     invoke-super {p0, p1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleStartedGoingToSleep(I)V
@@ -9611,24 +9614,47 @@
 .end method
 
 .method public final handleStartedWakingUp(I)V
-    .locals 2
+    .locals 3
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
     const/4 v1, 0x0
 
     if-eqz v0, :cond_0
 
-    iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubWofFpAuth:Z
+    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+
+    if-eqz v0, :cond_0
+
+    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
+
+    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mTimeoutSkipFPResponse:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$1;
+
+    invoke-virtual {v0, v2}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V
+
+    iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+
+    const-string/jumbo v0, "skip FP response canceled by handleStartedWakingUp : wakeup reason = "
+
+    const-string v2, "KeyguardFingerprint"
+
+    invoke-static {v0, p1, v2}, Landroidx/picker3/widget/SeslColorSpectrumView$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;)V
 
     :cond_0
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
+
+    if-eqz v0, :cond_1
+
+    iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubWofFpAuth:Z
+
+    :cond_1
     iget v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPhoneState:I
 
-    if-nez v0, :cond_1
+    if-nez v0, :cond_2
 
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFPCanceledByProximity:Z
 
-    :cond_1
+    :cond_2
     invoke-super {p0, p1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleStartedWakingUp(I)V
 
     return-void
@@ -10937,67 +10963,28 @@
     return v2
 .end method
 
-.method public final isInDisplayFingerprintMarginAccepted()Z
-    .locals 3
+.method public final isInDisplayFingerprintMarginAccepted()V
+    .locals 1
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->is2StepVerification()Z
 
     move-result v0
 
-    const/4 v1, 0x1
-
     if-nez v0, :cond_0
 
-    invoke-super {p0, v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isUnlockingWithBiometricAllowed(Z)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    :cond_0
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mCurrentSecurityMode:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
-
-    sget-object v2, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->Swipe:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
-
-    if-eq v0, v2, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFullscreenBouncer()Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/systemui/util/DeviceState;->isSmartViewDisplayWithFitToAspectRatio(Landroid/content/Context;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
+    const/4 v0, 0x1
 
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isForgotPasswordView()Z
+    invoke-super {p0, v0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isUnlockingWithBiometricAllowed(Z)Z
 
     move-result p0
 
-    if-nez p0, :cond_1
+    if-eqz p0, :cond_1
 
-    goto :goto_0
+    :cond_0
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_1
-    const/4 v1, 0x0
-
-    :goto_0
-    return v1
+    return-void
 .end method
 
 .method public final isKeyguardUnlocking()Z
@@ -11773,52 +11760,8 @@
     invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFaceAuthenticated(Z)V
 
     :cond_1
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_3
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_3
-
-    iget-object p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserFingerprintAuthenticated:Landroid/util/SparseArray;
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
-
-    check-cast v0, Lcom/android/systemui/settings/UserTrackerImpl;
-
-    invoke-virtual {v0}, Lcom/android/systemui/settings/UserTrackerImpl;->getUserId()I
-
-    move-result v0
-
-    invoke-virtual {p1, v0}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Lcom/android/keyguard/KeyguardUpdateMonitor$BiometricAuthenticated;
-
-    const/4 v0, 0x1
-
-    if-eqz p1, :cond_2
-
-    iget-boolean p1, p1, Lcom/android/keyguard/KeyguardUpdateMonitor$BiometricAuthenticated;->mIsStrongBiometric:Z
-
-    if-eqz p1, :cond_2
-
-    move v1, v0
-
-    :cond_2
-    invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isUnlockingWithBiometricAllowed(Z)Z
-
-    move-result p1
-
-    xor-int/2addr p1, v0
-
-    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFodStrictMode(Z)V
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_3
     return-void
 .end method
 
@@ -12416,11 +12359,26 @@
 .method public final sendFingerprintSALog(Ljava/lang/String;)V
     .locals 1
 
-    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v0, :cond_0
+
+    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+
+    if-eqz v0, :cond_0
+
+    const-string p0, "KeyguardFingerprint"
+
+    const-string p1, "Skip FP response logging"
+
+    invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    return-void
 
+    :cond_0
     iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mDeviceInteractive:Z
 
-    if-nez v0, :cond_0
+    if-nez v0, :cond_1
 
     const-string p0, "301"
 
@@ -12428,10 +12386,10 @@
 
     goto :goto_0
 
-    :cond_0
+    :cond_1
     iget-boolean p0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    if-eqz p0, :cond_1
+    if-eqz p0, :cond_2
 
     const-string p0, "102"
 
@@ -12439,7 +12397,7 @@
 
     goto :goto_0
 
-    :cond_1
+    :cond_2
     const-string p0, "101"
 
     const-string v0, "1096"
@@ -12479,26 +12437,9 @@
 
     invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-eqz v0, :cond_0
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardShowing:Z
-
-    if-nez v0, :cond_0
-
-    if-eqz p1, :cond_0
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
-
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWaitingFocusRunnable:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
-
-    const-wide/16 v2, 0x1f4
-
-    invoke-virtual {v0, v1, v2, v3}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mBackgroundExecutor:Ljava/util/concurrent/Executor;
+    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mBackgroundExecutor:Ljava/util/concurrent/Executor;
 
     new-instance v7, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda14;
 
@@ -12843,7 +12784,7 @@
     :cond_2
     iget-boolean p2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mHasFocus:Z
 
-    if-eqz p2, :cond_7
+    if-eqz p2, :cond_6
 
     iget p2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFocusWindow:I
 
@@ -12887,7 +12828,7 @@
 
     iget-boolean p1, p1, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_6
 
     :cond_4
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isKeyguardVisible()Z
@@ -12898,35 +12839,14 @@
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    if-eqz p1, :cond_7
-
-    :cond_5
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_6
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
-
-    move-result p1
-
     if-eqz p1, :cond_6
 
-    iget-object p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
-
-    new-instance p2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
-
-    const/4 v0, 0x2
-
-    invoke-direct {p2, p0, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;-><init>(Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;I)V
-
-    invoke-virtual {p1, p2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    :cond_6
+    :cond_5
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFaceOptionEnabled()Z
 
     move-result p1
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_6
 
     iget-object p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
 
@@ -12938,112 +12858,7 @@
 
     invoke-virtual {p1, p2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :cond_7
-    return-void
-.end method
-
-.method public final setFodStrictMode(Z)V
-    .locals 4
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_2
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFODStrictMode:Z
-
-    if-eq v0, p1, :cond_2
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mStrongAuthTracker:Lcom/android/keyguard/KeyguardUpdateMonitor$StrongAuthTracker;
-
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
-
-    check-cast v1, Lcom/android/systemui/settings/UserTrackerImpl;
-
-    invoke-virtual {v1}, Lcom/android/systemui/settings/UserTrackerImpl;->getUserId()I
-
-    move-result v1
-
-    invoke-virtual {v0, v1}, Lcom/android/internal/widget/LockPatternUtils$StrongAuthTracker;->getStrongAuthForUser(I)I
-
-    move-result v0
-
-    if-eqz p1, :cond_0
-
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFingerPrintBadQualityCounts:Landroid/util/SparseIntArray;
-
-    iget-object v2, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
-
-    check-cast v2, Lcom/android/systemui/settings/UserTrackerImpl;
-
-    invoke-virtual {v2}, Lcom/android/systemui/settings/UserTrackerImpl;->getUserId()I
-
-    move-result v2
-
-    const/4 v3, 0x0
-
-    invoke-virtual {v1, v2, v3}, Landroid/util/SparseIntArray;->get(II)I
-
-    move-result v1
-
-    const/16 v2, 0x1e
-
-    if-ge v1, v2, :cond_0
-
-    if-eqz v0, :cond_1
-
-    :cond_0
-    const/4 v3, 0x1
-
-    :cond_1
-    if-eqz v3, :cond_2
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "setFodStrictMode : "
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string v2, " strongAuth : "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v0, " callStack : "
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const/16 v0, 0xf
-
-    invoke-static {v0}, Landroid/os/Debug;->getCallers(I)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    sget-object v1, Lcom/android/systemui/log/LogLevel;->DEBUG:Lcom/android/systemui/log/LogLevel;
-
-    const/4 v2, 0x0
-
-    const-string v3, "KeyguardFingerprint"
-
-    invoke-static {v3, v1, v0, v2}, Lcom/android/systemui/keyguard/KeyguardDumpLog;->log(Ljava/lang/String;Lcom/android/systemui/log/LogLevel;Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    iput-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFODStrictMode:Z
-
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpm:Landroid/hardware/fingerprint/FingerprintManager;
-
-    if-eqz p0, :cond_2
-
-    invoke-virtual {p0, p1}, Landroid/hardware/fingerprint/FingerprintManager;->semSetFodStrictMode(Z)V
-
-    :cond_2
+    :cond_6
     return-void
 .end method
 
@@ -13171,7 +12986,7 @@
 .end method
 
 .method public final setKeyguardShowing(ZZ)V
-    .locals 5
+    .locals 4
 
     iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardOccluded:Z
 
@@ -13206,23 +13021,8 @@
     return-void
 
     :cond_2
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_3
-
-    if-nez v3, :cond_3
-
-    if-eqz p1, :cond_3
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
-
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWaitingFocusRunnable:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
-
-    const-wide/16 v3, 0x1f4
-
-    invoke-virtual {v0, v1, v3, v4}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_3
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isKeyguardVisible()Z
 
     move-result v0
@@ -13241,20 +13041,20 @@
 
     sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_BACKGROUND_AUTHENTICATION:Z
 
-    if-eqz p1, :cond_4
+    if-eqz p1, :cond_3
 
-    if-nez p2, :cond_4
+    if-nez p2, :cond_3
 
     iput-boolean v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFPCanceledByForegroundApp:Z
 
-    :cond_4
-    if-eq v1, v0, :cond_6
+    :cond_3
+    if-eq v1, v0, :cond_5
 
-    if-eqz v1, :cond_5
+    if-eqz v1, :cond_4
 
     iput-boolean v2, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mSecureCameraLaunched:Z
 
-    :cond_5
+    :cond_4
     new-instance p1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda12;
 
     invoke-direct {p1, v1, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda12;-><init>(ZI)V
@@ -13263,35 +13063,35 @@
 
     invoke-virtual {p0, p2, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    :cond_6
-    if-nez v1, :cond_7
+    :cond_5
+    if-nez v1, :cond_6
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    if-nez p1, :cond_7
+    if-nez p1, :cond_6
 
     invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setUnlockingKeyguard(Z)V
 
-    :cond_7
+    :cond_6
     const/4 p1, 0x2
 
     invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
 
     iget-boolean p2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mKeyguardUnlocking:Z
 
-    if-nez p2, :cond_8
+    if-nez p2, :cond_7
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isUnlockCompleted()Z
 
     move-result p2
 
-    if-eqz p2, :cond_8
+    if-eqz p2, :cond_7
 
     sget-object p2, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_KEYGUARD_VISIBILITY_CHANGED:Lcom/android/keyguard/FaceAuthUiEvent;
 
     invoke-virtual {p0, p1, p2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
-    :cond_8
+    :cond_7
     return-void
 .end method
 
@@ -13408,64 +13208,25 @@
 .end method
 
 .method public final setPanelExpandingStarted(Z)V
-    .locals 5
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    .locals 1
 
-    if-eqz v0, :cond_0
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFaceOptionEnabled()Z
 
     move-result v0
 
     if-eqz v0, :cond_0
 
-    move v0, p1
-
-    goto :goto_0
-
-    :cond_0
-    const/4 v0, 0x0
-
-    :goto_0
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFaceOptionEnabled()Z
-
-    move-result v1
-
-    const/4 v2, 0x2
-
-    if-eqz v1, :cond_1
-
-    if-nez p1, :cond_1
+    if-nez p1, :cond_0
 
     sget-object p1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_QS_FULLY_EXPANDED:Lcom/android/keyguard/FaceAuthUiEvent;
 
-    invoke-virtual {p0, v2, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
-
-    :cond_1
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsPanelExpandingStarted:Z
-
-    if-eq p1, v0, :cond_2
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "setPanelExpandingStarted() mIsPanelExpandingStarted = "
-
-    invoke-direct {p1, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsPanelExpandingStarted:Z
-
-    const-string v3, " -> "
-
-    const-string v4, "KeyguardUpdateMonitor"
-
-    invoke-static {p1, v1, v3, v0, v4}, Lcom/android/keyguard/KeyguardCarrierViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
-
-    iput-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsPanelExpandingStarted:Z
+    const/4 v0, 0x2
 
-    invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    invoke-virtual {p0, v0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
-    :cond_2
+    :cond_0
     return-void
 .end method
 
@@ -13492,13 +13253,30 @@
 
     iput-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
 
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-eqz p1, :cond_0
+    :cond_0
+    return-void
+.end method
 
-    const/4 p1, 0x2
+.method public final setShowingKeepScreenOnPopup(Z)V
+    .locals 3
 
-    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
+
+    move-result v0
+
+    if-eqz v0, :cond_0
+
+    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
+
+    new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda13;
+
+    const/4 v2, 0x1
+
+    invoke-direct {v1, p0, p1, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda13;-><init>(Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;ZI)V
+
+    invoke-virtual {v0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
     :cond_0
     return-void
@@ -13615,38 +13393,17 @@
 
     invoke-virtual {v0, v1, v2}, Lcom/android/systemui/util/SettingsHelper;->registerCallback(Lcom/android/systemui/util/SettingsHelper$OnChangedCallback;[Landroid/net/Uri;)V
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSettingsHelper:Lcom/android/systemui/util/SettingsHelper;
-
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mOneHandModeSettingsCallback:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda6;
-
-    const-string v2, "any_screen_running"
-
-    invoke-static {v2}, Landroid/provider/Settings$System;->getUriFor(Ljava/lang/String;)Landroid/net/Uri;
-
-    move-result-object v2
-
-    filled-new-array {v2}, [Landroid/net/Uri;
-
-    move-result-object v2
-
-    invoke-virtual {v0, v1, v2}, Lcom/android/systemui/util/SettingsHelper;->registerCallback(Lcom/android/systemui/util/SettingsHelper$OnChangedCallback;[Landroid/net/Uri;)V
-
-    :cond_0
     sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
 
-    if-nez v0, :cond_1
+    if-nez v0, :cond_0
 
     sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
 
-    if-nez v0, :cond_1
+    if-nez v0, :cond_0
 
     goto :goto_0
 
-    :cond_1
+    :cond_0
     const-class v0, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
     invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
@@ -13690,13 +13447,13 @@
 
     move-result-object v1
 
-    if-nez v1, :cond_2
+    if-nez v1, :cond_1
 
     const/4 v0, 0x0
 
     goto :goto_1
 
-    :cond_2
+    :cond_1
     new-instance v2, Landroid/content/ComponentName;
 
     iget-object v1, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
@@ -14320,7 +14077,7 @@
 .end method
 
 .method public final shouldListenForFingerprint(Z)Z
-    .locals 13
+    .locals 11
 
     iget-object p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
 
@@ -14342,7 +14099,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_2a
+    if-eqz v2, :cond_18
 
     iget-boolean v2, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mDeviceInteractive:Z
 
@@ -14526,91 +14283,91 @@
 
     invoke-static {v7, v0, v9, v6, v10}, Lcom/android/keyguard/KeyguardKnoxGuardViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ZLjava/lang/String;ZLjava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v7
+    move-result-object v6
 
-    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    const-string v9, " , mPrimaryBouncerIsOrWillBeShowing = "
+    const-string v7, " , mPrimaryBouncerIsOrWillBeShowing = "
 
-    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-boolean v9, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerIsOrWillBeShowing:Z
+    iget-boolean v7, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerIsOrWillBeShowing:Z
 
-    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    const-string v9, " , mPrimaryBouncerFullyShown = "
+    const-string v7, " , mPrimaryBouncerFullyShown = "
 
-    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-boolean v9, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
+    iget-boolean v7, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    const-string v10, " , mGoingToSleep = "
+    const-string v9, " , mGoingToSleep = "
 
-    const-string v11, " , mSwitchingUser = "
+    const-string v10, " , mSwitchingUser = "
 
-    invoke-static {v7, v9, v10, v5, v11}, Lcom/android/keyguard/KeyguardFaceListenModel$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
+    invoke-static {v6, v7, v9, v5, v10}, Lcom/android/keyguard/KeyguardFaceListenModel$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
     const-string v3, " , mIsDreamingForBiometrics = "
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDreamingForBiometrics:Z
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
     const-string v3, " , mKeyguardUnlocking = "
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mKeyguardUnlocking:Z
 
-    const-string v9, " , mKeyguardGoingAway = "
+    const-string v5, " , mKeyguardGoingAway = "
 
-    const-string v10, " , mKeyguardShowing = "
+    const-string v7, " , mKeyguardShowing = "
 
-    invoke-static {v7, v3, v9, v4, v10}, Lcom/android/keyguard/KeyguardFaceListenModel$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
+    invoke-static {v6, v3, v5, v4, v7}, Lcom/android/keyguard/KeyguardFaceListenModel$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardShowing:Z
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
     const-string v3, " , mKeyguardOccluded = "
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardOccluded:Z
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
     const-string v3, " , mSystemReady = "
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSystemReady:Z
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
     const-string v3, " , mHasFocus = "
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mHasFocus:Z
 
     const-string v4, "KeyguardFingerprint"
 
-    invoke-static {v7, v3, v4}, Landroidx/appcompat/widget/ActionBarContextView$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;)V
+    invoke-static {v6, v3, v4}, Landroidx/appcompat/widget/ActionBarContextView$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;)V
 
-    if-eqz v0, :cond_2a
+    if-eqz v0, :cond_18
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getLockoutBiometricAttemptDeadline()J
 
-    move-result-wide v9
+    move-result-wide v5
 
-    const-wide/16 v11, 0x0
+    const-wide/16 v9, 0x0
 
-    cmp-long v0, v9, v11
+    cmp-long v0, v5, v9
 
     if-lez v0, :cond_7
 
@@ -14623,9 +14380,9 @@
     :cond_7
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getLockoutAttemptDeadline()J
 
-    move-result-wide v9
+    move-result-wide v5
 
-    cmp-long v0, v9, v11
+    cmp-long v0, v5, v9
 
     if-lez v0, :cond_8
 
@@ -14749,565 +14506,197 @@
     :cond_f
     const-class v3, Lcom/android/systemui/statusbar/policy/SecurityController;
 
-    invoke-static {v3}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    if-nez v3, :cond_10
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, dependency class destroy)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_10
-    sget-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
-
-    if-eqz v3, :cond_11
-
-    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mForceStartFinger:Z
-
-    if-nez v3, :cond_11
-
-    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubBioAuth:Z
-
-    if-nez v3, :cond_11
-
-    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubWofFpAuth:Z
-
-    if-nez v3, :cond_11
-
-    const-class v3, Lcom/android/systemui/keyguard/DisplayLifecycle;
-
-    invoke-static {v3}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/systemui/keyguard/DisplayLifecycle;
-
-    iget-boolean v3, v3, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
-
-    if-nez v3, :cond_11
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, folder is closed )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_11
-    iget-object v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSettingsHelper:Lcom/android/systemui/util/SettingsHelper;
-
-    invoke-virtual {v3}, Lcom/android/systemui/util/SettingsHelper;->isScreenOffMemoEnabled()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_12
-
-    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsRunningBlackMemo:Z
-
-    if-eqz v3, :cond_12
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, because Screen off Memo is running. )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_12
-    invoke-virtual {p0, v8}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isUnlockingWithBiometricAllowed(Z)Z
-
-    move-result v3
-
-    if-nez v3, :cond_13
-
-    if-eqz v2, :cond_13
-
-    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardOccluded:Z
-
-    if-eqz v3, :cond_13
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, strong auth with occluded )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_13
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->is2StepVerification()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_14
-
-    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    if-eqz v3, :cond_14
-
-    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/systemui/knox/KnoxStateMonitor;
-
-    check-cast v3, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
-
-    invoke-virtual {v3, p1}, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->isDualDarDeviceOwner(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_14
-
-    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/systemui/knox/KnoxStateMonitor;
-
-    check-cast v3, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
-
-    invoke-virtual {v3, p1}, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->isDualDarInnerAuthRequired(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_14
-
-    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/systemui/knox/KnoxStateMonitor;
-
-    check-cast v0, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
-
-    invoke-virtual {v0}, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->getDualDarInnerLockoutAttemptDeadline()J
-
-    move-result-wide v9
-
-    cmp-long v0, v9, v11
-
-    if-lez v0, :cond_14
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, because of lockoutAttemptDeadline of dualdar do inner user )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_14
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFPCanceledByProximity:Z
-
-    if-eqz v0, :cond_15
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, screen off by proximity)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_15
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isForgotPasswordView()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_16
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, Showing forgot password view )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_16
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_29
-
-    sget-object v0, Lcom/android/systemui/noticenter/NotiCenterPlugin;->INSTANCE:Lcom/android/systemui/noticenter/NotiCenterPlugin;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/android/systemui/noticenter/NotiCenterPlugin;->isNotiCenterPluginConnected()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_17
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsNotiStarShown:Z
-
-    if-eqz v0, :cond_17
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
-
-    if-nez v0, :cond_17
-
-    if-eqz v2, :cond_17
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, NotiStar is shown )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_17
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
-
-    if-nez v0, :cond_18
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsQsFullyExpanded:Z
-
-    if-nez v0, :cond_19
-
-    :cond_18
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFaceWidgetFullScreenMode:Z
-
-    if-eqz v0, :cond_1a
-
-    :cond_19
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "shouldListenForFingerprint ( return false, because mIsQsFullyExpanded = "
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsQsFullyExpanded:Z
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string v0, ", or mIsFaceWidgetFullScreen="
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-boolean p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFaceWidgetFullScreenMode:Z
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string p0, " )"
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_1a
-    invoke-virtual {p0, v8}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isUnlockingWithBiometricAllowed(Z)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1b
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, strong auth with in-display fingerprint)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_1b
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
-
-    if-eqz v0, :cond_1c
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, shortcut preview is showing )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_1c
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
-
-    if-nez v0, :cond_1d
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsPanelExpandingStarted:Z
-
-    if-eqz v0, :cond_1d
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, quick panel is showing )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_1d
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSettingsHelper:Lcom/android/systemui/util/SettingsHelper;
-
-    invoke-virtual {v0}, Lcom/android/systemui/util/SettingsHelper;->isOneHandModeRunning()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1e
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, one hand mode is running)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_1e
-    iget v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mCocktailBarWindowType:I
-
-    const/4 v3, 0x2
-
-    if-ne v0, v3, :cond_1f
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, the cocktail bar is expanded)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_1f
-    if-eqz v2, :cond_20
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDreamingForBiometrics:Z
-
-    if-nez v0, :cond_20
-
-    if-eqz v6, :cond_20
-
-    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getUserHasTrust(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_20
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, getUserHasTrust() is true)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_20
-    invoke-static {}, Landroid/os/Process;->myUserHandle()Landroid/os/UserHandle;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Landroid/os/UserHandle;->getIdentifier()I
-
-    move-result v0
-
-    if-eqz v0, :cond_21
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, this process is for the sub-user)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_21
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
-
-    const-string v3, "KeyguardUpdateMonitor"
-
-    if-nez v0, :cond_22
+    invoke-static {v3}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    iget-boolean v6, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDynamicLockViewMode:Z
+    move-result-object v3
 
-    if-eqz v6, :cond_22
+    if-nez v3, :cond_10
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, DynamicLockViewMode"
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, dependency class destroy)"
 
-    invoke-static {v3, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return v1
 
-    :cond_22
-    if-eqz v0, :cond_23
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSIPShown:Z
-
-    if-eqz v0, :cond_23
+    :cond_10
+    sget-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, SIP is showing )"
+    if-eqz v3, :cond_11
 
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mForceStartFinger:Z
 
-    return v1
+    if-nez v3, :cond_11
 
-    :cond_23
-    if-eqz v2, :cond_24
+    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubBioAuth:Z
 
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardShowing:Z
+    if-nez v3, :cond_11
 
-    if-eqz v0, :cond_24
+    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubWofFpAuth:Z
 
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mHasFocus:Z
+    if-nez v3, :cond_11
 
-    if-nez v0, :cond_24
+    const-class v3, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
+    invoke-static {v3}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWaitingFocusRunnable:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
+    move-result-object v3
 
-    invoke-virtual {v0, v2}, Landroid/os/Handler;->hasCallbacks(Ljava/lang/Runnable;)Z
+    check-cast v3, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
-    move-result v0
+    iget-boolean v3, v3, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
 
-    if-nez v0, :cond_24
+    if-nez v3, :cond_11
 
-    if-nez v5, :cond_24
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, folder is closed )"
 
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mDesktopManagerLazy:Ldagger/Lazy;
+    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-interface {v0}, Ldagger/Lazy;->get()Ljava/lang/Object;
+    return v1
 
-    move-result-object v0
+    :cond_11
+    iget-object v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSettingsHelper:Lcom/android/systemui/util/SettingsHelper;
 
-    check-cast v0, Lcom/android/systemui/util/DesktopManager;
+    invoke-virtual {v3}, Lcom/android/systemui/util/SettingsHelper;->isScreenOffMemoEnabled()Z
 
-    check-cast v0, Lcom/android/systemui/util/DesktopManagerImpl;
+    move-result v3
 
-    invoke-virtual {v0}, Lcom/android/systemui/util/DesktopManagerImpl;->isDualView()Z
+    if-eqz v3, :cond_12
 
-    move-result v0
+    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsRunningBlackMemo:Z
 
-    if-nez v0, :cond_24
+    if-eqz v3, :cond_12
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, Not focus on NotificationShade )"
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, because Screen off Memo is running. )"
 
     invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return v1
 
-    :cond_24
-    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getFaceAuthenticated(I)Z
+    :cond_12
+    sget-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
-    move-result p1
+    if-eqz v3, :cond_13
 
-    if-eqz p1, :cond_25
+    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShowingKeepScreenOnPopup:Z
+
+    if-eqz v3, :cond_13
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, Face authenticated)"
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, because keep screen on popup is showing. )"
 
     invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return v1
 
-    :cond_25
-    iget-object p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mDesktopManagerLazy:Ldagger/Lazy;
+    :cond_13
+    invoke-virtual {p0, v8}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isUnlockingWithBiometricAllowed(Z)Z
 
-    invoke-interface {p1}, Ldagger/Lazy;->get()Ljava/lang/Object;
+    move-result v3
 
-    move-result-object p1
+    if-nez v3, :cond_14
 
-    check-cast p1, Lcom/android/systemui/util/DesktopManager;
+    if-eqz v2, :cond_14
 
-    check-cast p1, Lcom/android/systemui/util/DesktopManagerImpl;
+    iget-boolean v2, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardOccluded:Z
 
-    invoke-virtual {p1}, Lcom/android/systemui/util/DesktopManagerImpl;->isDualView()Z
+    if-eqz v2, :cond_14
 
-    move-result p1
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, strong auth with occluded )"
 
-    if-eqz p1, :cond_28
+    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
+    return v1
 
-    if-eqz p1, :cond_26
+    :cond_14
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->is2StepVerification()Z
 
-    goto :goto_5
+    move-result v2
 
-    :cond_26
-    :try_start_0
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWindowManagerService:Landroid/view/IWindowManager;
+    if-eqz v2, :cond_15
 
-    invoke-interface {p0}, Landroid/view/IWindowManager;->getVisibleWindowInfoList()Ljava/util/List;
+    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    move-result-object p0
+    move-result-object v2
 
-    invoke-interface {p0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
+    if-eqz v2, :cond_15
 
-    move-result-object p0
+    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    :cond_27
-    invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
+    move-result-object v2
 
-    move-result p1
+    check-cast v2, Lcom/android/systemui/knox/KnoxStateMonitor;
 
-    if-eqz p1, :cond_28
+    check-cast v2, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
 
-    invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+    invoke-virtual {v2, p1}, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->isDualDarDeviceOwner(I)Z
 
-    move-result-object p1
+    move-result v2
 
-    check-cast p1, Lcom/samsung/android/view/SemWindowManager$VisibleWindowInfo;
+    if-eqz v2, :cond_15
 
-    iget v0, p1, Lcom/samsung/android/view/SemWindowManager$VisibleWindowInfo;->type:I
+    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    const/16 v2, 0x7d9
+    move-result-object v2
 
-    if-ne v0, v2, :cond_27
+    check-cast v2, Lcom/android/systemui/knox/KnoxStateMonitor;
 
-    new-instance p0, Ljava/lang/StringBuilder;
+    check-cast v2, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
 
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-virtual {v2, p1}, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->isDualDarInnerAuthRequired(I)Z
 
-    const-string v0, "hasPopupOnDualView "
+    move-result p1
 
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    if-eqz p1, :cond_15
 
-    iget-object p1, p1, Lcom/samsung/android/view/SemWindowManager$VisibleWindowInfo;->name:Ljava/lang/String;
+    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    move-result-object p1
 
-    const-string p1, " is showing"
+    check-cast p1, Lcom/android/systemui/knox/KnoxStateMonitor;
 
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    check-cast p1, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
 
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {p1}, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->getDualDarInnerLockoutAttemptDeadline()J
 
-    move-result-object p0
+    move-result-wide v2
 
-    invoke-static {v3, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_1
-    .catch Ljava/lang/NullPointerException; {:try_start_0 .. :try_end_0} :catch_0
+    cmp-long p1, v2, v9
 
-    move p0, v8
+    if-lez p1, :cond_15
 
-    goto :goto_6
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, because of lockoutAttemptDeadline of dualdar do inner user )"
 
-    :catch_0
-    move-exception p0
+    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {p0}, Ljava/lang/NullPointerException;->toString()Ljava/lang/String;
+    return v1
 
-    move-result-object p0
+    :cond_15
+    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFPCanceledByProximity:Z
 
-    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    if-eqz p1, :cond_16
 
-    goto :goto_5
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, screen off by proximity)"
 
-    :catch_1
-    move-exception p0
+    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    const-string p1, "Fail to check windows by RemoteException"
+    return v1
 
-    invoke-static {v3, p1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    :cond_16
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isForgotPasswordView()Z
 
-    :cond_28
-    :goto_5
-    move p0, v1
+    move-result p0
 
-    :goto_6
-    if-eqz p0, :cond_29
+    if-eqz p0, :cond_17
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, Popup showing on Dex dual view )"
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, Showing forgot password view )"
 
     invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return v1
 
-    :cond_29
+    :cond_17
     return v8
 
-    :cond_2a
+    :cond_18
     return v1
 .end method
 
@@ -15817,7 +15206,7 @@
 .end method
 
 .method public final stopListeningForFingerprint()V
-    .locals 2
+    .locals 3
 
     const-string v0, "KeyguardUpdateMonitor"
 
@@ -15840,8 +15229,29 @@
 
     invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->setFingerprintRunningState(I)V
 
-    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v1, :cond_1
+
+    iget-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+
+    if-eqz v1, :cond_1
+
+    iget-object v1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
+
+    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mTimeoutSkipFPResponse:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$1;
+
+    invoke-virtual {v1, v2}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V
+
+    iput-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+
+    const-string p0, "KeyguardFingerprint"
+
+    const-string/jumbo v0, "skip FP response canceled by stopListeningForFingerprint"
+
+    invoke-static {p0, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
+    :cond_1
     return-void
 .end method
 
@@ -16610,7 +16020,7 @@
 .end method
 
 .method public final updateFingerprintListeningState(I)V
-    .locals 6
+    .locals 5
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
 
@@ -16635,67 +16045,59 @@
 
     const/4 v3, 0x1
 
-    if-eq v2, v3, :cond_2
+    if-eq v2, v3, :cond_1
 
     const/4 v4, 0x3
 
-    if-ne v2, v4, :cond_1
-
-    goto :goto_0
+    if-ne v2, v4, :cond_2
 
     :cond_1
-    move v2, v0
-
-    goto :goto_1
+    move v0, v3
 
     :cond_2
-    :goto_0
-    move v2, v3
-
-    :goto_1
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v2, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v5, "updateFingerprintListeningState#mFingerprintRunningState="
+    const-string/jumbo v4, "updateFingerprintListeningState#mFingerprintRunningState="
 
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v2, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget v5, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mFingerprintRunningState:I
+    iget v4, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mFingerprintRunningState:I
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v5, " shouldListenForFingerprint="
+    const-string v4, " shouldListenForFingerprint="
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    const-string v5, " isUdfpsEnrolled=false bioType : "
+    const-string v4, " isUdfpsEnrolled=false bioType : "
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-object v5, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
+    iget-object v4, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
 
-    check-cast v5, Lcom/android/systemui/settings/UserTrackerImpl;
+    check-cast v4, Lcom/android/systemui/settings/UserTrackerImpl;
 
-    invoke-virtual {v5}, Lcom/android/systemui/settings/UserTrackerImpl;->getUserId()I
+    invoke-virtual {v4}, Lcom/android/systemui/settings/UserTrackerImpl;->getUserId()I
 
-    move-result v5
+    move-result v4
 
-    invoke-virtual {p0, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getBiometricType(I)I
+    invoke-virtual {p0, v4}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getBiometricType(I)I
 
-    move-result v5
+    move-result v4
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v2
 
-    const-string v5, "KeyguardFingerprint"
+    const-string v4, "KeyguardFingerprint"
 
-    invoke-static {v5, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-eqz v2, :cond_4
+    if-eqz v0, :cond_4
 
     if-nez v1, :cond_4
 
@@ -16712,10 +16114,10 @@
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->stopListeningForFingerprint()V
 
-    goto :goto_2
+    goto :goto_0
 
     :cond_4
-    if-nez v2, :cond_6
+    if-nez v0, :cond_6
 
     if-eqz v1, :cond_6
 
@@ -16728,71 +16130,19 @@
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->startListeningForFingerprint()V
 
-    goto :goto_2
+    goto :goto_0
 
     :cond_6
-    if-nez v2, :cond_7
+    if-nez v0, :cond_7
 
     if-nez v1, :cond_7
 
-    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_7
-    :goto_2
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_a
-
-    if-nez v1, :cond_8
-
-    goto :goto_3
-
-    :cond_8
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mDeviceInteractive:Z
-
-    if-eqz p1, :cond_9
-
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mGoingToSleep:Z
-
-    if-nez p1, :cond_9
-
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDreamingForBiometrics:Z
-
-    if-nez p1, :cond_9
-
-    move v0, v3
-
-    :cond_9
-    xor-int/lit8 p1, v0, 0x1
-
-    iget v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpInDisplayState:I
-
-    if-eq v0, p1, :cond_a
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpm:Landroid/hardware/fingerprint/FingerprintManager;
-
-    if-eqz v0, :cond_a
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string v1, "mFpInDisplayState is changed : "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpInDisplayState:I
-
-    const-string v2, " -> "
-
-    invoke-static {v0, v1, v2, p1, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;ILjava/lang/String;)V
-
-    iput p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpInDisplayState:I
-
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpm:Landroid/hardware/fingerprint/FingerprintManager;
-
-    invoke-virtual {p0, p1}, Landroid/hardware/fingerprint/FingerprintManager;->semSetScreenStatus(I)I
+    :goto_0
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_a
-    :goto_3
     return-void
 .end method
 
@@ -17113,35 +16463,6 @@
     return-void
 .end method
 
-.method public final updateSIPShownState(Z)V
-    .locals 2
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSIPShown:Z
-
-    if-eq v0, p1, :cond_0
-
-    const-string/jumbo v0, "updateSIPShownState : "
-
-    const-string v1, "KeyguardUpdateMonitor"
-
-    invoke-static {v0, p1, v1}, Lcom/android/keyguard/KeyguardCarrierPasswordViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ZLjava/lang/String;)V
-
-    iput-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSIPShown:Z
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    const/4 p1, 0x2
-
-    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
-
-    :cond_0
-    return-void
-.end method
-
 .method public final updateSecureLockTimeout(I)Z
     .locals 7
 
diff --git a/smali/com/android/keyguard/KeyguardTextBuilder.smali b/smali/com/android/keyguard/KeyguardTextBuilder.smali
index d42286a4..a71500eb 100644
--- a/smali/com/android/keyguard/KeyguardTextBuilder.smali
+++ b/smali/com/android/keyguard/KeyguardTextBuilder.smali
@@ -519,7 +519,7 @@
 
     move-result-object p1
 
-    goto/16 :goto_6
+    goto :goto_6
 
     :cond_c
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->ShutDown:Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;
@@ -580,9 +580,7 @@
     goto :goto_8
 
     :cond_e
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez p1, :cond_f
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFingerprint:Z
 
@@ -1320,7 +1318,7 @@
     :goto_3
     iput-boolean v2, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    if-nez p1, :cond_d
+    if-nez p1, :cond_b
 
     if-eqz v6, :cond_4
 
@@ -1340,98 +1338,64 @@
     :goto_4
     iput-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFingerprint:Z
 
-    sget-boolean v2, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v2, :cond_6
-
-    if-eqz p1, :cond_5
-
-    invoke-virtual {v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFingerprintDetectionRunning()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_5
-
-    move p1, v4
-
-    goto :goto_5
-
-    :cond_5
-    move p1, v3
-
-    :goto_5
-    iput-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFingerprint:Z
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_6
     invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->is2StepVerification()Z
 
     move-result p1
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_5
 
     invoke-virtual {v1, v0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getUserUnlockedWithBiometric(I)Z
 
     move-result p1
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_5
 
     iput-boolean v3, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFingerprint:Z
 
-    :cond_7
+    :cond_5
     invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isCameraDisabledByPolicy()Z
 
     move-result p1
 
-    if-nez p1, :cond_b
+    if-nez p1, :cond_9
 
     invoke-virtual {v1, v0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFaceDisabled(I)Z
 
     move-result p1
 
-    if-eqz p1, :cond_8
+    if-eqz p1, :cond_6
 
     goto :goto_6
 
-    :cond_8
+    :cond_6
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    if-nez p1, :cond_9
-
-    if-eqz v2, :cond_a
-
-    const-class p1, Lcom/android/systemui/util/SettingsHelper;
-
-    invoke-static {p1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Lcom/android/systemui/util/SettingsHelper;
+    if-nez p1, :cond_7
 
-    invoke-virtual {p1}, Lcom/android/systemui/util/SettingsHelper;->isOneHandModeRunning()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_a
+    goto :goto_5
 
-    :cond_9
+    :cond_7
     invoke-virtual {v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFaceDetectionRunning()Z
 
     move-result p1
 
-    if-eqz p1, :cond_a
+    if-eqz p1, :cond_8
 
     move v3, v4
 
-    :cond_a
+    :cond_8
+    :goto_5
     iput-boolean v3, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
     goto :goto_7
 
-    :cond_b
+    :cond_9
     :goto_6
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    if-eqz p1, :cond_c
+    if-eqz p1, :cond_a
 
     invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->getFaceStrongBiometric()Z
 
@@ -1441,24 +1405,24 @@
 
     move-result p1
 
-    if-eqz p1, :cond_c
+    if-eqz p1, :cond_a
 
     move v3, v4
 
-    :cond_c
+    :cond_a
     iput-boolean v3, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    :cond_d
+    :cond_b
     :goto_7
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFingerprint:Z
 
     const-string v0, "none"
 
-    if-eqz p1, :cond_e
+    if-eqz p1, :cond_c
 
     iget-boolean v2, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    if-eqz v2, :cond_e
+    if-eqz v2, :cond_c
 
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$Biometric;->MultiBiometrics:Lcom/android/keyguard/KeyguardTextBuilder$Biometric;
 
@@ -1470,8 +1434,8 @@
 
     goto :goto_8
 
-    :cond_e
-    if-eqz p1, :cond_f
+    :cond_c
+    if-eqz p1, :cond_d
 
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$Biometric;->Fingerprint:Lcom/android/keyguard/KeyguardTextBuilder$Biometric;
 
@@ -1483,10 +1447,10 @@
 
     goto :goto_8
 
-    :cond_f
+    :cond_d
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    if-eqz p1, :cond_10
+    if-eqz p1, :cond_e
 
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$Biometric;->Face:Lcom/android/keyguard/KeyguardTextBuilder$Biometric;
 
@@ -1498,7 +1462,7 @@
 
     goto :goto_8
 
-    :cond_10
+    :cond_e
     iput-object v0, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mBiometricType:Ljava/lang/String;
 
     :goto_8
@@ -1506,7 +1470,7 @@
 
     move-result p1
 
-    if-eqz p1, :cond_14
+    if-eqz p1, :cond_12
 
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$2;->$SwitchMap$com$android$keyguard$KeyguardConstants$KeyguardDismissActionType:[I
 
@@ -1520,21 +1484,21 @@
 
     aget p1, p1, v1
 
-    if-eq p1, v4, :cond_13
+    if-eq p1, v4, :cond_11
 
     const/4 v1, 0x2
 
-    if-eq p1, v1, :cond_12
+    if-eq p1, v1, :cond_10
 
     const/4 v1, 0x3
 
-    if-eq p1, v1, :cond_11
+    if-eq p1, v1, :cond_f
 
     iput-object v0, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mDismissActionType:Ljava/lang/String;
 
     goto :goto_9
 
-    :cond_11
+    :cond_f
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->FingerPrintError:Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;
 
     invoke-virtual {p1}, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->getType()Ljava/lang/String;
@@ -1545,7 +1509,7 @@
 
     goto :goto_9
 
-    :cond_12
+    :cond_10
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->Reboot:Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;
 
     invoke-virtual {p1}, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->getType()Ljava/lang/String;
@@ -1556,7 +1520,7 @@
 
     goto :goto_9
 
-    :cond_13
+    :cond_11
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->ShutDown:Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;
 
     invoke-virtual {p1}, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->getType()Ljava/lang/String;
@@ -1567,16 +1531,16 @@
 
     goto :goto_9
 
-    :cond_14
+    :cond_12
     invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isForgotPasswordView()Z
 
     move-result p1
 
-    if-eqz p1, :cond_15
+    if-eqz p1, :cond_13
 
     const-string v0, "prev"
 
-    :cond_15
+    :cond_13
     iput-object v0, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mDismissActionType:Ljava/lang/String;
 
     :goto_9
diff --git a/smali/com/android/keyguard/SecLockIconViewController$3.smali b/smali/com/android/keyguard/SecLockIconViewController$3.smali
index 3e85c253..f0876b2c 100644
--- a/smali/com/android/keyguard/SecLockIconViewController$3.smali
+++ b/smali/com/android/keyguard/SecLockIconViewController$3.smali
@@ -44,9 +44,7 @@
 .method public final onLockModeChanged()V
     .locals 1
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez v0, :cond_0
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     iget-object p0, p0, Lcom/android/keyguard/SecLockIconViewController$3;->this$0:Lcom/android/keyguard/SecLockIconViewController;
 
diff --git a/smali/com/android/keyguard/SecurityUtils.smali b/smali/com/android/keyguard/SecurityUtils.smali
index 974278ad..6168bc27 100644
--- a/smali/com/android/keyguard/SecurityUtils.smali
+++ b/smali/com/android/keyguard/SecurityUtils.smali
@@ -41,7 +41,7 @@
 .end method
 
 .method public static calculateLandscapeViewWidth(ILandroid/content/Context;)I
-    .locals 2
+    .locals 1
 
     invoke-virtual {p1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
@@ -53,36 +53,23 @@
 
     move-result p1
 
-    mul-int/lit8 v0, p1, 0x2
-
-    sub-int v0, p0, v0
-
-    div-int/lit8 v0, v0, 0x2
-
-    const-class v1, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-static {v1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+    mul-int/lit8 p1, p1, 0x2
 
-    move-result-object v1
-
-    check-cast v1, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    sub-int/2addr p0, p1
 
-    move-result v1
+    div-int/lit8 p0, p0, 0x2
 
-    if-eqz v1, :cond_0
+    const-class p1, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    sub-int/2addr p0, p1
+    invoke-static {p1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    sget p1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    move-result-object p1
 
-    sub-int/2addr p0, p1
+    check-cast p1, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    div-int/lit8 v0, p0, 0x2
+    invoke-interface {p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    :cond_0
-    return v0
+    return p0
 .end method
 
 .method public static checkFullscreenBouncer(Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;)Z
diff --git a/smali/com/android/keyguard/StrongAuthPopup.smali b/smali/com/android/keyguard/StrongAuthPopup.smali
index d47b3cb5..57dd9466 100644
--- a/smali/com/android/keyguard/StrongAuthPopup.smali
+++ b/smali/com/android/keyguard/StrongAuthPopup.smali
@@ -297,34 +297,6 @@
     return-void
 .end method
 
-.method public final getNavigationBarSize()I
-    .locals 1
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_NAVBAR_ENABLED:Z
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object p0
-
-    const v0, 0x105024e
-
-    invoke-virtual {p0, v0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result p0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    :goto_0
-    return p0
-.end method
-
 .method public final onApplyWindowInsets(Landroid/view/View;Landroid/view/WindowInsets;)Landroid/view/WindowInsets;
     .locals 0
 
@@ -393,7 +365,7 @@
 
     if-eqz v1, :cond_0
 
-    goto/16 :goto_23
+    goto/16 :goto_1f
 
     :cond_0
     iput v0, p0, Lcom/android/keyguard/StrongAuthPopup;->mRotation:I
@@ -436,9 +408,9 @@
 
     const/4 v8, 0x3
 
-    const/4 v9, 0x0
+    const/4 v9, 0x1
 
-    const/4 v10, 0x1
+    const/4 v10, 0x0
 
     const/4 v11, 0x2
 
@@ -469,12 +441,12 @@
 
     if-ne v4, v6, :cond_2
 
-    move v4, v10
+    move v4, v9
 
     goto :goto_0
 
     :cond_2
-    move v4, v9
+    move v4, v10
 
     :goto_0
     invoke-static {v3, v4}, Lcom/android/keyguard/SecurityUtils;->getMainSecurityViewFlipperSize(Landroid/content/Context;Z)I
@@ -484,20 +456,20 @@
     goto :goto_3
 
     :cond_3
-    if-eq v0, v10, :cond_5
+    if-eq v0, v9, :cond_5
 
     if-ne v0, v8, :cond_4
 
     goto :goto_1
 
     :cond_4
-    move v3, v9
+    move v3, v10
 
     goto :goto_2
 
     :cond_5
     :goto_1
-    move v3, v10
+    move v3, v9
 
     :goto_2
     if-eqz v3, :cond_6
@@ -524,27 +496,29 @@
 
     iput v3, v2, Landroid/view/WindowManager$LayoutParams;->height:I
 
-    iput v10, v2, Landroid/view/WindowManager$LayoutParams;->layoutInDisplayCutoutMode:I
+    iput v9, v2, Landroid/view/WindowManager$LayoutParams;->layoutInDisplayCutoutMode:I
 
-    if-eq v0, v10, :cond_8
+    if-eq v0, v9, :cond_8
 
     if-ne v0, v8, :cond_7
 
     goto :goto_4
 
     :cond_7
-    move v3, v9
+    move v3, v10
 
     goto :goto_5
 
     :cond_8
     :goto_4
-    move v3, v10
+    move v3, v9
 
     :goto_5
-    sget-object v4, Lcom/android/keyguard/SecurityUtils;->sImeHeight:[I
+    const v4, 0x105024e
+
+    sget-object v6, Lcom/android/keyguard/SecurityUtils;->sImeHeight:[I
 
-    const/16 v6, 0x50
+    const/16 v12, 0x50
 
     if-eqz v3, :cond_11
 
@@ -564,12 +538,12 @@
 
     if-ne v3, v7, :cond_9
 
-    move v3, v10
+    move v3, v9
 
     goto :goto_6
 
     :cond_9
-    move v3, v9
+    move v3, v10
 
     :goto_6
     const/16 v7, 0x10
@@ -580,28 +554,28 @@
 
     if-eqz v3, :cond_c
 
-    if-eq v0, v10, :cond_b
+    if-eq v0, v9, :cond_b
 
     if-ne v0, v8, :cond_a
 
     goto :goto_7
 
     :cond_a
-    move v3, v9
+    move v3, v10
 
     goto :goto_8
 
     :cond_b
     :goto_7
-    move v3, v10
+    move v3, v9
 
     :goto_8
-    aget v3, v4, v3
+    aget v3, v6, v3
 
     goto :goto_9
 
     :cond_c
-    move v3, v9
+    move v3, v10
 
     :goto_9
     if-eqz v3, :cond_d
@@ -609,39 +583,39 @@
     goto :goto_a
 
     :cond_d
-    move v6, v7
+    move v12, v7
 
     :goto_a
-    iput v6, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
+    iput v12, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
 
     if-eqz v3, :cond_e
 
-    iget-object v4, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
+    iget-object v6, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v4}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v4
+    move-result-object v6
 
-    invoke-virtual {v4, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v6, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v4
+    move-result v5
 
-    add-int/2addr v4, v3
+    add-int/2addr v5, v3
 
     goto :goto_b
 
     :cond_e
-    move v4, v9
+    move v5, v10
 
     :goto_b
-    iput v4, v2, Landroid/view/WindowManager$LayoutParams;->y:I
+    iput v5, v2, Landroid/view/WindowManager$LayoutParams;->y:I
 
     goto :goto_c
 
     :cond_f
     iput v7, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
 
-    iput v9, v2, Landroid/view/WindowManager$LayoutParams;->y:I
+    iput v10, v2, Landroid/view/WindowManager$LayoutParams;->y:I
 
     :goto_c
     iget v3, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
@@ -650,21 +624,33 @@
 
     iput v3, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
 
-    if-ne v0, v10, :cond_10
+    if-ne v0, v9, :cond_10
+
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_NAVBAR_ENABLED:Z
+
+    if-eqz v0, :cond_10
 
-    invoke-virtual {p0}, Lcom/android/keyguard/StrongAuthPopup;->getNavigationBarSize()I
+    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
 
-    move-result v9
+    invoke-virtual {p0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+
+    move-result-object p0
+
+    invoke-virtual {p0, v4}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+
+    move-result p0
+
+    move v10, p0
 
     :cond_10
-    iput v9, v2, Landroid/view/WindowManager$LayoutParams;->x:I
+    iput v10, v2, Landroid/view/WindowManager$LayoutParams;->x:I
 
-    goto/16 :goto_22
+    goto/16 :goto_1e
 
     :cond_11
-    iput v6, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
+    iput v12, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
 
-    iput v9, v2, Landroid/view/WindowManager$LayoutParams;->x:I
+    iput v10, v2, Landroid/view/WindowManager$LayoutParams;->x:I
 
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
@@ -676,27 +662,7 @@
 
     move-result-object v3
 
-    sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v5, :cond_12
-
-    iget-object v5, p0, Lcom/android/keyguard/StrongAuthPopup;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-virtual {v5}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFingerprintDetectionRunning()Z
-
-    move-result v5
-
-    if-eqz v5, :cond_12
-
-    sget v5, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    goto :goto_d
-
-    :cond_12
-    move v5, v9
-
-    :goto_d
-    sget-object v6, Lcom/android/keyguard/StrongAuthPopup$3;->$SwitchMap$com$android$keyguard$KeyguardSecurityModel$SecurityMode:[I
+    sget-object v5, Lcom/android/keyguard/StrongAuthPopup$3;->$SwitchMap$com$android$keyguard$KeyguardSecurityModel$SecurityMode:[I
 
     iget-object v7, p0, Lcom/android/keyguard/StrongAuthPopup;->mSecurityMode:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
 
@@ -704,230 +670,220 @@
 
     move-result v7
 
-    aget v6, v6, v7
+    aget v5, v5, v7
 
     const v7, 0x7f07040c
 
     const v12, 0x7f07040b
 
-    if-eq v6, v10, :cond_24
+    if-eq v5, v9, :cond_22
 
-    if-eq v6, v11, :cond_19
+    if-eq v5, v11, :cond_17
 
-    if-eq v6, v8, :cond_13
+    if-eq v5, v8, :cond_12
 
-    goto/16 :goto_21
+    goto/16 :goto_1d
+
+    :cond_12
+    if-eqz v0, :cond_13
+
+    const p0, 0x7f07050b
+
+    goto :goto_d
 
     :cond_13
+    const p0, 0x7f07050a
+
+    :goto_d
+    invoke-virtual {v3, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+
+    move-result p0
+
     if-eqz v0, :cond_14
 
-    const v4, 0x7f07050b
+    const v4, 0x7f07050d
 
     goto :goto_e
 
     :cond_14
-    const v4, 0x7f07050a
+    const v4, 0x7f07050c
 
     :goto_e
     invoke-virtual {v3, v4}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v4
 
-    if-eqz v0, :cond_15
+    add-int/2addr v4, p0
 
-    const v6, 0x7f07050d
+    if-eqz v0, :cond_15
 
     goto :goto_f
 
     :cond_15
-    const v6, 0x7f07050c
+    move v7, v12
 
     :goto_f
-    invoke-virtual {v3, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v3, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v6
+    move-result p0
 
-    add-int/2addr v6, v4
+    if-eqz v0, :cond_16
 
-    if-eqz v5, :cond_16
+    const v0, 0x7f070509
 
-    invoke-virtual {p0}, Lcom/android/keyguard/StrongAuthPopup;->getNavigationBarSize()I
+    goto :goto_10
 
-    move-result p0
+    :cond_16
+    const v0, 0x7f070508
 
-    goto/16 :goto_1c
+    :goto_10
+    invoke-virtual {v3, v0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    :cond_16
-    if-eqz v0, :cond_17
+    move-result v0
 
-    goto :goto_10
+    goto/16 :goto_1c
 
     :cond_17
-    move v7, v12
+    iget-boolean v5, p0, Lcom/android/keyguard/StrongAuthPopup;->mIsSIPVisible:Z
 
-    :goto_10
-    invoke-virtual {v3, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    if-eqz v5, :cond_1a
 
-    move-result p0
+    iget v5, p0, Lcom/android/keyguard/StrongAuthPopup;->mRotation:I
 
-    if-eqz v0, :cond_18
+    if-eq v5, v9, :cond_19
 
-    const v0, 0x7f070509
+    if-ne v5, v8, :cond_18
 
     goto :goto_11
 
     :cond_18
-    const v0, 0x7f070508
-
-    :goto_11
-    invoke-virtual {v3, v0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v0
-
-    goto/16 :goto_1f
+    move v9, v10
 
     :cond_19
-    iget-boolean v6, p0, Lcom/android/keyguard/StrongAuthPopup;->mIsSIPVisible:Z
-
-    if-eqz v6, :cond_1c
-
-    iget v6, p0, Lcom/android/keyguard/StrongAuthPopup;->mRotation:I
-
-    if-eq v6, v10, :cond_1b
-
-    if-ne v6, v8, :cond_1a
+    :goto_11
+    aget v5, v6, v9
 
     goto :goto_12
 
     :cond_1a
-    move v10, v9
+    move v5, v10
 
-    :cond_1b
     :goto_12
-    aget v4, v4, v10
-
-    goto :goto_13
-
-    :cond_1c
-    move v4, v9
-
-    :goto_13
-    if-eqz v0, :cond_1d
+    if-eqz v0, :cond_1b
 
     const v6, 0x7f070539
 
-    goto :goto_14
+    goto :goto_13
 
-    :cond_1d
+    :cond_1b
     const v6, 0x7f070538
 
-    :goto_14
+    :goto_13
     invoke-virtual {v3, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v6
 
-    if-eqz v0, :cond_1e
+    if-eqz v0, :cond_1c
 
     const v8, 0x7f070536
 
-    goto :goto_15
+    goto :goto_14
 
-    :cond_1e
+    :cond_1c
     const v8, 0x7f070535
 
-    :goto_15
+    :goto_14
     invoke-virtual {v3, v8}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v8
 
     add-int/2addr v8, v6
 
-    if-eqz v0, :cond_1f
+    if-eqz v0, :cond_1d
 
     const v6, 0x7f070540
 
-    goto :goto_16
+    goto :goto_15
 
-    :cond_1f
+    :cond_1d
     const v6, 0x7f070500
 
-    :goto_16
+    :goto_15
     invoke-virtual {v3, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v6
 
     add-int/2addr v6, v8
 
-    if-eqz v5, :cond_20
-
-    invoke-virtual {p0}, Lcom/android/keyguard/StrongAuthPopup;->getNavigationBarSize()I
-
-    move-result v0
-
-    sub-int/2addr v5, v0
-
-    goto :goto_19
-
-    :cond_20
-    if-eqz v0, :cond_21
+    if-eqz v0, :cond_1e
 
-    goto :goto_17
+    goto :goto_16
 
-    :cond_21
+    :cond_1e
     move v7, v12
 
-    :goto_17
+    :goto_16
     invoke-virtual {v3, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v5
+    move-result v7
 
-    if-eqz v0, :cond_22
+    if-eqz v0, :cond_1f
 
     const v0, 0x7f070502
 
-    goto :goto_18
+    goto :goto_17
 
-    :cond_22
+    :cond_1f
     const v0, 0x7f070501
 
-    :goto_18
+    :goto_17
     invoke-virtual {v3, v0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v0
 
-    add-int/2addr v5, v0
+    add-int/2addr v0, v7
 
-    :goto_19
-    add-int/2addr v6, v5
+    add-int/2addr v0, v6
 
-    if-eqz v4, :cond_23
+    if-eqz v5, :cond_21
 
-    invoke-virtual {p0}, Lcom/android/keyguard/StrongAuthPopup;->getNavigationBarSize()I
+    sget-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_NAVBAR_ENABLED:Z
 
-    move-result p0
+    if-eqz v3, :cond_20
 
-    sub-int v9, v4, p0
+    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
 
-    :cond_23
-    add-int/2addr v9, v6
+    invoke-virtual {p0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    goto :goto_21
+    move-result-object p0
 
-    :cond_24
-    if-eqz v0, :cond_25
+    invoke-virtual {p0, v4}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+
+    move-result v10
 
-    iget-object v4, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
+    :cond_20
+    sub-int v10, v5, v10
 
-    invoke-static {v4}, Lcom/android/keyguard/SecurityUtils;->getTabletPINContainerHeight(Landroid/content/Context;)I
+    :cond_21
+    add-int/2addr v10, v0
 
-    move-result v4
+    goto :goto_1d
 
-    goto :goto_1a
+    :cond_22
+    if-eqz v0, :cond_23
 
-    :cond_25
+    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
+
+    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getTabletPINContainerHeight(Landroid/content/Context;)I
+
+    move-result p0
+
+    goto :goto_18
+
+    :cond_23
     sget-boolean v4, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v4, :cond_26
+    if-eqz v4, :cond_24
 
     const-class v4, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
@@ -939,90 +895,77 @@
 
     iget-boolean v4, v4, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
 
-    if-eqz v4, :cond_26
-
-    iget-object v4, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
+    if-eqz v4, :cond_24
 
-    invoke-static {v4}, Lcom/android/keyguard/SecurityUtils;->getFoldPINContainerHeight(Landroid/content/Context;)I
-
-    move-result v4
-
-    goto :goto_1a
-
-    :cond_26
-    iget-object v4, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
+    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
 
-    invoke-static {v4}, Lcom/android/keyguard/SecurityUtils;->getPINContainerHeight(Landroid/content/Context;)I
+    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getFoldPINContainerHeight(Landroid/content/Context;)I
 
-    move-result v4
-
-    :goto_1a
-    if-eqz v0, :cond_27
+    move-result p0
 
-    const v6, 0x7f070513
+    goto :goto_18
 
-    goto :goto_1b
+    :cond_24
+    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
 
-    :cond_27
-    const v6, 0x7f070512
+    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getPINContainerHeight(Landroid/content/Context;)I
 
-    :goto_1b
-    invoke-virtual {v3, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    move-result p0
 
-    move-result v6
+    :goto_18
+    if-eqz v0, :cond_25
 
-    add-int/2addr v6, v4
+    const v4, 0x7f070513
 
-    if-eqz v5, :cond_28
+    goto :goto_19
 
-    invoke-virtual {p0}, Lcom/android/keyguard/StrongAuthPopup;->getNavigationBarSize()I
+    :cond_25
+    const v4, 0x7f070512
 
-    move-result p0
+    :goto_19
+    invoke-virtual {v3, v4}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    :goto_1c
-    sub-int/2addr v5, p0
+    move-result v4
 
-    goto :goto_20
+    add-int/2addr v4, p0
 
-    :cond_28
-    if-eqz v0, :cond_29
+    if-eqz v0, :cond_26
 
-    goto :goto_1d
+    goto :goto_1a
 
-    :cond_29
+    :cond_26
     move v7, v12
 
-    :goto_1d
+    :goto_1a
     invoke-virtual {v3, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result p0
 
-    if-eqz v0, :cond_2a
+    if-eqz v0, :cond_27
 
     const v0, 0x7f070515
 
-    goto :goto_1e
+    goto :goto_1b
 
-    :cond_2a
+    :cond_27
     const v0, 0x7f070514
 
-    :goto_1e
+    :goto_1b
     invoke-virtual {v3, v0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v0
 
-    :goto_1f
-    add-int v5, v0, p0
+    :goto_1c
+    add-int/2addr v0, p0
 
-    :goto_20
-    add-int v9, v6, v5
+    add-int v10, v0, v4
 
-    :goto_21
-    iput v9, v2, Landroid/view/WindowManager$LayoutParams;->y:I
+    :goto_1d
+    iput v10, v2, Landroid/view/WindowManager$LayoutParams;->y:I
 
-    :goto_22
+    :goto_1e
     invoke-virtual {v1, v2}, Landroid/view/Window;->setAttributes(Landroid/view/WindowManager$LayoutParams;)V
 
-    :goto_23
+    :goto_1f
     return-void
 .end method
diff --git a/smali/com/android/keyguard/biometrics/KeyguardBiometricViewController.smali b/smali/com/android/keyguard/biometrics/KeyguardBiometricViewController.smali
index d8b02bc7..6acff919 100644
--- a/smali/com/android/keyguard/biometrics/KeyguardBiometricViewController.smali
+++ b/smali/com/android/keyguard/biometrics/KeyguardBiometricViewController.smali
@@ -533,7 +533,7 @@
 .end method
 
 .method public final needsToChangeRetryButton()Z
-    .locals 3
+    .locals 2
 
     iget-object v0, p0, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->biometricRetryIcon:Lcom/android/systemui/widget/SystemUIImageView;
 
@@ -549,8 +549,6 @@
 
     move-result v0
 
-    const/4 v2, 0x1
-
     if-eqz v0, :cond_1
 
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
@@ -572,40 +570,15 @@
     if-eqz p0, :cond_2
 
     :cond_0
-    :goto_0
-    move v1, v2
+    const/4 v1, 0x1
 
-    goto :goto_1
+    goto :goto_0
 
     :cond_1
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_2
-
-    iget-object v0, p0, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
-
-    move-result-object p0
-
-    const v0, 0x7f050067
-
-    invoke-virtual {p0, v0}, Landroid/content/res/Resources;->getBoolean(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_2
-
-    goto :goto_0
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_2
-    :goto_1
+    :goto_0
     return v1
 .end method
 
@@ -978,534 +951,453 @@
 .end method
 
 .method public final updateBiometricViewLayout()V
-    .locals 16
-
-    move-object/from16 v0, p0
+    .locals 15
 
-    iget-object v1, v0, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
+    iget-object v0, p0, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->getCurrentSecurityMode()Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
+    invoke-interface {v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->getCurrentSecurityMode()Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
 
-    move-result-object v2
+    move-result-object v1
 
-    sget-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_SWIPE_BOUNCER:Z
+    sget-boolean v2, Lcom/android/systemui/LsRune;->SECURITY_SWIPE_BOUNCER:Z
 
-    if-eqz v3, :cond_0
+    if-eqz v2, :cond_0
 
-    sget-object v3, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->Swipe:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
+    sget-object v2, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->Swipe:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
 
-    if-ne v2, v3, :cond_0
+    if-ne v1, v2, :cond_0
 
-    iget-object v0, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object p0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast p0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    const/16 v1, 0x8
+    const/16 v0, 0x8
 
-    invoke-virtual {v0, v1}, Landroid/widget/FrameLayout;->setVisibility(I)V
+    invoke-virtual {p0, v0}, Landroid/widget/FrameLayout;->setVisibility(I)V
 
     return-void
 
     :cond_0
-    sget-object v3, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->Password:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
+    sget-object v2, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->Password:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
 
-    const/4 v4, 0x0
+    const/4 v3, 0x0
 
-    const/4 v5, 0x1
+    const/4 v4, 0x1
 
-    if-ne v2, v3, :cond_1
+    if-ne v1, v2, :cond_1
 
-    move v2, v5
+    move v1, v4
 
     goto :goto_0
 
     :cond_1
-    move v2, v4
+    move v1, v3
 
     :goto_0
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v3
+    move-result-object v2
 
-    const v6, 0x7f0704fc
+    const v5, 0x7f0704fc
 
-    invoke-virtual {v3, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v2, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v3
+    move-result v2
 
-    new-instance v12, Landroidx/constraintlayout/widget/ConstraintSet;
+    new-instance v11, Landroidx/constraintlayout/widget/ConstraintSet;
 
-    invoke-direct {v12}, Landroidx/constraintlayout/widget/ConstraintSet;-><init>()V
+    invoke-direct {v11}, Landroidx/constraintlayout/widget/ConstraintSet;-><init>()V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v5, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v5, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v5}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v6
+    move-result v5
 
-    sget-boolean v13, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
+    sget-boolean v12, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v13, :cond_3
+    if-eqz v12, :cond_3
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    move-result-object v7
+    move-result-object v6
 
-    invoke-virtual {v7}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v7
+    move-result-object v6
 
-    invoke-virtual {v7}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    invoke-virtual {v6}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
-    move-result-object v7
+    move-result-object v6
 
-    iget v7, v7, Landroid/content/res/Configuration;->semDisplayDeviceType:I
+    iget v6, v6, Landroid/content/res/Configuration;->semDisplayDeviceType:I
 
-    if-nez v7, :cond_2
+    if-nez v6, :cond_2
 
-    move v7, v5
+    move v6, v4
 
     goto :goto_1
 
     :cond_2
-    move v7, v4
+    move v6, v3
 
     :goto_1
-    if-eqz v7, :cond_3
+    if-eqz v6, :cond_3
 
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isSmartViewFitToActiveDisplay()Z
 
-    move-result v7
+    move-result v6
 
-    if-nez v7, :cond_3
+    if-nez v6, :cond_3
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    move-result-object v7
+    move-result-object v6
 
-    invoke-static {v7, v2}, Lcom/android/keyguard/SecurityUtils;->getMainSecurityViewFlipperSize(Landroid/content/Context;Z)I
+    invoke-static {v6, v1}, Lcom/android/keyguard/SecurityUtils;->getMainSecurityViewFlipperSize(Landroid/content/Context;Z)I
 
-    move-result v7
+    move-result v1
 
     goto :goto_2
 
     :cond_3
-    move v7, v4
+    move v1, v3
 
     :goto_2
-    invoke-virtual {v12, v6, v7}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainWidth(II)V
+    invoke-virtual {v11, v5, v1}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainWidth(II)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v6
+    move-result v1
 
-    const/4 v14, -0x2
+    const/4 v13, -0x2
 
-    invoke-virtual {v12, v6, v14}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainHeight(II)V
+    invoke-virtual {v11, v1, v13}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainHeight(II)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v7
+    move-result v6
 
-    const/4 v8, 0x6
+    const/4 v7, 0x6
 
-    const/4 v9, 0x0
+    const/4 v8, 0x0
 
-    const/4 v10, 0x6
+    const/4 v9, 0x6
 
-    const/4 v11, 0x0
+    const/4 v10, 0x0
 
-    move-object v6, v12
+    move-object v5, v11
 
-    invoke-virtual/range {v6 .. v11}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
+    invoke-virtual/range {v5 .. v10}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v6
+    move-result v1
 
-    const/4 v15, 0x7
+    const/4 v14, 0x7
 
-    invoke-virtual {v12, v6, v15, v4, v15}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
+    invoke-virtual {v11, v1, v14, v3, v14}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v6
+    move-result v1
 
-    const/4 v7, 0x3
+    const/4 v5, 0x3
 
-    invoke-virtual {v12, v6, v7, v4, v7}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
+    invoke-virtual {v11, v1, v5, v3, v5}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6, v4, v4, v4, v4}, Landroid/widget/FrameLayout;->setPadding(IIII)V
+    invoke-virtual {v1, v3, v3, v3, v3}, Landroid/widget/FrameLayout;->setPadding(IIII)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    iget-object v6, v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;->defaultDisplay:Landroid/view/Display;
+    iget-object v1, v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;->defaultDisplay:Landroid/view/Display;
 
-    invoke-virtual {v6}, Landroid/view/Display;->getRotation()I
+    invoke-virtual {v1}, Landroid/view/Display;->getRotation()I
 
-    move-result v6
+    move-result v1
 
-    invoke-static {v6}, Lcom/android/systemui/util/DeviceState;->getRotation(I)I
+    invoke-static {v1}, Lcom/android/systemui/util/DeviceState;->getRotation(I)I
 
-    move-result v6
+    move-result v1
 
-    invoke-static {v6}, Lcom/android/systemui/util/DeviceState;->getRotation(I)I
+    invoke-static {v1}, Lcom/android/systemui/util/DeviceState;->getRotation(I)I
 
-    move-result v11
+    move-result v1
 
-    if-eq v11, v5, :cond_4
+    if-eq v1, v4, :cond_4
 
-    if-eq v11, v7, :cond_4
+    if-eq v1, v5, :cond_4
 
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v7
+    move-result v6
 
-    const/4 v8, 0x6
+    const/4 v7, 0x6
 
-    const/4 v9, 0x0
+    const/4 v8, 0x0
 
-    const/4 v10, 0x6
+    const/4 v9, 0x6
 
-    const/4 v11, 0x0
+    const/4 v10, 0x0
 
-    move-object v6, v12
+    move-object v5, v11
 
-    invoke-virtual/range {v6 .. v11}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
+    invoke-virtual/range {v5 .. v10}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v1
+    move-result v0
 
-    invoke-virtual {v12, v1, v15, v4, v15}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
+    invoke-virtual {v11, v0, v14, v3, v14}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v1, v4, v4, v4, v4}, Landroid/widget/FrameLayout;->setPadding(IIII)V
+    invoke-virtual {v0, v3, v3, v3, v3}, Landroid/widget/FrameLayout;->setPadding(IIII)V
 
-    goto/16 :goto_7
+    goto/16 :goto_5
 
     :cond_4
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isHiddenInputContainer()Z
+    invoke-interface {v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isHiddenInputContainer()Z
 
-    move-result v6
+    move-result v1
 
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
-    move-result v8
-
-    if-nez v8, :cond_f
+    move-result v5
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    if-nez v5, :cond_8
 
-    move-result-object v8
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    invoke-static {v8}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
+    move-result-object v5
 
-    move-result v8
+    invoke-static {v5}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
 
-    if-eqz v8, :cond_f
+    move-result v5
 
-    if-nez v6, :cond_f
+    if-eqz v5, :cond_8
 
-    if-eqz v13, :cond_6
+    if-nez v1, :cond_8
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    if-eqz v12, :cond_6
 
-    move-result-object v6
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    move-result-object v1
 
-    move-result-object v6
+    invoke-virtual {v1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    invoke-virtual {v6}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    move-result-object v1
 
-    move-result-object v6
+    invoke-virtual {v1}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
-    iget v6, v6, Landroid/content/res/Configuration;->semDisplayDeviceType:I
+    move-result-object v1
 
-    if-nez v6, :cond_5
+    iget v1, v1, Landroid/content/res/Configuration;->semDisplayDeviceType:I
 
-    move v6, v5
+    if-nez v1, :cond_5
 
     goto :goto_3
 
     :cond_5
-    move v6, v4
+    move v4, v3
 
     :goto_3
-    if-eqz v6, :cond_6
+    if-eqz v4, :cond_6
 
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isSmartViewFitToActiveDisplay()Z
 
-    move-result v6
+    move-result v1
 
-    if-nez v6, :cond_6
+    if-nez v1, :cond_6
 
-    goto/16 :goto_8
+    goto/16 :goto_6
 
     :cond_6
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v6
+    move-result-object v1
 
-    invoke-virtual {v6}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    invoke-virtual {v1}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
-    move-result-object v6
+    move-result-object v1
 
-    iget-object v6, v6, Landroid/content/res/Configuration;->windowConfiguration:Landroid/app/WindowConfiguration;
+    iget-object v1, v1, Landroid/content/res/Configuration;->windowConfiguration:Landroid/app/WindowConfiguration;
 
-    invoke-virtual {v6}, Landroid/app/WindowConfiguration;->getBounds()Landroid/graphics/Rect;
+    invoke-virtual {v1}, Landroid/app/WindowConfiguration;->getBounds()Landroid/graphics/Rect;
 
-    move-result-object v6
+    move-result-object v1
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    move-result-object v8
+    move-result-object v4
 
-    invoke-static {v8}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
+    invoke-static {v4}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
 
-    move-result v8
+    move-result v4
 
-    if-eqz v8, :cond_7
+    if-eqz v4, :cond_7
 
-    invoke-virtual {v6}, Landroid/graphics/Rect;->width()I
+    invoke-virtual {v1}, Landroid/graphics/Rect;->width()I
 
-    move-result v6
+    move-result v1
 
     goto :goto_4
 
     :cond_7
-    invoke-virtual {v6}, Landroid/graphics/Rect;->width()I
-
-    move-result v8
+    invoke-virtual {v1}, Landroid/graphics/Rect;->width()I
 
-    invoke-virtual {v6}, Landroid/graphics/Rect;->height()I
+    move-result v4
 
-    move-result v6
-
-    invoke-static {v8, v6}, Ljava/lang/Math;->min(II)I
-
-    move-result v6
-
-    :goto_4
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v8
-
-    const v9, 0x7f07095a
-
-    invoke-virtual {v8, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v8
-
-    sget v9, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    invoke-virtual {v1}, Landroid/graphics/Rect;->height()I
 
     move-result v1
 
-    if-eqz v1, :cond_c
+    invoke-static {v4, v1}, Ljava/lang/Math;->min(II)I
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
+    move-result v1
 
-    move-result-object v10
+    :goto_4
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
-    invoke-virtual {v10}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    move-result-object v4
 
-    move-result-object v10
+    const v5, 0x7f07095a
 
-    invoke-virtual {v10}, Landroid/content/res/Configuration;->getLayoutDirection()I
+    invoke-virtual {v4, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v10
 
-    if-ne v10, v5, :cond_8
-
-    move v10, v5
-
-    goto :goto_5
-
-    :cond_8
-    move v10, v4
-
-    :goto_5
-    if-nez v10, :cond_9
+    invoke-interface {v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    if-eq v11, v7, :cond_a
-
-    :cond_9
-    if-eqz v10, :cond_b
-
-    if-ne v11, v5, :cond_b
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    :cond_a
-    sub-int/2addr v9, v8
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    goto :goto_6
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
-    :cond_b
-    move v9, v4
+    move-result v0
 
-    :goto_6
-    add-int/2addr v8, v9
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    :cond_c
-    move v13, v8
+    move-result-object v4
 
-    iget-object v7, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    invoke-static {v1, v4}, Lcom/android/keyguard/SecurityUtils;->calculateLandscapeViewWidth(ILandroid/content/Context;)I
 
-    check-cast v7, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    move-result v1
 
-    invoke-virtual {v7}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v11, v0, v1}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainWidth(II)V
 
-    move-result v7
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    move-result-object v8
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
-    invoke-static {v6, v8}, Lcom/android/keyguard/SecurityUtils;->calculateLandscapeViewWidth(ILandroid/content/Context;)I
+    move-result v0
 
-    move-result v6
+    invoke-virtual {v11, v0, v13}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainHeight(II)V
 
-    invoke-virtual {v12, v7, v6}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainWidth(II)V
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    move-result v0
 
-    move-result v6
+    const/4 v1, -0x1
 
-    invoke-virtual {v12, v6, v14}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainHeight(II)V
+    invoke-virtual {v11, v0, v14, v1, v14}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
     move-result v6
 
-    const/4 v7, -0x1
-
-    invoke-virtual {v12, v6, v15, v7, v15}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
-
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
-
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
-
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
-
-    move-result v7
-
-    const/4 v8, 0x6
-
-    const/4 v9, 0x0
-
-    const/4 v10, 0x6
-
-    move-object v6, v12
-
-    move v14, v11
-
-    move v11, v13
-
-    invoke-virtual/range {v6 .. v11}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
-
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
-
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    const/4 v7, 0x6
 
-    invoke-virtual {v6, v4, v4, v3, v4}, Landroid/widget/FrameLayout;->setPadding(IIII)V
+    const/4 v8, 0x0
 
-    if-eqz v1, :cond_e
+    const/4 v9, 0x6
 
-    if-eqz v2, :cond_e
+    move-object v5, v11
 
-    if-ne v14, v5, :cond_d
+    invoke-virtual/range {v5 .. v10}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
-
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
-
-    invoke-virtual {v1, v4, v4, v3, v4}, Landroid/widget/FrameLayout;->setPadding(IIII)V
-
-    goto :goto_7
-
-    :cond_d
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v1, v3, v4, v4, v4}, Landroid/widget/FrameLayout;->setPadding(IIII)V
+    invoke-virtual {v0, v3, v3, v2, v3}, Landroid/widget/FrameLayout;->setPadding(IIII)V
 
-    :cond_e
-    :goto_7
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    :goto_5
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getParent()Landroid/view/ViewParent;
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getParent()Landroid/view/ViewParent;
 
-    move-result-object v1
+    move-result-object v0
 
-    check-cast v1, Landroidx/constraintlayout/widget/ConstraintLayout;
+    check-cast v0, Landroidx/constraintlayout/widget/ConstraintLayout;
 
-    invoke-virtual {v12, v1}, Landroidx/constraintlayout/widget/ConstraintSet;->applyTo(Landroidx/constraintlayout/widget/ConstraintLayout;)V
+    invoke-virtual {v11, v0}, Landroidx/constraintlayout/widget/ConstraintSet;->applyTo(Landroidx/constraintlayout/widget/ConstraintLayout;)V
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->updateLockContainerMargin()V
+    invoke-virtual {p0}, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->updateLockContainerMargin()V
 
     return-void
 
-    :cond_f
-    :goto_8
-    iget-object v0, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    :cond_8
+    :goto_6
+    iget-object p0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast p0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getParent()Landroid/view/ViewParent;
+    invoke-virtual {p0}, Landroid/widget/FrameLayout;->getParent()Landroid/view/ViewParent;
 
-    move-result-object v0
+    move-result-object p0
 
-    check-cast v0, Landroidx/constraintlayout/widget/ConstraintLayout;
+    check-cast p0, Landroidx/constraintlayout/widget/ConstraintLayout;
 
-    invoke-virtual {v12, v0}, Landroidx/constraintlayout/widget/ConstraintSet;->applyTo(Landroidx/constraintlayout/widget/ConstraintLayout;)V
+    invoke-virtual {v11, p0}, Landroidx/constraintlayout/widget/ConstraintSet;->applyTo(Landroidx/constraintlayout/widget/ConstraintLayout;)V
 
     return-void
 .end method
@@ -1608,7 +1500,7 @@
 
     sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_BIOMETRICS_TABLET:Z
 
-    if-eqz v5, :cond_5
+    if-eqz v5, :cond_4
 
     iget-object v5, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
@@ -1628,11 +1520,11 @@
 
     move-result v5
 
-    if-eqz v5, :cond_4
+    if-eqz v5, :cond_3
 
     const/4 v1, 0x1
 
-    if-eq v5, v1, :cond_2
+    if-eq v5, v1, :cond_1
 
     const/4 v1, 0x2
 
@@ -1640,55 +1532,48 @@
 
     const/4 p0, 0x3
 
-    if-eq v5, p0, :cond_2
+    if-eq v5, p0, :cond_1
 
     goto :goto_0
 
     :cond_0
     iget-object p0, p0, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result p0
+    invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    if-eqz p0, :cond_1
-
-    sget v0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    :cond_1
     iput v0, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
     goto :goto_0
 
-    :cond_2
-    if-eqz v2, :cond_3
+    :cond_1
+    if-eqz v2, :cond_2
 
     move v0, v2
 
-    :cond_3
+    :cond_2
     iput v0, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
     goto :goto_0
 
-    :cond_4
+    :cond_3
     add-int/2addr v0, v1
 
     iput v0, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
     goto :goto_0
 
-    :cond_5
+    :cond_4
     iput v0, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
     invoke-virtual {p0}, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->isLandscape()Z
 
     move-result p0
 
-    if-eqz p0, :cond_6
+    if-eqz p0, :cond_5
 
     const/4 v1, 0x0
 
-    :cond_6
+    :cond_5
     add-int/2addr v0, v1
 
     iput v0, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
diff --git a/smali/com/android/keyguard/biometrics/KeyguardFingerprintGuidePopup$keyguardUpdateMonitorCallback$1.smali b/smali/com/android/keyguard/biometrics/KeyguardFingerprintGuidePopup$keyguardUpdateMonitorCallback$1.smali
index 7961bcd6..7b7324d5 100644
--- a/smali/com/android/keyguard/biometrics/KeyguardFingerprintGuidePopup$keyguardUpdateMonitorCallback$1.smali
+++ b/smali/com/android/keyguard/biometrics/KeyguardFingerprintGuidePopup$keyguardUpdateMonitorCallback$1.smali
@@ -56,18 +56,18 @@
 
     move-result p3
 
-    const/4 v0, 0x0
+    const/4 v0, 0x2
 
-    const/4 v1, 0x2
+    const/4 v1, 0x0
 
-    if-ne p3, v1, :cond_0
+    if-ne p3, v0, :cond_0
 
     const/4 p3, 0x1
 
     goto :goto_0
 
     :cond_0
-    move p3, v0
+    move p3, v1
 
     :goto_0
     if-eqz p3, :cond_5
@@ -106,7 +106,7 @@
 
     invoke-virtual {p1, p2}, Landroid/widget/TextView;->setText(Ljava/lang/CharSequence;)V
 
-    invoke-virtual {p1, v0}, Lcom/android/systemui/widget/SystemUITextView;->setVisibility(I)V
+    invoke-virtual {p1, v1}, Lcom/android/systemui/widget/SystemUITextView;->setVisibility(I)V
 
     :cond_1
     invoke-virtual {p0}, Landroid/widget/FrameLayout;->getContext()Landroid/content/Context;
@@ -117,51 +117,45 @@
 
     move-result p1
 
-    sget p2, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintImageSize:I
-
-    add-int/2addr p1, p2
+    add-int/2addr p1, v1
 
-    div-int/2addr p1, v1
+    div-int/2addr p1, v0
 
     invoke-virtual {p0}, Landroid/widget/FrameLayout;->getResources()Landroid/content/res/Resources;
 
-    move-result-object p3
-
-    const v2, 0x7f070492
+    move-result-object p2
 
-    invoke-virtual {p3, v2}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    const p3, 0x7f070492
 
-    move-result p3
+    invoke-virtual {p2, p3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    add-int/2addr p3, p1
-
-    sget p1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    move-result p2
 
-    sub-int/2addr p1, p2
+    add-int/2addr p2, p1
 
     invoke-virtual {p0}, Landroid/widget/FrameLayout;->getResources()Landroid/content/res/Resources;
 
-    move-result-object p2
+    move-result-object p1
 
-    const v2, 0x7f070493
+    const p3, 0x7f070493
 
-    invoke-virtual {p2, v2}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {p1, p3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result p2
+    move-result p1
 
-    add-int/2addr p2, p1
+    add-int/2addr p1, v1
 
-    iget-object p1, p0, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;->keyguardGuidePopup:Landroid/view/ViewGroup;
+    iget-object p3, p0, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;->keyguardGuidePopup:Landroid/view/ViewGroup;
 
-    if-eqz p1, :cond_2
+    if-eqz p3, :cond_2
 
-    int-to-float p3, p3
+    int-to-float p2, p2
 
-    invoke-virtual {p1, p3}, Landroid/view/ViewGroup;->setTranslationX(F)V
+    invoke-virtual {p3, p2}, Landroid/view/ViewGroup;->setTranslationX(F)V
 
-    int-to-float p2, p2
+    int-to-float p1, p1
 
-    invoke-virtual {p1, p2}, Landroid/view/ViewGroup;->setTranslationY(F)V
+    invoke-virtual {p3, p1}, Landroid/view/ViewGroup;->setTranslationY(F)V
 
     :cond_2
     iget-object p1, p0, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;->handler:Landroid/os/Handler;
@@ -200,7 +194,7 @@
     :cond_4
     iget-object p1, p0, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;->keyguardGuidePopup:Landroid/view/ViewGroup;
 
-    new-array p2, v1, [F
+    new-array p2, v0, [F
 
     fill-array-data p2, :array_0
 
@@ -237,7 +231,7 @@
     invoke-virtual {p2}, Landroid/animation/AnimatorSet;->start()V
 
     :goto_1
-    invoke-virtual {p0, v0}, Landroid/widget/FrameLayout;->setVisibility(I)V
+    invoke-virtual {p0, v1}, Landroid/widget/FrameLayout;->setVisibility(I)V
 
     iget-object p1, p0, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;->handler:Landroid/os/Handler;
 
@@ -256,6 +250,8 @@
     :cond_5
     return-void
 
+    nop
+
     :array_0
     .array-data 4
         0x0
diff --git a/smali/com/android/systemui/LsRune.smali b/smali/com/android/systemui/LsRune.smali
index c9a60c91..258c1e18 100644
--- a/smali/com/android/systemui/LsRune.smali
+++ b/smali/com/android/systemui/LsRune.smali
@@ -124,9 +124,7 @@
 
 .field public static final SECURITY_FACTORY_RESET_WITHOUT_UI:Z
 
-.field public static final SECURITY_FINGERPRINT_GUIDE_POPUP:Z
-
-.field public static final SECURITY_FINGERPRINT_IN_DISPLAY:Z
+.field public static final SECURITY_FINGERPRINT_SIDE:Z
 
 .field public static final SECURITY_HAPTIC_FEEDBACK_ON_DC_MOTOR:Z
 
@@ -804,9 +802,7 @@
 
     const/4 v3, 0x1
 
-    sput-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    const/4 v3, 0x0
+    sput-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
     sput-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_BACKGROUND_AUTHENTICATION:Z
 
@@ -1033,8 +1029,6 @@
 
     sget v3, Lcom/android/systemui/util/DeviceType;->supportTablet:I
 
-    sput-boolean v4, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_GUIDE_POPUP:Z
-
     if-eqz v8, :cond_16
 
     invoke-static {}, Lcom/samsung/android/feature/SemFloatingFeature;->getInstance()Lcom/samsung/android/feature/SemFloatingFeature;
diff --git a/smali/com/android/systemui/dagger/DaggerReferenceGlobalRootComponent$CentralSurfacesComponentImpl.smali b/smali/com/android/systemui/dagger/DaggerReferenceGlobalRootComponent$CentralSurfacesComponentImpl.smali
index 11ad8995..076c7131 100644
--- a/smali/com/android/systemui/dagger/DaggerReferenceGlobalRootComponent$CentralSurfacesComponentImpl.smali
+++ b/smali/com/android/systemui/dagger/DaggerReferenceGlobalRootComponent$CentralSurfacesComponentImpl.smali
@@ -2044,7 +2044,9 @@
 
     invoke-static {p0}, Ldagger/internal/DoubleCheck;->lazy(Ljavax/inject/Provider;)Ldagger/Lazy;
 
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result-object p0
+
+    iput-object p0, p1, Lcom/android/systemui/shade/NotificationPanelViewController;->mBioUnlockControllerLazy:Ldagger/Lazy;
 
     return-object p1
 .end method
diff --git a/smali/com/android/systemui/facewidget/plugin/PluginFaceWidgetManager.smali b/smali/com/android/systemui/facewidget/plugin/PluginFaceWidgetManager.smali
index 46ad7535..3a2b2f9d 100644
--- a/smali/com/android/systemui/facewidget/plugin/PluginFaceWidgetManager.smali
+++ b/smali/com/android/systemui/facewidget/plugin/PluginFaceWidgetManager.smali
@@ -381,7 +381,9 @@
 .method public final getInDisplayFingerprintHeight()I
     .locals 0
 
-    sget p0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    sget-object p0, Lcom/android/systemui/util/DeviceState;->sDisplaySize:Landroid/graphics/Point;
+
+    const/4 p0, 0x0
 
     return p0
 .end method
@@ -389,7 +391,9 @@
 .method public final getInDisplayFingerprintImageSize()I
     .locals 0
 
-    sget p0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintImageSize:I
+    sget-object p0, Lcom/android/systemui/util/DeviceState;->sDisplaySize:Landroid/graphics/Point;
+
+    const/4 p0, 0x0
 
     return p0
 .end method
@@ -592,7 +596,7 @@
 
     const/4 v0, -0x1
 
-    const/4 v1, 0x1
+    const/4 v1, 0x0
 
     if-ne p0, v0, :cond_0
 
@@ -601,14 +605,13 @@
     :cond_0
     sget p0, Lcom/android/systemui/util/DeviceType;->supportInDisplayFingerprint:I
 
-    if-ne p0, v1, :cond_1
+    const/4 v0, 0x1
 
-    goto :goto_0
+    if-ne p0, v0, :cond_1
 
-    :cond_1
-    const/4 v1, 0x0
+    move v1, v0
 
-    :goto_0
+    :cond_1
     return v1
 .end method
 
diff --git a/smali/com/android/systemui/globalactions/presentation/features/GlobalActionFeatures.smali b/smali/com/android/systemui/globalactions/presentation/features/GlobalActionFeatures.smali
index e1bbfcd6..a3a9d19d 100644
--- a/smali/com/android/systemui/globalactions/presentation/features/GlobalActionFeatures.smali
+++ b/smali/com/android/systemui/globalactions/presentation/features/GlobalActionFeatures.smali
@@ -44,7 +44,7 @@
 
     sget-boolean v0, Lcom/android/systemui/BasicRune;->GLOBALACTIONS_BLUR:Z
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_0
     const-string v0, "CAPTURED_BLUR"
@@ -57,7 +57,7 @@
 
     sget-boolean v0, Lcom/android/systemui/BasicRune;->GLOBALACTIONS_CAPTURED_BLUR:Z
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_1
     const-string v0, "NAV_BAR"
@@ -80,7 +80,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_2
     const-string v0, "SAFETY_CARE"
@@ -101,7 +101,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_3
     const-string v0, "SCOVER"
@@ -116,7 +116,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_4
     const-string v0, "DATA_MODE"
@@ -137,7 +137,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_5
     const-string v0, "DEMO_MODE"
@@ -258,7 +258,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_b
     const-string v0, "FINGERPRINT_IN_DISPLAY"
@@ -269,7 +269,7 @@
 
     if-eqz v0, :cond_c
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     goto/16 :goto_4
 
@@ -292,7 +292,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_d
     const-string v0, "POWER_OFF_LOCK"
@@ -313,7 +313,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_e
     const-string v0, "FRONT_LARGE_COVER_DISPLAY"
@@ -332,7 +332,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_f
     const-string v0, "FRONT_COVER_DISPLAY"
@@ -448,12 +448,13 @@
     :goto_3
     move v0, v1
 
-    goto :goto_4
+    goto :goto_5
 
     :cond_16
+    :goto_4
     move v0, v2
 
-    :goto_4
+    :goto_5
     iget-object p0, p0, Lcom/android/systemui/globalactions/presentation/features/GlobalActionFeatures;->mLogWrapper:Lcom/samsung/android/globalactions/util/LogWrapper;
 
     new-instance v1, Ljava/lang/StringBuilder;
diff --git a/smali/com/android/systemui/keyguard/KeyguardViewMediator.smali b/smali/com/android/systemui/keyguard/KeyguardViewMediator.smali
index 9a606784..a1671246 100644
--- a/smali/com/android/systemui/keyguard/KeyguardViewMediator.smali
+++ b/smali/com/android/systemui/keyguard/KeyguardViewMediator.smali
@@ -6797,7 +6797,7 @@
 
     invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
     if-nez v5, :cond_8
 
diff --git a/smali/com/android/systemui/keyguard/animator/ActionDownHandler.smali b/smali/com/android/systemui/keyguard/animator/ActionDownHandler.smali
index a8d67364..43f40c1a 100644
--- a/smali/com/android/systemui/keyguard/animator/ActionDownHandler.smali
+++ b/smali/com/android/systemui/keyguard/animator/ActionDownHandler.smali
@@ -15,7 +15,7 @@
 
 # virtual methods
 .method public final handleMotionEvent(Landroid/view/MotionEvent;)Z
-    .locals 9
+    .locals 8
 
     iget-object p0, p0, Lcom/android/systemui/keyguard/animator/ActionHandlerType;->parent:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
 
@@ -65,471 +65,471 @@
 
     invoke-virtual {p1}, Landroid/view/MotionEvent;->getRawY()F
 
-    move-result v4
+    move-result p1
 
-    iput v4, v2, Landroid/graphics/PointF;->y:F
+    iput p1, v2, Landroid/graphics/PointF;->y:F
 
-    iget-object v2, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->tapAffordanceViewController:Lcom/android/systemui/keyguard/animator/TapAffordanceViewController;
+    iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->tapAffordanceViewController:Lcom/android/systemui/keyguard/animator/TapAffordanceViewController;
 
-    iget-object v2, v2, Lcom/android/systemui/keyguard/animator/TapAffordanceViewController;->restoreSpringAnimationList:Ljava/util/List;
+    iget-object p1, p1, Lcom/android/systemui/keyguard/animator/TapAffordanceViewController;->restoreSpringAnimationList:Ljava/util/List;
 
-    check-cast v2, Ljava/util/ArrayList;
+    check-cast p1, Ljava/util/ArrayList;
 
-    invoke-virtual {v2}, Ljava/util/ArrayList;->clear()V
+    invoke-virtual {p1}, Ljava/util/ArrayList;->clear()V
 
-    iget-object v2, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->pivotViewController:Lcom/android/systemui/keyguard/animator/PivotViewController;
+    iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->pivotViewController:Lcom/android/systemui/keyguard/animator/PivotViewController;
 
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    new-instance v4, Ljava/util/ArrayList;
+    new-instance v2, Ljava/util/ArrayList;
 
-    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V
+    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V
 
-    iget-object v5, v2, Lcom/android/systemui/keyguard/animator/PivotViewController;->pivotViews:Ljava/util/List;
+    iget-object v4, p1, Lcom/android/systemui/keyguard/animator/PivotViewController;->pivotViews:Ljava/util/List;
 
-    invoke-interface {v5}, Ljava/lang/Iterable;->iterator()Ljava/util/Iterator;
+    invoke-interface {v4}, Ljava/lang/Iterable;->iterator()Ljava/util/Iterator;
 
-    move-result-object v6
+    move-result-object v5
 
     :cond_1
     :goto_1
-    invoke-interface {v6}, Ljava/util/Iterator;->hasNext()Z
+    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z
 
-    move-result v7
+    move-result v6
 
-    if-eqz v7, :cond_2
+    if-eqz v6, :cond_2
 
-    invoke-interface {v6}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
-    move-result-object v7
+    move-result-object v6
 
-    move-object v8, v7
+    move-object v7, v6
 
-    check-cast v8, Ljava/lang/Number;
+    check-cast v7, Ljava/lang/Number;
 
-    invoke-virtual {v8}, Ljava/lang/Number;->intValue()I
+    invoke-virtual {v7}, Ljava/lang/Number;->intValue()I
 
-    move-result v8
+    move-result v7
 
-    invoke-virtual {v2, v8}, Lcom/android/systemui/keyguard/animator/ViewAnimationController;->hasView(I)Z
+    invoke-virtual {p1, v7}, Lcom/android/systemui/keyguard/animator/ViewAnimationController;->hasView(I)Z
 
-    move-result v8
+    move-result v7
 
-    xor-int/2addr v8, v0
+    xor-int/2addr v7, v0
 
-    if-eqz v8, :cond_1
+    if-eqz v7, :cond_1
 
-    invoke-virtual {v4, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
+    invoke-virtual {v2, v6}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
 
     goto :goto_1
 
     :cond_2
-    invoke-virtual {v4}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;
+    invoke-virtual {v2}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;
 
-    move-result-object v4
+    move-result-object v2
 
     :goto_2
-    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z
+    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z
 
-    move-result v6
+    move-result v5
 
-    if-eqz v6, :cond_3
+    if-eqz v5, :cond_3
 
-    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
-    move-result-object v6
+    move-result-object v5
 
-    check-cast v6, Ljava/lang/Number;
+    check-cast v5, Ljava/lang/Number;
 
-    invoke-virtual {v6}, Ljava/lang/Number;->intValue()I
+    invoke-virtual {v5}, Ljava/lang/Number;->intValue()I
 
-    move-result v6
+    move-result v5
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    new-instance v6, Ljava/lang/StringBuilder;
 
-    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v6, " is null"
+    const-string v5, " is null"
 
-    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v5
 
-    const-string v7, "KeyguardTouchAnimator"
+    const-string v6, "KeyguardTouchAnimator"
 
-    invoke-static {v7, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v6, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     goto :goto_2
 
     :cond_3
-    invoke-interface {v5}, Ljava/util/List;->iterator()Ljava/util/Iterator;
+    invoke-interface {v4}, Ljava/util/List;->iterator()Ljava/util/Iterator;
 
-    move-result-object v4
+    move-result-object v2
 
     :cond_4
     :goto_3
-    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z
+    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z
 
-    move-result v5
+    move-result v4
 
-    if-eqz v5, :cond_6
+    if-eqz v4, :cond_6
 
-    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v4
 
-    check-cast v5, Ljava/lang/Number;
+    check-cast v4, Ljava/lang/Number;
 
-    invoke-virtual {v5}, Ljava/lang/Number;->intValue()I
+    invoke-virtual {v4}, Ljava/lang/Number;->intValue()I
 
-    move-result v5
+    move-result v4
 
-    invoke-virtual {v2, v5}, Lcom/android/systemui/keyguard/animator/ViewAnimationController;->hasView(I)Z
+    invoke-virtual {p1, v4}, Lcom/android/systemui/keyguard/animator/ViewAnimationController;->hasView(I)Z
 
-    move-result v6
+    move-result v5
 
-    if-nez v6, :cond_5
+    if-nez v5, :cond_5
 
     goto :goto_3
 
     :cond_5
-    invoke-virtual {v2, v5}, Lcom/android/systemui/keyguard/animator/ViewAnimationController;->getView(I)Landroid/view/View;
+    invoke-virtual {p1, v4}, Lcom/android/systemui/keyguard/animator/ViewAnimationController;->getView(I)Landroid/view/View;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-virtual {v6}, Landroid/view/View;->getVisibility()I
+    invoke-virtual {v5}, Landroid/view/View;->getVisibility()I
 
-    move-result v7
+    move-result v6
 
-    if-nez v7, :cond_4
+    if-nez v6, :cond_4
 
-    iget-object v7, v2, Lcom/android/systemui/keyguard/animator/PivotViewController;->pivot:Landroid/util/SparseArray;
+    iget-object v6, p1, Lcom/android/systemui/keyguard/animator/PivotViewController;->pivot:Landroid/util/SparseArray;
 
-    invoke-virtual {v7, v5}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
+    invoke-virtual {v6, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v4
 
-    check-cast v5, Landroid/util/Pair;
+    check-cast v4, Landroid/util/Pair;
 
-    if-eqz v5, :cond_4
+    if-eqz v4, :cond_4
 
-    iget-object v7, v5, Landroid/util/Pair;->first:Ljava/lang/Object;
+    iget-object v6, v4, Landroid/util/Pair;->first:Ljava/lang/Object;
 
-    check-cast v7, Ljava/util/function/Function;
+    check-cast v6, Ljava/util/function/Function;
 
-    invoke-interface {v7, v6}, Ljava/util/function/Function;->apply(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-interface {v6, v5}, Ljava/util/function/Function;->apply(Ljava/lang/Object;)Ljava/lang/Object;
 
-    move-result-object v7
+    move-result-object v6
 
-    check-cast v7, Ljava/lang/Number;
+    check-cast v6, Ljava/lang/Number;
 
-    invoke-virtual {v7}, Ljava/lang/Number;->floatValue()F
+    invoke-virtual {v6}, Ljava/lang/Number;->floatValue()F
 
-    move-result v7
+    move-result v6
 
-    invoke-virtual {v6, v7}, Landroid/view/View;->setPivotX(F)V
+    invoke-virtual {v5, v6}, Landroid/view/View;->setPivotX(F)V
 
-    iget-object v5, v5, Landroid/util/Pair;->second:Ljava/lang/Object;
+    iget-object v4, v4, Landroid/util/Pair;->second:Ljava/lang/Object;
 
-    check-cast v5, Ljava/util/function/Function;
+    check-cast v4, Ljava/util/function/Function;
 
-    invoke-interface {v5, v6}, Ljava/util/function/Function;->apply(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-interface {v4, v5}, Ljava/util/function/Function;->apply(Ljava/lang/Object;)Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v4
 
-    check-cast v5, Ljava/lang/Number;
+    check-cast v4, Ljava/lang/Number;
 
-    invoke-virtual {v5}, Ljava/lang/Number;->floatValue()F
+    invoke-virtual {v4}, Ljava/lang/Number;->floatValue()F
 
-    move-result v5
+    move-result v4
 
-    invoke-virtual {v6, v5}, Landroid/view/View;->setPivotY(F)V
+    invoke-virtual {v5, v4}, Landroid/view/View;->setPivotY(F)V
 
     goto :goto_3
 
     :cond_6
-    iget-boolean v2, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchBase;->hasDozeAmount:Z
+    iget-boolean p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchBase;->hasDozeAmount:Z
 
-    if-eqz v2, :cond_7
+    if-eqz p1, :cond_7
 
     return v0
 
     :cond_7
-    iget-object v2, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->keyguardEditModeController:Lcom/android/systemui/keyguard/KeyguardEditModeController;
+    iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->keyguardEditModeController:Lcom/android/systemui/keyguard/KeyguardEditModeController;
 
-    check-cast v2, Lcom/android/systemui/keyguard/KeyguardEditModeControllerImpl;
+    check-cast p1, Lcom/android/systemui/keyguard/KeyguardEditModeControllerImpl;
 
-    iget-object v4, v2, Lcom/android/systemui/keyguard/KeyguardEditModeControllerImpl;->settingsHelper:Lcom/android/systemui/util/SettingsHelper;
+    iget-object v2, p1, Lcom/android/systemui/keyguard/KeyguardEditModeControllerImpl;->settingsHelper:Lcom/android/systemui/util/SettingsHelper;
 
-    invoke-virtual {v4}, Lcom/android/systemui/util/SettingsHelper;->isSupportTouchAndHoldToEdit()Z
+    invoke-virtual {v2}, Lcom/android/systemui/util/SettingsHelper;->isSupportTouchAndHoldToEdit()Z
 
-    move-result v4
+    move-result v2
 
-    const-string v5, "KeyguardEditModeController"
+    const-string v4, "KeyguardEditModeController"
 
-    if-eqz v4, :cond_12
+    if-eqz v2, :cond_12
 
-    iget-boolean v4, v2, Lcom/android/systemui/keyguard/KeyguardEditModeControllerImpl;->isEditMode:Z
+    iget-boolean v2, p1, Lcom/android/systemui/keyguard/KeyguardEditModeControllerImpl;->isEditMode:Z
 
-    if-eqz v4, :cond_8
+    if-eqz v2, :cond_8
 
     goto/16 :goto_9
 
     :cond_8
-    iget-object v2, v2, Lcom/android/systemui/keyguard/KeyguardEditModeControllerImpl;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
+    iget-object p1, p1, Lcom/android/systemui/keyguard/KeyguardEditModeControllerImpl;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isUserUnlocked()Z
+    invoke-interface {p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isUserUnlocked()Z
 
-    move-result v2
+    move-result p1
 
-    if-nez v2, :cond_9
+    if-nez p1, :cond_9
 
-    const-string v2, "can not be FBE"
+    const-string p1, "can not be FBE"
 
-    invoke-static {v5, v2}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v4, p1}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     goto/16 :goto_a
 
     :cond_9
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
-    move-result v2
+    move-result p1
 
-    iget-object v4, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchBase;->context:Landroid/content/Context;
+    iget-object v2, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchBase;->context:Landroid/content/Context;
 
-    if-eqz v2, :cond_b
+    if-eqz p1, :cond_b
 
-    invoke-virtual {v4}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {v2}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v2
+    move-result-object p1
 
-    invoke-virtual {v2}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    invoke-virtual {p1}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
-    move-result-object v2
+    move-result-object p1
 
-    iget v2, v2, Landroid/content/res/Configuration;->semDesktopModeEnabled:I
+    iget p1, p1, Landroid/content/res/Configuration;->semDesktopModeEnabled:I
 
-    if-ne v2, v0, :cond_a
+    if-ne p1, v0, :cond_a
 
-    const-string v2, "can not be : New Dex"
+    const-string p1, "can not be : New Dex"
 
-    invoke-static {v5, v2}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v4, p1}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     goto/16 :goto_a
 
     :cond_a
-    const-class v2, Lcom/android/systemui/util/DesktopManager;
+    const-class p1, Lcom/android/systemui/util/DesktopManager;
 
-    invoke-static {v2}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+    invoke-static {p1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    move-result-object v2
+    move-result-object p1
 
-    check-cast v2, Lcom/android/systemui/util/DesktopManager;
+    check-cast p1, Lcom/android/systemui/util/DesktopManager;
 
-    check-cast v2, Lcom/android/systemui/util/DesktopManagerImpl;
+    check-cast p1, Lcom/android/systemui/util/DesktopManagerImpl;
 
-    invoke-virtual {v2}, Lcom/android/systemui/util/DesktopManagerImpl;->isStandalone()Z
+    invoke-virtual {p1}, Lcom/android/systemui/util/DesktopManagerImpl;->isStandalone()Z
 
-    move-result v2
+    move-result p1
 
-    if-eqz v2, :cond_b
+    if-eqz p1, :cond_b
 
-    const-string v2, "can not be : Dex Standalone"
+    const-string p1, "can not be : Dex Standalone"
 
-    invoke-static {v5, v2}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v4, p1}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     goto/16 :goto_a
 
     :cond_b
     invoke-static {}, Lcom/samsung/android/knox/custom/CustomDeviceManager;->getInstance()Lcom/samsung/android/knox/custom/CustomDeviceManager;
 
-    move-result-object v2
+    move-result-object p1
 
-    invoke-virtual {v2}, Lcom/samsung/android/knox/custom/CustomDeviceManager;->getProKioskManager()Lcom/samsung/android/knox/custom/ProKioskManager;
+    invoke-virtual {p1}, Lcom/samsung/android/knox/custom/CustomDeviceManager;->getProKioskManager()Lcom/samsung/android/knox/custom/ProKioskManager;
 
-    move-result-object v2
+    move-result-object p1
 
-    invoke-virtual {v2}, Lcom/samsung/android/knox/custom/ProKioskManager;->getProKioskState()Z
+    invoke-virtual {p1}, Lcom/samsung/android/knox/custom/ProKioskManager;->getProKioskState()Z
 
-    move-result v2
+    move-result p1
 
-    if-eqz v2, :cond_c
+    if-eqz p1, :cond_c
 
-    const-string v2, "isKioskMode : proKiosk mode"
+    const-string p1, "isKioskMode : proKiosk mode"
 
-    invoke-static {v5, v2}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v4, p1}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     goto :goto_4
 
     :cond_c
     :try_start_0
-    invoke-static {v4}, Lcom/samsung/android/knox/EnterpriseDeviceManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/EnterpriseDeviceManager;
+    invoke-static {v2}, Lcom/samsung/android/knox/EnterpriseDeviceManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/EnterpriseDeviceManager;
 
-    move-result-object v2
+    move-result-object p1
 
-    invoke-virtual {v2}, Lcom/samsung/android/knox/EnterpriseDeviceManager;->getKioskMode()Lcom/samsung/android/knox/kiosk/KioskMode;
+    invoke-virtual {p1}, Lcom/samsung/android/knox/EnterpriseDeviceManager;->getKioskMode()Lcom/samsung/android/knox/kiosk/KioskMode;
 
-    move-result-object v2
+    move-result-object p1
 
-    invoke-virtual {v2}, Lcom/samsung/android/knox/kiosk/KioskMode;->isKioskModeEnabled()Z
+    invoke-virtual {p1}, Lcom/samsung/android/knox/kiosk/KioskMode;->isKioskModeEnabled()Z
 
-    move-result v2
+    move-result p1
 
-    if-eqz v2, :cond_d
+    if-eqz p1, :cond_d
 
-    const-string v2, "isKioskMode : Kiosk mode"
+    const-string p1, "isKioskMode : Kiosk mode"
 
-    invoke-static {v5, v2}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v4, p1}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
     :try_end_0
     .catch Ljava/lang/SecurityException; {:try_start_0 .. :try_end_0} :catch_0
 
     :goto_4
-    move v2, v0
+    move p1, v0
 
     goto :goto_5
 
     :catch_0
-    move-exception v2
+    move-exception p1
 
-    new-instance v6, Ljava/lang/StringBuilder;
+    new-instance v5, Ljava/lang/StringBuilder;
 
-    const-string v7, "SecurityException: "
+    const-string v6, "SecurityException: "
 
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v6, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object p1
 
-    invoke-static {v5, v2}, Lcom/android/systemui/keyguard/Log;->w(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v4, p1}, Lcom/android/systemui/keyguard/Log;->w(Ljava/lang/String;Ljava/lang/String;)V
 
     :cond_d
-    move v2, v3
+    move p1, v3
 
     :goto_5
-    if-eqz v2, :cond_e
+    if-eqz p1, :cond_e
 
-    const-string v2, "can not be : Kiosk Modee"
+    const-string p1, "can not be : Kiosk Modee"
 
-    invoke-static {v5, v2}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v4, p1}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     goto :goto_a
 
     :cond_e
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
-    move-result v2
+    move-result p1
 
-    if-nez v2, :cond_10
+    if-nez p1, :cond_10
 
-    sget-boolean v2, Lcom/android/systemui/LsRune;->LOCKUI_SUB_DISPLAY_LOCK:Z
+    sget-boolean p1, Lcom/android/systemui/LsRune;->LOCKUI_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v2, :cond_f
+    if-eqz p1, :cond_f
 
-    invoke-virtual {v4}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {v2}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v2
+    move-result-object p1
 
-    invoke-virtual {v2}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    invoke-virtual {p1}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
-    move-result-object v2
+    move-result-object p1
 
-    iget v2, v2, Landroid/content/res/Configuration;->semDisplayDeviceType:I
+    iget p1, p1, Landroid/content/res/Configuration;->semDisplayDeviceType:I
 
-    if-nez v2, :cond_f
+    if-nez p1, :cond_f
 
     goto :goto_6
 
     :cond_f
-    move v2, v3
+    move p1, v3
 
     goto :goto_7
 
     :cond_10
     :goto_6
-    move v2, v0
+    move p1, v0
 
     :goto_7
-    if-eqz v2, :cond_11
+    if-eqz p1, :cond_11
 
     goto :goto_8
 
     :cond_11
-    invoke-virtual {v4}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {v2}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v2
+    move-result-object p1
 
-    invoke-virtual {v2}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    invoke-virtual {p1}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
-    move-result-object v2
+    move-result-object p1
 
-    iget v2, v2, Landroid/content/res/Configuration;->orientation:I
+    iget p1, p1, Landroid/content/res/Configuration;->orientation:I
 
-    if-ne v2, v0, :cond_13
+    if-ne p1, v0, :cond_13
 
     :goto_8
-    move v2, v0
+    move p1, v0
 
     goto :goto_b
 
     :cond_12
     :goto_9
-    iget-boolean v2, v2, Lcom/android/systemui/keyguard/KeyguardEditModeControllerImpl;->isEditMode:Z
+    iget-boolean p1, p1, Lcom/android/systemui/keyguard/KeyguardEditModeControllerImpl;->isEditMode:Z
 
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v2, Ljava/lang/StringBuilder;
 
-    const-string v6, "can not be EM="
+    const-string v5, "can not be EM="
 
-    invoke-direct {v4, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v2, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object p1
 
-    invoke-static {v5, v2}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v4, p1}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     :cond_13
     :goto_a
-    move v2, v3
+    move p1, v3
 
     :goto_b
-    iget-object v4, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->editModeAnimatorController:Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;
+    iget-object v2, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->editModeAnimatorController:Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;
 
-    if-eqz v2, :cond_14
+    if-eqz p1, :cond_14
 
-    invoke-virtual {p0, p1}, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->canLongPressArea(Landroid/view/MotionEvent;)Z
+    invoke-virtual {p0}, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->canLongPressArea()Z
 
-    move-result v2
+    move-result p1
 
-    if-eqz v2, :cond_14
+    if-eqz p1, :cond_14
 
-    iget-object v2, v4, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->animatorSet:Landroid/animation/AnimatorSet;
+    iget-object p1, v2, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->animatorSet:Landroid/animation/AnimatorSet;
 
-    invoke-virtual {v2}, Landroid/animation/AnimatorSet;->isRunning()Z
+    invoke-virtual {p1}, Landroid/animation/AnimatorSet;->isRunning()Z
 
-    move-result v2
+    move-result p1
 
-    if-nez v2, :cond_14
+    if-nez p1, :cond_14
 
-    move v2, v0
+    move p1, v0
 
     goto :goto_c
 
     :cond_14
-    move v2, v3
+    move p1, v3
 
     :goto_c
-    if-eqz v2, :cond_17
+    if-eqz p1, :cond_17
 
-    invoke-virtual {v4}, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->isEditMode()Z
+    invoke-virtual {v2}, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->isEditMode()Z
 
     move-result p0
 
@@ -553,13 +553,13 @@
 
     invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {v4}, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->isEditMode()Z
+    invoke-virtual {v2}, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->isEditMode()Z
 
     move-result p0
 
     if-nez p0, :cond_19
 
-    iget-object p0, v4, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->longPressJob:Lkotlinx/coroutines/StandaloneCoroutine;
+    iget-object p0, v2, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->longPressJob:Lkotlinx/coroutines/StandaloneCoroutine;
 
     if-eqz p0, :cond_15
 
@@ -576,7 +576,7 @@
 
     if-eqz v3, :cond_16
 
-    iget-object p1, v4, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->longPressJob:Lkotlinx/coroutines/StandaloneCoroutine;
+    iget-object p1, v2, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->longPressJob:Lkotlinx/coroutines/StandaloneCoroutine;
 
     if-eqz p1, :cond_16
 
@@ -593,20 +593,20 @@
 
     new-instance v1, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController$actionDown$1;
 
-    invoke-direct {v1, v4, p0}, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController$actionDown$1;-><init>(Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;Lkotlin/coroutines/Continuation;)V
+    invoke-direct {v1, v2, p0}, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController$actionDown$1;-><init>(Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;Lkotlin/coroutines/Continuation;)V
 
-    const/4 v2, 0x3
+    const/4 v3, 0x3
 
-    invoke-static {p1, p0, p0, v1, v2}, Lkotlinx/coroutines/BuildersKt;->launch$default(Lkotlinx/coroutines/CoroutineScope;Lkotlin/coroutines/CoroutineContext;Lkotlinx/coroutines/CoroutineStart;Lkotlin/jvm/functions/Function2;I)Lkotlinx/coroutines/StandaloneCoroutine;
+    invoke-static {p1, p0, p0, v1, v3}, Lkotlinx/coroutines/BuildersKt;->launch$default(Lkotlinx/coroutines/CoroutineScope;Lkotlin/coroutines/CoroutineContext;Lkotlinx/coroutines/CoroutineStart;Lkotlin/jvm/functions/Function2;I)Lkotlinx/coroutines/StandaloneCoroutine;
 
     move-result-object p0
 
-    iput-object p0, v4, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->longPressJob:Lkotlinx/coroutines/StandaloneCoroutine;
+    iput-object p0, v2, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->longPressJob:Lkotlinx/coroutines/StandaloneCoroutine;
 
     goto :goto_d
 
     :cond_17
-    invoke-virtual {p0, p1}, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->canLongPressArea(Landroid/view/MotionEvent;)Z
+    invoke-virtual {p0}, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->canLongPressArea()Z
 
     move-result p0
 
@@ -624,7 +624,7 @@
 
     if-nez p0, :cond_18
 
-    invoke-virtual {v4}, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->isLongPressed$frameworks__base__packages__SystemUI__android_common__SystemUI_core()Z
+    invoke-virtual {v2}, Lcom/android/systemui/keyguard/animator/KeyguardEditModeAnimatorController;->isLongPressed$frameworks__base__packages__SystemUI__android_common__SystemUI_core()Z
 
     move-result p0
 
diff --git a/smali/com/android/systemui/keyguard/animator/FullScreenViewController.smali b/smali/com/android/systemui/keyguard/animator/FullScreenViewController.smali
index 3599f3bd..1b471db5 100644
--- a/smali/com/android/systemui/keyguard/animator/FullScreenViewController.smali
+++ b/smali/com/android/systemui/keyguard/animator/FullScreenViewController.smali
@@ -425,9 +425,9 @@
 
     const-wide/16 v1, 0x3e8
 
-    cmp-long v1, v6, v1
+    cmp-long p1, v6, v1
 
-    if-gez v1, :cond_10
+    if-gez p1, :cond_10
 
     const-string v5, "1"
 
@@ -436,9 +436,9 @@
     :cond_10
     const-wide/16 v1, 0x7d0
 
-    cmp-long v1, v6, v1
+    cmp-long p1, v6, v1
 
-    if-gez v1, :cond_11
+    if-gez p1, :cond_11
 
     const-string v5, "2"
 
@@ -447,9 +447,9 @@
     :cond_11
     const-wide/16 v1, 0xfa0
 
-    cmp-long v1, v6, v1
+    cmp-long p1, v6, v1
 
-    if-gez v1, :cond_12
+    if-gez p1, :cond_12
 
     const-string v5, "3"
 
@@ -458,9 +458,9 @@
     :cond_12
     const-wide/16 v1, 0x1b58
 
-    cmp-long v1, v6, v1
+    cmp-long p1, v6, v1
 
-    if-gez v1, :cond_13
+    if-gez p1, :cond_13
 
     const-string v5, "4"
 
@@ -469,67 +469,34 @@
     :cond_13
     const-wide/16 v1, 0x2710
 
-    cmp-long v1, v6, v1
+    cmp-long p1, v6, v1
 
-    if-gez v1, :cond_14
+    if-gez p1, :cond_14
 
     const-string v5, "5"
 
     goto :goto_a
 
     :cond_14
-    if-ltz v1, :cond_15
+    if-ltz p1, :cond_15
 
     const-string v5, "6"
 
     :cond_15
     :goto_a
-    sget-object v1, Lcom/android/systemui/util/SystemUIAnalytics;->sCurrentScreenID:Ljava/lang/String;
+    sget-object p1, Lcom/android/systemui/util/SystemUIAnalytics;->sCurrentScreenID:Ljava/lang/String;
 
-    const-string v2, "1011"
+    const-string v1, "1011"
 
-    invoke-static {v1, v2, v5}, Lcom/android/systemui/util/SystemUIAnalytics;->sendEventLog(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {p1, v1, v5}, Lcom/android/systemui/util/SystemUIAnalytics;->sendEventLog(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
 
     :goto_b
-    iget-object v1, v0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->securityInjector:Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;
+    iget-object p1, v0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->securityInjector:Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    sget-boolean v2, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    const/4 v4, 0x2
-
-    if-eqz v2, :cond_17
-
-    iget-object v1, v1, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_17
-
-    const-string v2, "KeyguardFingerprint"
-
-    if-eqz p1, :cond_16
+    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string p1, "onFullScreenModeChanged is true. FP will be stop!"
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    invoke-static {v2, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->stopListeningForFingerprint()V
-
-    goto :goto_c
-
-    :cond_16
-    const-string p1, "onFullScreenModeChanged is false. FP will be start!"
-
-    invoke-static {v2, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v1, v4}, Lcom/android/keyguard/KeyguardUpdateMonitor;->updateFingerprintListeningState(I)V
-
-    :cond_17
-    :goto_c
     invoke-virtual {p0}, Lcom/android/systemui/keyguard/animator/ViewAnimationController;->getParentView()Landroid/view/View;
 
     move-result-object p1
@@ -550,20 +517,20 @@
 
     move-result v0
 
-    if-nez v0, :cond_18
+    if-nez v0, :cond_16
 
-    goto :goto_e
+    goto :goto_d
 
-    :cond_18
+    :cond_16
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
     move-result v0
 
-    if-nez v0, :cond_1a
+    if-nez v0, :cond_18
 
     sget-boolean v0, Lcom/android/systemui/LsRune;->LOCKUI_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v0, :cond_19
+    if-eqz v0, :cond_17
 
     invoke-virtual {p1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
@@ -575,21 +542,21 @@
 
     iget v0, v0, Landroid/content/res/Configuration;->semDisplayDeviceType:I
 
-    if-nez v0, :cond_19
+    if-nez v0, :cond_17
 
-    goto :goto_d
+    goto :goto_c
 
-    :cond_19
+    :cond_17
     move v9, v3
 
-    :cond_1a
-    :goto_d
-    if-eqz v9, :cond_1b
+    :cond_18
+    :goto_c
+    if-eqz v9, :cond_19
 
-    goto :goto_e
+    goto :goto_d
 
-    :cond_1b
-    if-eqz p0, :cond_1c
+    :cond_19
+    if-eqz p0, :cond_1a
 
     invoke-virtual {p1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
@@ -601,7 +568,9 @@
 
     iget p0, p0, Landroid/content/res/Configuration;->orientation:I
 
-    if-ne p0, v4, :cond_1c
+    const/4 v0, 0x2
+
+    if-ne p0, v0, :cond_1a
 
     invoke-virtual {p1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
@@ -619,7 +588,7 @@
 
     invoke-virtual {p0}, Landroid/widget/Toast;->show()V
 
-    :cond_1c
-    :goto_e
+    :cond_1a
+    :goto_d
     return-void
 .end method
diff --git a/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator$2.smali b/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator$2.smali
index f7e0bab2..7accd5dd 100644
--- a/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator$2.smali
+++ b/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator$2.smali
@@ -4,8 +4,6 @@
 
 
 # instance fields
-.field public final synthetic $keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
 .field public final synthetic $powerManager:Landroid/os/PowerManager;
 
 .field public final synthetic this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
@@ -17,8 +15,6 @@
 
     iput-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
 
-    iput-object p2, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->$keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
     iput-object p3, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->$powerManager:Landroid/os/PowerManager;
 
     invoke-direct {p0}, Landroid/view/GestureDetector$SimpleOnGestureListener;-><init>()V
@@ -57,7 +53,7 @@
 
     const/4 v2, 0x1
 
-    if-ne v0, v2, :cond_7
+    if-ne v0, v2, :cond_6
 
     iget-object v0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
 
@@ -83,19 +79,19 @@
 
     if-lez v7, :cond_0
 
-    new-instance v0, Ljava/lang/StringBuilder;
+    new-instance p1, Ljava/lang/StringBuilder;
 
-    const-string v3, "isConsideredDoubleTap: time out deltaTime="
+    const-string v0, "isConsideredDoubleTap: time out deltaTime="
 
-    invoke-direct {v0, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v0, v5, v6}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
+    invoke-virtual {p1, v5, v6}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v0
+    move-result-object p1
 
-    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     goto :goto_2
 
@@ -122,106 +118,95 @@
 
     invoke-virtual {p1}, Landroid/view/MotionEvent;->getY()F
 
-    move-result v7
+    move-result p1
 
-    float-to-int v7, v7
+    float-to-int p1, p1
 
-    sub-int/2addr v6, v7
+    sub-int/2addr v6, p1
 
     invoke-virtual {v3}, Landroid/view/MotionEvent;->getFlags()I
 
-    move-result v3
+    move-result p1
 
-    and-int/lit8 v3, v3, 0x8
+    and-int/lit8 p1, p1, 0x8
 
-    if-eqz v3, :cond_1
+    if-eqz p1, :cond_1
 
-    move v3, v2
+    move p1, v2
 
     goto :goto_0
 
     :cond_1
-    move v3, v1
+    move p1, v1
 
     :goto_0
-    if-eqz v3, :cond_2
+    if-eqz p1, :cond_2
 
-    move v0, v1
+    move p1, v1
 
     goto :goto_1
 
     :cond_2
-    iget v0, v0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->doubleTapSlop:I
+    iget p1, v0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->doubleTapSlop:I
 
-    mul-int/2addr v0, v0
+    mul-int/2addr p1, p1
 
     :goto_1
-    mul-int v3, v5, v5
+    mul-int v0, v5, v5
 
-    mul-int v7, v6, v6
+    mul-int v3, v6, v6
 
-    add-int/2addr v7, v3
+    add-int/2addr v3, v0
 
-    if-lt v7, v0, :cond_3
+    if-lt v3, p1, :cond_3
 
-    const-string v0, "isConsideredDoubleTap: over slop="
+    const-string p1, "isConsideredDoubleTap: over slop="
 
-    const-string v3, ", deltaX="
+    const-string v0, ", deltaX="
 
-    const-string v8, ", deltaY="
+    const-string v7, ", deltaY="
 
-    invoke-static {v0, v7, v3, v5, v8}, Landroidx/recyclerview/widget/GridLayoutManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;ILjava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-static {p1, v3, v0, v5, v7}, Landroidx/recyclerview/widget/GridLayoutManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;ILjava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v0
+    move-result-object p1
 
-    invoke-static {v0, v6, v4}, Landroidx/recyclerview/widget/RecyclerView$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
+    invoke-static {p1, v6, v4}, Landroidx/recyclerview/widget/RecyclerView$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
 
     goto :goto_2
 
     :cond_3
-    move v0, v2
+    move p1, v2
 
     goto :goto_3
 
     :cond_4
     :goto_2
-    move v0, v1
+    move p1, v1
 
     :goto_3
-    if-eqz v0, :cond_6
-
-    iget-object v0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
-
-    iget-object v3, v0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->keyguardStateController:Lcom/android/systemui/statusbar/policy/KeyguardStateController;
-
-    check-cast v3, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;
-
-    iget-boolean v3, v3, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mKeyguardGoingAway:Z
+    if-eqz p1, :cond_5
 
-    if-nez v3, :cond_6
+    iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
 
-    iget-object v0, v0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->securityInjector:Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;
+    iget-object v0, p1, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->keyguardStateController:Lcom/android/systemui/statusbar/policy/KeyguardStateController;
 
-    invoke-virtual {v0, p1}, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->isFingerprintArea(Landroid/view/MotionEvent;)Z
+    check-cast v0, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;
 
-    move-result p1
+    iget-boolean v0, v0, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mKeyguardGoingAway:Z
 
-    if-eqz p1, :cond_5
+    if-nez v0, :cond_5
 
-    iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->$keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
+    iget-object p1, p1, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->securityInjector:Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;
 
-    invoke-virtual {p1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFingerprintDetectionRunning()Z
+    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    move-result p1
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-nez p1, :cond_6
-
-    :cond_5
     move p1, v2
 
     goto :goto_4
 
-    :cond_6
+    :cond_5
     move p1, v1
 
     :goto_4
@@ -229,7 +214,7 @@
 
     invoke-static {v0, p1, v4}, Lcom/android/keyguard/KeyguardCarrierPasswordViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ZLjava/lang/String;)V
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_6
 
     iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->$powerManager:Landroid/os/PowerManager;
 
@@ -253,6 +238,6 @@
 
     move v1, v2
 
-    :cond_7
+    :cond_6
     return v1
 .end method
diff --git a/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator.smali b/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator.smali
index 66f22486..b77a4864 100644
--- a/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator.smali
+++ b/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator.smali
@@ -258,40 +258,38 @@
 
 
 # virtual methods
-.method public final canLongPressArea(Landroid/view/MotionEvent;)Z
-    .locals 1
+.method public final canLongPressArea()Z
+    .locals 2
 
     iget-object v0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->securityInjector:Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;
 
-    invoke-virtual {v0, p1}, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->isFingerprintArea(Landroid/view/MotionEvent;)Z
-
-    move-result p1
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    if-nez p1, :cond_0
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchBase;->touchDownPos:Landroid/graphics/PointF;
+    iget-object v0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchBase;->touchDownPos:Landroid/graphics/PointF;
 
-    iget p1, p1, Landroid/graphics/PointF;->y:F
+    iget v0, v0, Landroid/graphics/PointF;->y:F
 
-    iget-object v0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->parentView$delegate:Lkotlin/Lazy;
+    iget-object v1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->parentView$delegate:Lkotlin/Lazy;
 
-    invoke-interface {v0}, Lkotlin/Lazy;->getValue()Ljava/lang/Object;
+    invoke-interface {v1}, Lkotlin/Lazy;->getValue()Ljava/lang/Object;
 
-    move-result-object v0
+    move-result-object v1
 
-    check-cast v0, Landroid/view/View;
+    check-cast v1, Landroid/view/View;
 
-    invoke-virtual {v0}, Landroid/view/View;->getHeight()I
+    invoke-virtual {v1}, Landroid/view/View;->getHeight()I
 
-    move-result v0
+    move-result v1
 
     iget p0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchBase;->longPressAllowHeight:I
 
-    sub-int/2addr v0, p0
+    sub-int/2addr v1, p0
 
-    int-to-float p0, v0
+    int-to-float p0, v1
 
-    cmpg-float p0, p1, p0
+    cmpg-float p0, v0, p0
 
     if-gez p0, :cond_0
 
diff --git a/smali/com/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector.smali b/smali/com/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector.smali
index 158e8764..806a7ec8 100644
--- a/smali/com/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector.smali
+++ b/smali/com/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector.smali
@@ -4,8 +4,6 @@
 
 
 # instance fields
-.field public final mFingerprintManager:Landroid/hardware/fingerprint/FingerprintManager;
-
 .field public final mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
 
@@ -17,84 +15,5 @@
 
     iput-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    if-eqz p2, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p2, 0x0
-
-    :goto_0
-    iput-object p2, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->mFingerprintManager:Landroid/hardware/fingerprint/FingerprintManager;
-
     return-void
 .end method
-
-
-# virtual methods
-.method public final isFingerprintArea(Landroid/view/MotionEvent;)Z
-    .locals 2
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->mFingerprintManager:Landroid/hardware/fingerprint/FingerprintManager;
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    invoke-static {}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getCurrentUser()I
-
-    move-result v1
-
-    invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getUserCanSkipBouncer(I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_0
-
-    invoke-virtual {v0}, Landroid/hardware/fingerprint/FingerprintManager;->semGetSensorAreaInDisplay()Landroid/graphics/Rect;
-
-    move-result-object p0
-
-    invoke-virtual {p1}, Landroid/view/MotionEvent;->getRawX()F
-
-    move-result v0
-
-    float-to-int v0, v0
-
-    invoke-virtual {p1}, Landroid/view/MotionEvent;->getRawY()F
-
-    move-result p1
-
-    float-to-int p1, p1
-
-    invoke-virtual {p0, v0, p1}, Landroid/graphics/Rect;->contains(II)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const-string p0, "KeyguardFingerPrintSwipe"
-
-    const-string p1, "mLongPressCallback canceled. Touch position is FP-InDisplay area!"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
diff --git a/smali/com/android/systemui/power/PowerNotificationWarnings.smali b/smali/com/android/systemui/power/PowerNotificationWarnings.smali
index 55658866..a20c17fc 100644
--- a/smali/com/android/systemui/power/PowerNotificationWarnings.smali
+++ b/smali/com/android/systemui/power/PowerNotificationWarnings.smali
@@ -335,6 +335,29 @@
     return-void
 .end method
 
+.method public final dismissInvalidChargerWarning()V
+    .locals 2
+
+    iget-boolean v0, p0, Lcom/android/systemui/power/PowerNotificationWarnings;->mInvalidCharger:Z
+
+    if-eqz v0, :cond_0
+
+    const-string v0, "PowerUI.Notification"
+
+    const-string v1, "dismissing invalid charger notification"
+
+    invoke-static {v0, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+
+    :cond_0
+    const/4 v0, 0x0
+
+    iput-boolean v0, p0, Lcom/android/systemui/power/PowerNotificationWarnings;->mInvalidCharger:Z
+
+    invoke-virtual {p0}, Lcom/android/systemui/power/PowerNotificationWarnings;->updateNotification()V
+
+    return-void
+.end method
+
 .method public dismissThermalShutdownWarning()V
     .locals 3
 
diff --git a/smali/com/android/systemui/power/PowerUI$Receiver.smali b/smali/com/android/systemui/power/PowerUI$Receiver.smali
index b5d13319..6d2a070a 100644
--- a/smali/com/android/systemui/power/PowerUI$Receiver.smali
+++ b/smali/com/android/systemui/power/PowerUI$Receiver.smali
@@ -49,7 +49,7 @@
 
     const/4 v6, 0x0
 
-    if-eqz v4, :cond_22
+    if-eqz v4, :cond_21
 
     iput-boolean v5, v1, Lcom/android/systemui/power/PowerUI$Receiver;->mHasReceivedBattery:Z
 
@@ -837,38 +837,23 @@
     return-void
 
     :cond_13
-    if-eqz v8, :cond_15
+    if-eqz v8, :cond_14
 
     iget-object v3, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
     iget v5, v3, Lcom/android/systemui/power/PowerUI;->mInvalidCharger:I
 
-    if-nez v5, :cond_15
+    if-nez v5, :cond_14
 
     iget-object v3, v3, Lcom/android/systemui/power/PowerUI;->mWarnings:Lcom/android/systemui/power/PowerUI$WarningsUI;
 
     check-cast v3, Lcom/android/systemui/power/PowerNotificationWarnings;
 
-    iget-boolean v5, v3, Lcom/android/systemui/power/PowerNotificationWarnings;->mInvalidCharger:Z
-
-    if-eqz v5, :cond_14
-
-    const-string v5, "PowerUI.Notification"
-
-    const-string v6, "dismissing invalid charger notification"
-
-    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_14
-    const/4 v5, 0x0
-
-    iput-boolean v5, v3, Lcom/android/systemui/power/PowerNotificationWarnings;->mInvalidCharger:Z
-
-    invoke-virtual {v3}, Lcom/android/systemui/power/PowerNotificationWarnings;->updateNotification()V
+    invoke-virtual {v3}, Lcom/android/systemui/power/PowerNotificationWarnings;->dismissInvalidChargerWarning()V
 
     goto :goto_a
 
-    :cond_15
+    :cond_14
     iget-object v3, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
     iget-object v3, v3, Lcom/android/systemui/power/PowerUI;->mWarnings:Lcom/android/systemui/power/PowerUI$WarningsUI;
@@ -877,9 +862,9 @@
 
     iget-boolean v3, v3, Lcom/android/systemui/power/PowerNotificationWarnings;->mInvalidCharger:Z
 
-    if-eqz v3, :cond_17
+    if-eqz v3, :cond_16
 
-    if-eqz v0, :cond_16
+    if-eqz v0, :cond_15
 
     const-string v0, "PowerUI"
 
@@ -887,22 +872,22 @@
 
     invoke-static {v0, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_16
+    :cond_15
     return-void
 
-    :cond_17
+    :cond_16
     :goto_a
     iget-object v3, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
     iget-object v3, v3, Lcom/android/systemui/power/PowerUI;->mLastShowWarningTask:Ljava/util/concurrent/Future;
 
-    if-eqz v3, :cond_18
+    if-eqz v3, :cond_17
 
     const/4 v5, 0x1
 
     invoke-interface {v3, v5}, Ljava/util/concurrent/Future;->cancel(Z)Z
 
-    if-eqz v0, :cond_18
+    if-eqz v0, :cond_17
 
     const-string v0, "PowerUI"
 
@@ -910,7 +895,7 @@
 
     invoke-static {v0, v3}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_18
+    :cond_17
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
     new-instance v3, Lcom/android/systemui/power/PowerUI$Receiver$$ExternalSyntheticLambda0;
@@ -945,7 +930,7 @@
 
     invoke-static {v0, v7, v4, v12}, Lcom/android/systemui/power/PowerUI;->-$$Nest$mshowChargingNotice(Lcom/android/systemui/power/PowerUI;III)V
 
-    if-eqz v19, :cond_19
+    if-eqz v19, :cond_18
 
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
@@ -953,7 +938,7 @@
 
     invoke-static {v0, v5, v4}, Lcom/android/systemui/power/PowerUI;->-$$Nest$mcheckBatterySwellingStatus(Lcom/android/systemui/power/PowerUI;II)V
 
-    :cond_19
+    :cond_18
     const-string v0, "PowerUI"
 
     new-instance v5, Ljava/lang/StringBuilder;
@@ -974,13 +959,13 @@
 
     and-int/lit16 v5, v5, 0x4000
 
-    if-eqz v5, :cond_1a
+    if-eqz v5, :cond_19
 
     const/4 v5, 0x1
 
     goto :goto_b
 
-    :cond_1a
+    :cond_19
     const/4 v5, 0x0
 
     :goto_b
@@ -988,7 +973,7 @@
 
     sget-boolean v0, Lcom/android/systemui/PowerUiRune;->INCOMPATIBLE_CHARGER_CHECK:Z
 
-    if-eqz v0, :cond_1b
+    if-eqz v0, :cond_1a
 
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
@@ -996,52 +981,52 @@
 
     invoke-static {v0, v5}, Lcom/android/systemui/power/PowerUI;->-$$Nest$mcheckIncompatibleChargerConnection(Lcom/android/systemui/power/PowerUI;I)V
 
-    :cond_1b
+    :cond_1a
     sget-boolean v0, Lcom/android/systemui/PowerUiRune;->FULL_BATTERY_CHECK:Z
 
-    if-eqz v0, :cond_1c
+    if-eqz v0, :cond_1b
 
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
     invoke-static {v0, v4}, Lcom/android/systemui/power/PowerUI;->-$$Nest$mcheckFullBatteryStatus(Lcom/android/systemui/power/PowerUI;I)V
 
-    :cond_1c
+    :cond_1b
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
     invoke-static {v0, v2, v10, v11}, Lcom/android/systemui/power/PowerUI;->-$$Nest$msendLowBatteryDumpIfNeeded(Lcom/android/systemui/power/PowerUI;III)V
 
-    if-eqz v18, :cond_1d
+    if-eqz v18, :cond_1c
 
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
     invoke-static {v0, v13}, Lcom/android/systemui/power/PowerUI;->-$$Nest$mcheckHVchargerEnableConnection(Lcom/android/systemui/power/PowerUI;I)V
 
-    :cond_1d
+    :cond_1c
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
     invoke-static {v0, v3}, Lcom/android/systemui/power/PowerUI;->-$$Nest$mcheckAbnormalChargingPad(Lcom/android/systemui/power/PowerUI;I)V
 
     sget-boolean v0, Lcom/android/systemui/PowerUiRune;->TIPS_NOTIFICATION:Z
 
-    if-eqz v0, :cond_1e
+    if-eqz v0, :cond_1d
 
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
     invoke-static {v0, v2}, Lcom/android/systemui/power/PowerUI;->-$$Nest$mcheckTipsNotification(Lcom/android/systemui/power/PowerUI;I)V
 
-    :cond_1e
+    :cond_1d
     sget-boolean v0, Lcom/android/systemui/PowerUiRune;->CHN_SMART_MANAGER:Z
 
-    if-eqz v0, :cond_1f
+    if-eqz v0, :cond_1e
 
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
     invoke-static {v0, v2}, Lcom/android/systemui/power/PowerUI;->-$$Nest$mcheckTurnOffPsmNotification(Lcom/android/systemui/power/PowerUI;I)V
 
-    :cond_1f
+    :cond_1e
     sget-boolean v0, Lcom/android/systemui/PowerUiRune;->TURN_ON_PROTECT_BATTERY_BY_LONG_TERM_CHARGE:Z
 
-    if-eqz v0, :cond_20
+    if-eqz v0, :cond_1f
 
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
@@ -1049,16 +1034,16 @@
 
     goto :goto_c
 
-    :cond_20
+    :cond_1f
     sget-boolean v0, Lcom/android/systemui/PowerUiRune;->TURN_ON_PROTECT_BATTERY_BY_LONG_TERM_TA:Z
 
-    if-eqz v0, :cond_21
+    if-eqz v0, :cond_20
 
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
     invoke-static {v0}, Lcom/android/systemui/power/PowerUI;->-$$Nest$mcheckTurnOnProtectBatteryByLongTa(Lcom/android/systemui/power/PowerUI;)V
 
-    :cond_21
+    :cond_20
     :goto_c
     sget-boolean v0, Lcom/android/systemui/PowerUiRune;->BATTERY_PROTECTION_NOTIFICATION:Z
 
@@ -1070,14 +1055,14 @@
 
     goto/16 :goto_1b
 
-    :cond_22
+    :cond_21
     const-string v4, "android.intent.action.LOCALE_CHANGED"
 
     invoke-virtual {v4, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v4
 
-    if-eqz v4, :cond_28
+    if-eqz v4, :cond_27
 
     iget-object v0, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
@@ -1087,7 +1072,7 @@
 
     const-string v3, "PowerUI"
 
-    if-eqz v2, :cond_23
+    if-eqz v2, :cond_22
 
     invoke-virtual {v1}, Lcom/android/systemui/power/SecPowerNotificationWarnings;->updateNotification()V
 
@@ -1095,14 +1080,14 @@
 
     invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_23
+    :cond_22
     iget v2, v0, Lcom/android/systemui/power/PowerUI;->mBatteryChargingType:I
 
-    if-lez v2, :cond_24
+    if-lez v2, :cond_23
 
     iget v2, v0, Lcom/android/systemui/power/PowerUI;->mBatterySwellingMode:I
 
-    if-nez v2, :cond_24
+    if-nez v2, :cond_23
 
     const/4 v2, 0x0
 
@@ -1136,22 +1121,22 @@
 
     invoke-virtual {v1}, Lcom/android/systemui/power/SecPowerNotificationWarnings;->showChargingNotice()V
 
-    :cond_24
+    :cond_23
     sget-boolean v2, Lcom/android/systemui/PowerUiRune;->INCOMPATIBLE_CHARGER_CHECK:Z
 
-    if-eqz v2, :cond_26
+    if-eqz v2, :cond_25
 
     iget v2, v0, Lcom/android/systemui/power/PowerUI;->mBatteryOnline:I
 
-    if-nez v2, :cond_26
+    if-nez v2, :cond_25
 
     iget-object v2, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mIncompatibleChargerDialog:Landroidx/appcompat/app/AlertDialog;
 
-    if-eqz v2, :cond_25
+    if-eqz v2, :cond_24
 
     invoke-virtual {v2}, Landroidx/appcompat/app/AppCompatDialog;->dismiss()V
 
-    :cond_25
+    :cond_24
     const-string v2, "SecPowerUI.Notification"
 
     const-string v4, "dismissing incompatible charger notification"
@@ -1168,10 +1153,10 @@
 
     invoke-virtual {v1}, Lcom/android/systemui/power/SecPowerNotificationWarnings;->showIncompatibleChargerNotice()V
 
-    :cond_26
+    :cond_25
     sget-boolean v1, Lcom/android/systemui/PowerUiRune;->ADAPTIVE_PROTECTION_NOTIFICATION:Z
 
-    if-eqz v1, :cond_27
+    if-eqz v1, :cond_26
 
     iget-object v1, v0, Lcom/android/systemui/power/PowerUI;->mContext:Landroid/content/Context;
 
@@ -1179,7 +1164,7 @@
 
     move-result v1
 
-    if-eqz v1, :cond_27
+    if-eqz v1, :cond_26
 
     iget-object v1, v0, Lcom/android/systemui/power/PowerUI;->mSleepChargingEvent:Ljava/lang/String;
 
@@ -1187,7 +1172,7 @@
 
     invoke-virtual {v0, v1, v2}, Lcom/android/systemui/power/PowerUI;->checkAdaptiveProtectionNotification(Ljava/lang/String;Ljava/lang/String;)V
 
-    :cond_27
+    :cond_26
     sget-boolean v1, Lcom/android/systemui/PowerUiRune;->BATTERY_PROTECTION_NOTIFICATION:Z
 
     if-eqz v1, :cond_51
@@ -1196,7 +1181,7 @@
 
     goto/16 :goto_1b
 
-    :cond_28
+    :cond_27
     const-string v4, "com.samsung.server.BatteryService.action.SEC_BATTERY_EVENT"
 
     invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
@@ -1205,7 +1190,7 @@
 
     const/4 v5, 0x0
 
-    if-eqz v4, :cond_33
+    if-eqz v4, :cond_32
 
     iget-object v2, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
@@ -1223,13 +1208,13 @@
 
     and-int/2addr v4, v6
 
-    if-ne v4, v6, :cond_29
+    if-ne v4, v6, :cond_28
 
     const/4 v4, 0x1
 
     goto :goto_d
 
-    :cond_29
+    :cond_28
     const/4 v4, 0x0
 
     :goto_d
@@ -1251,9 +1236,9 @@
 
     iget-boolean v4, v2, Lcom/android/systemui/power/PowerUI;->mWirelessFodState:Z
 
-    if-eq v3, v4, :cond_2b
+    if-eq v3, v4, :cond_2a
 
-    if-eqz v4, :cond_2b
+    if-eqz v4, :cond_2a
 
     iget-object v2, v2, Lcom/android/systemui/power/PowerUI;->mSecPowerNotificationWarnings:Lcom/android/systemui/power/SecPowerNotificationWarnings;
 
@@ -1267,7 +1252,7 @@
 
     iget-object v3, v2, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWirelessFodAlertDialog:Landroidx/appcompat/app/AlertDialog;
 
-    if-nez v3, :cond_2b
+    if-nez v3, :cond_2a
 
     const/16 v3, 0xb
 
@@ -1277,11 +1262,11 @@
 
     iput-object v3, v2, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWirelessFodAlertDialog:Landroidx/appcompat/app/AlertDialog;
 
-    if-nez v3, :cond_2a
+    if-nez v3, :cond_29
 
     goto :goto_e
 
-    :cond_2a
+    :cond_29
     new-instance v4, Lcom/android/systemui/power/SecPowerNotificationWarnings$14;
 
     invoke-direct {v4, v2}, Lcom/android/systemui/power/SecPowerNotificationWarnings$14;-><init>(Lcom/android/systemui/power/SecPowerNotificationWarnings;)V
@@ -1292,7 +1277,7 @@
 
     invoke-virtual {v2}, Landroid/app/Dialog;->show()V
 
-    :cond_2b
+    :cond_2a
     :goto_e
     iget-object v2, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
@@ -1312,13 +1297,13 @@
 
     and-int/2addr v8, v9
 
-    if-ne v8, v9, :cond_2c
+    if-ne v8, v9, :cond_2b
 
     const/4 v8, 0x1
 
     goto :goto_f
 
-    :cond_2c
+    :cond_2b
     move v8, v7
 
     :goto_f
@@ -1332,13 +1317,13 @@
 
     and-int/2addr v6, v7
 
-    if-ne v6, v7, :cond_2d
+    if-ne v6, v7, :cond_2c
 
     const/4 v6, 0x1
 
     goto :goto_10
 
-    :cond_2d
+    :cond_2c
     const/4 v6, 0x0
 
     :goto_10
@@ -1376,9 +1361,9 @@
 
     iget-object v10, v2, Lcom/android/systemui/power/PowerUI;->mContext:Landroid/content/Context;
 
-    if-eq v4, v6, :cond_2e
+    if-eq v4, v6, :cond_2d
 
-    if-eqz v6, :cond_31
+    if-eqz v6, :cond_30
 
     iget-boolean v2, v2, Lcom/android/systemui/power/PowerUI;->mBatteryWaterConnector:Z
 
@@ -1396,12 +1381,12 @@
 
     goto :goto_11
 
-    :cond_2e
+    :cond_2d
     iget-boolean v2, v2, Lcom/android/systemui/power/PowerUI;->mBatteryWaterConnector:Z
 
-    if-eq v3, v2, :cond_31
+    if-eq v3, v2, :cond_30
 
-    if-eqz v2, :cond_2f
+    if-eqz v2, :cond_2e
 
     invoke-virtual {v7, v2}, Lcom/android/systemui/power/SecPowerNotificationWarnings;->showWaterProtectionAlertDialog(Z)V
 
@@ -1417,7 +1402,7 @@
 
     goto :goto_11
 
-    :cond_2f
+    :cond_2e
     const-string v3, "dismiss WaterProtectionAlertDialog - isWaterDetected = "
 
     const-string v4, " mIsWaterDetected = "
@@ -1442,20 +1427,20 @@
 
     iget-object v2, v7, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWaterProtectionPartialWakeLock:Landroid/os/PowerManager$WakeLock;
 
-    if-eqz v2, :cond_30
+    if-eqz v2, :cond_2f
 
     invoke-virtual {v2}, Landroid/os/PowerManager$WakeLock;->release()V
 
     iput-object v5, v7, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWaterProtectionPartialWakeLock:Landroid/os/PowerManager$WakeLock;
 
-    :cond_30
+    :cond_2f
     iget-object v2, v7, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWaterProtectionAlertDialog:Landroidx/appcompat/app/AlertDialog;
 
-    if-eqz v2, :cond_31
+    if-eqz v2, :cond_30
 
     invoke-virtual {v2}, Landroidx/appcompat/app/AppCompatDialog;->dismiss()V
 
-    :cond_31
+    :cond_30
     :goto_11
     iget-object v1, v1, Lcom/android/systemui/power/PowerUI$Receiver;->this$0:Lcom/android/systemui/power/PowerUI;
 
@@ -1473,13 +1458,13 @@
 
     and-int/2addr v0, v3
 
-    if-ne v0, v3, :cond_32
+    if-ne v0, v3, :cond_31
 
     const/4 v0, 0x1
 
     goto :goto_12
 
-    :cond_32
+    :cond_31
     const/4 v0, 0x0
 
     :goto_12
@@ -1523,7 +1508,7 @@
 
     goto/16 :goto_1b
 
-    :cond_33
+    :cond_32
     const-string v4, "com.samsung.intent.action.KSO_SHOW_POPUP"
 
     invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
@@ -1565,13 +1550,13 @@
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    if-eqz v3, :cond_34
+    if-eqz v3, :cond_33
 
     monitor-exit v1
 
     goto/16 :goto_1b
 
-    :cond_34
+    :cond_33
     :try_start_1
     const-string v3, "SecPowerUI.Notification"
 
@@ -1579,7 +1564,7 @@
 
     invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-eqz v0, :cond_35
+    if-eqz v0, :cond_34
 
     iget-object v3, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mPowerManager:Landroid/os/PowerManager;
 
@@ -1593,10 +1578,10 @@
 
     invoke-virtual {v3, v6, v7, v4, v8}, Landroid/os/PowerManager;->userActivity(JII)V
 
-    :cond_35
+    :cond_34
     iget-object v3, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLCDOnWindowLp:Landroid/view/WindowManager$LayoutParams;
 
-    if-nez v3, :cond_36
+    if-nez v3, :cond_35
 
     new-instance v3, Landroid/view/WindowManager$LayoutParams;
 
@@ -1616,10 +1601,10 @@
 
     iput-object v3, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLCDOnWindowLp:Landroid/view/WindowManager$LayoutParams;
 
-    :cond_36
+    :cond_35
     sget-boolean v3, Lcom/android/systemui/LsRune;->SUPPORT_LARGE_FRONT_SUB_DISPLAY:Z
 
-    if-eqz v3, :cond_37
+    if-eqz v3, :cond_36
 
     invoke-static {}, Lcom/samsung/android/view/SemWindowManager;->getInstance()Lcom/samsung/android/view/SemWindowManager;
 
@@ -1629,17 +1614,17 @@
 
     move-result v3
 
-    if-eqz v3, :cond_37
+    if-eqz v3, :cond_36
 
     const/4 v3, 0x1
 
     goto :goto_13
 
-    :cond_37
+    :cond_36
     const/4 v3, 0x0
 
     :goto_13
-    if-nez v3, :cond_38
+    if-nez v3, :cond_37
 
     iget-object v4, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLCDOnWindowLp:Landroid/view/WindowManager$LayoutParams;
 
@@ -1651,7 +1636,7 @@
 
     goto :goto_14
 
-    :cond_38
+    :cond_37
     iget-object v4, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLCDOnWindowLp:Landroid/view/WindowManager$LayoutParams;
 
     const/4 v6, 0x3
@@ -1673,7 +1658,7 @@
 
     iput v6, v4, Landroid/view/WindowManager$LayoutParams;->inputFeatures:I
 
-    if-nez v0, :cond_39
+    if-nez v0, :cond_38
 
     const-wide/16 v6, 0x2710
 
@@ -1685,7 +1670,7 @@
 
     invoke-virtual {v0, v6, v7}, Landroid/view/WindowManager$LayoutParams;->semSetScreenDimDuration(J)V
 
-    :cond_39
+    :cond_38
     iget-object v0, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLCDOnWindowLp:Landroid/view/WindowManager$LayoutParams;
 
     const-string v4, "UnintentionalLcdOn"
@@ -1694,13 +1679,13 @@
 
     iget-object v0, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWindowManager:Landroid/view/WindowManager;
 
-    if-eqz v0, :cond_3a
+    if-eqz v0, :cond_39
 
     iget-object v0, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLcdOnWindow:Lcom/android/systemui/power/UnintentionalLcdOnView;
 
-    if-nez v0, :cond_3c
+    if-nez v0, :cond_3b
 
-    :cond_3a
+    :cond_39
     const-string v0, "SecPowerUI.Notification"
 
     new-instance v4, Ljava/lang/StringBuilder;
@@ -1715,7 +1700,7 @@
 
     invoke-static {v0, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-eqz v3, :cond_3b
+    if-eqz v3, :cond_3a
 
     iget-object v0, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mContext:Landroid/content/Context;
 
@@ -1745,7 +1730,7 @@
 
     goto :goto_15
 
-    :cond_3b
+    :cond_3a
     iget-object v0, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mContext:Landroid/content/Context;
 
     const-string/jumbo v2, "window"
@@ -1787,6 +1772,23 @@
 
     iput-object v1, v0, Lcom/android/systemui/power/UnintentionalLcdOnView;->mTouchListener:Lcom/android/systemui/power/SecPowerNotificationWarnings;
 
+    :cond_3b
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v0, :cond_3c
+
+    const-class v0, Lcom/android/keyguard/KeyguardUpdateMonitor;
+
+    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v0
+
+    check-cast v0, Lcom/android/keyguard/KeyguardUpdateMonitor;
+
+    const/4 v2, 0x1
+
+    invoke-interface {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->setShowingKeepScreenOnPopup(Z)V
+
     :cond_3c
     const/4 v0, 0x1
 
@@ -2371,17 +2373,7 @@
 
     iget-object v0, v0, Lcom/android/systemui/power/PowerUI;->mSecPowerNotificationWarnings:Lcom/android/systemui/power/SecPowerNotificationWarnings;
 
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string v2, "SecPowerUI.Notification"
-
-    const-string/jumbo v4, "showSafeModeNotice()"
-
-    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 v2, 0x7
-
-    invoke-virtual {v0, v2}, Lcom/android/systemui/power/SecPowerNotificationWarnings;->showNotification(I)V
+    invoke-virtual {v0}, Lcom/android/systemui/power/SecPowerNotificationWarnings;->showSafeModeNotice()V
     :try_end_2
     .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0
 
diff --git a/smali/com/android/systemui/power/SecPowerNotificationWarnings.smali b/smali/com/android/systemui/power/SecPowerNotificationWarnings.smali
index 84f28017..389406fd 100644
--- a/smali/com/android/systemui/power/SecPowerNotificationWarnings.smali
+++ b/smali/com/android/systemui/power/SecPowerNotificationWarnings.smali
@@ -564,7 +564,7 @@
 .end method
 
 .method public final declared-synchronized dismissUnintentionalLcdOnWindow()V
-    .locals 3
+    .locals 4
 
     monitor-enter p0
 
@@ -583,39 +583,51 @@
 
     const/4 v1, 0x0
 
+    const/4 v2, 0x0
+
     if-eqz v0, :cond_1
 
-    iget-object v2, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWindowManager:Landroid/view/WindowManager;
+    iget-object v3, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWindowManager:Landroid/view/WindowManager;
 
-    invoke-interface {v2, v0}, Landroid/view/WindowManager;->removeView(Landroid/view/View;)V
+    invoke-interface {v3, v0}, Landroid/view/WindowManager;->removeView(Landroid/view/View;)V
 
     iget-object v0, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLcdOnWindow:Lcom/android/systemui/power/UnintentionalLcdOnView;
 
-    const/16 v2, 0x8
+    const/16 v3, 0x8
 
-    invoke-virtual {v0, v2}, Landroid/widget/LinearLayout;->setVisibility(I)V
+    invoke-virtual {v0, v3}, Landroid/widget/LinearLayout;->setVisibility(I)V
 
     iget-object v0, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLcdOnWindow:Lcom/android/systemui/power/UnintentionalLcdOnView;
 
-    iget-object v2, v0, Lcom/android/systemui/power/UnintentionalLcdOnView;->mTouchListener:Lcom/android/systemui/power/SecPowerNotificationWarnings;
+    iget-object v3, v0, Lcom/android/systemui/power/UnintentionalLcdOnView;->mTouchListener:Lcom/android/systemui/power/SecPowerNotificationWarnings;
 
-    if-ne v2, p0, :cond_0
+    if-ne v3, p0, :cond_0
 
-    iput-object v1, v0, Lcom/android/systemui/power/UnintentionalLcdOnView;->mTouchListener:Lcom/android/systemui/power/SecPowerNotificationWarnings;
+    iput-object v2, v0, Lcom/android/systemui/power/UnintentionalLcdOnView;->mTouchListener:Lcom/android/systemui/power/SecPowerNotificationWarnings;
 
     :cond_0
-    iput-object v1, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLcdOnWindow:Lcom/android/systemui/power/UnintentionalLcdOnView;
+    iput-object v2, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLcdOnWindow:Lcom/android/systemui/power/UnintentionalLcdOnView;
 
-    const/4 v0, 0x0
-
-    iput-boolean v0, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mIsUnintentionalPopupShowing:Z
+    iput-boolean v1, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mIsUnintentionalPopupShowing:Z
 
     :cond_1
-    iput-object v1, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWindowManager:Landroid/view/WindowManager;
+    iput-object v2, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWindowManager:Landroid/view/WindowManager;
+
+    iput-object v2, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLCDOnWindowLp:Landroid/view/WindowManager$LayoutParams;
+
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v0, :cond_2
+
+    const-class v0, Lcom/android/keyguard/KeyguardUpdateMonitor;
+
+    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v0
 
-    iput-object v1, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLCDOnWindowLp:Landroid/view/WindowManager$LayoutParams;
+    check-cast v0, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    invoke-interface {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->setShowingKeepScreenOnPopup(Z)V
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
@@ -1992,6 +2004,22 @@
     return-void
 .end method
 
+.method public final showSafeModeNotice()V
+    .locals 2
+
+    const-string v0, "SecPowerUI.Notification"
+
+    const-string/jumbo v1, "showSafeModeNotice()"
+
+    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v0, 0x7
+
+    invoke-virtual {p0, v0}, Lcom/android/systemui/power/SecPowerNotificationWarnings;->showNotification(I)V
+
+    return-void
+.end method
+
 .method public final showUsbDamageProtectionAlertDialog()V
     .locals 5
 
diff --git a/smali_classes2/com/android/systemui/shade/NotificationPanelViewController.smali b/smali_classes2/com/android/systemui/shade/NotificationPanelViewController.smali
index 0a3c44cb..edffa564 100644
--- a/smali_classes2/com/android/systemui/shade/NotificationPanelViewController.smali
+++ b/smali_classes2/com/android/systemui/shade/NotificationPanelViewController.smali
@@ -53,6 +53,8 @@
 
 .field public mBarState:I
 
+.field public mBioUnlockControllerLazy:Ldagger/Lazy;
+
 .field public mBlockingExpansionForCurrentTouch:Z
 
 .field public mBottomAreaShadeAlpha:F
@@ -10666,33 +10668,6 @@
     invoke-virtual {v2}, Landroid/widget/FrameLayout;->bringToFront()V
 
     :cond_9
-    sget-boolean v2, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_GUIDE_POPUP:Z
-
-    if-eqz v2, :cond_a
-
-    const v2, 0x7f0a0505
-
-    invoke-virtual {v1, v2}, Landroid/widget/FrameLayout;->findViewById(I)Landroid/view/View;
-
-    move-result-object v2
-
-    check-cast v2, Landroid/view/ViewStub;
-
-    const v3, 0x7f0d013d
-
-    invoke-virtual {v2, v3}, Landroid/view/ViewStub;->setLayoutResource(I)V
-
-    invoke-virtual {v2}, Landroid/view/ViewStub;->inflate()Landroid/view/View;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;
-
-    if-eqz v2, :cond_a
-
-    invoke-virtual {v2}, Landroid/widget/FrameLayout;->bringToFront()V
-
-    :cond_a
     iget-object v2, v0, Lcom/android/systemui/shade/NotificationPanelViewController;->mWakeUpCoordinator:Lcom/android/systemui/statusbar/notification/NotificationWakeUpCoordinator;
 
     iput-object v5, v2, Lcom/android/systemui/statusbar/notification/NotificationWakeUpCoordinator;->mStackScrollerController:Lcom/android/systemui/statusbar/notification/stack/NotificationStackScrollLayoutController;
@@ -10739,7 +10714,7 @@
 
     const/4 v3, 0x1
 
-    if-eqz v2, :cond_d
+    if-eqz v2, :cond_c
 
     new-instance v2, Lcom/android/systemui/shade/NotificationPanelViewController$8;
 
@@ -10779,11 +10754,11 @@
 
     iget-object v2, v4, Lcom/android/systemui/statusbar/phone/DcmMascotViewContainer;->injector:Lcom/android/systemui/shade/NotificationPanelViewController$8;
 
-    if-nez v2, :cond_b
+    if-nez v2, :cond_a
 
     const/4 v2, 0x0
 
-    :cond_b
+    :cond_a
     iget-object v2, v2, Lcom/android/systemui/shade/NotificationPanelViewController$8;->this$0:Lcom/android/systemui/shade/NotificationPanelViewController;
 
     iget-object v2, v2, Lcom/android/systemui/shade/NotificationPanelViewController;->mNotificationContainerParent:Lcom/android/systemui/shade/NotificationsQuickSettingsContainer;
@@ -10860,7 +10835,7 @@
 
     iget-boolean v2, v4, Lcom/android/systemui/statusbar/phone/DcmMascotViewContainer;->isBootCompleted:Z
 
-    if-eqz v2, :cond_c
+    if-eqz v2, :cond_b
 
     iget-object v2, v4, Lcom/android/systemui/statusbar/phone/DcmMascotViewContainer;->remoteViews:Landroid/widget/RemoteViews;
 
@@ -10868,7 +10843,7 @@
 
     goto :goto_3
 
-    :cond_c
+    :cond_b
     iput-boolean v3, v4, Lcom/android/systemui/statusbar/phone/DcmMascotViewContainer;->isWaitingForBootComplete:Z
 
     :goto_3
@@ -10886,14 +10861,14 @@
 
     invoke-virtual {v2, v4}, Lcom/android/keyguard/KeyguardUpdateMonitor;->registerCallback(Lcom/android/keyguard/KeyguardUpdateMonitorCallback;)V
 
-    :cond_d
+    :cond_c
     iget-boolean v2, v0, Lcom/android/systemui/shade/NotificationPanelViewController;->mSplitShadeEnabled:Z
 
-    if-eqz v2, :cond_e
+    if-eqz v2, :cond_d
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/shade/NotificationPanelViewController;->updateResources()V
 
-    :cond_e
+    :cond_d
     iget-object v2, v0, Lcom/android/systemui/shade/NotificationPanelViewController;->mTapAgainViewController:Lcom/android/systemui/statusbar/phone/TapAgainViewController;
 
     invoke-virtual {v2}, Lcom/android/systemui/util/ViewController;->init()V
@@ -11098,23 +11073,23 @@
 
     move-result v1
 
-    if-eqz v1, :cond_f
+    if-eqz v1, :cond_e
 
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
     move-result v1
 
-    if-nez v1, :cond_f
+    if-nez v1, :cond_e
 
     sget-boolean v1, Lcom/android/systemui/LsRune;->LOCKUI_SUB_DISPLAY_LOCK:Z
 
-    if-nez v1, :cond_f
+    if-nez v1, :cond_e
 
     move v9, v3
 
     goto :goto_4
 
-    :cond_f
+    :cond_e
     move v9, v6
 
     :goto_4
@@ -17319,7 +17294,7 @@
 .end method
 
 .method public final updateVisibility()V
-    .locals 7
+    .locals 8
 
     iget-boolean v0, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mHeadsUpAnimatingAway:Z
 
@@ -17351,7 +17326,9 @@
 
     iput v4, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
 
-    if-nez v0, :cond_8
+    const/4 v5, 0x4
+
+    if-nez v0, :cond_9
 
     iput v4, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
 
@@ -17366,36 +17343,36 @@
     :cond_2
     if-eqz v4, :cond_3
 
-    iget-boolean v5, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mBouncerShowing:Z
+    iget-boolean v6, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mBouncerShowing:Z
 
-    if-eqz v5, :cond_3
+    if-eqz v6, :cond_3
 
     iput v2, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
 
     move v4, v1
 
     :cond_3
-    sget-boolean v5, Lcom/android/systemui/LsRune;->KEYGUARD_SUB_DISPLAY_LOCK:Z
+    sget-boolean v6, Lcom/android/systemui/LsRune;->KEYGUARD_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v5, :cond_4
+    if-eqz v6, :cond_4
 
     if-eqz v4, :cond_4
 
-    const-class v5, Lcom/android/systemui/keyguard/KeyguardFoldController;
+    const-class v6, Lcom/android/systemui/keyguard/KeyguardFoldController;
 
-    invoke-static {v5}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+    invoke-static {v6}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v6
 
-    check-cast v5, Lcom/android/systemui/keyguard/KeyguardFoldController;
+    check-cast v6, Lcom/android/systemui/keyguard/KeyguardFoldController;
 
-    check-cast v5, Lcom/android/systemui/keyguard/KeyguardFoldControllerImpl;
+    check-cast v6, Lcom/android/systemui/keyguard/KeyguardFoldControllerImpl;
 
-    invoke-virtual {v5}, Lcom/android/systemui/keyguard/KeyguardFoldControllerImpl;->isUnlockOnFoldOpened()Z
+    invoke-virtual {v6}, Lcom/android/systemui/keyguard/KeyguardFoldControllerImpl;->isUnlockOnFoldOpened()Z
 
-    move-result v5
+    move-result v6
 
-    if-eqz v5, :cond_4
+    if-eqz v6, :cond_4
 
     const/4 v4, 0x2
 
@@ -17404,43 +17381,43 @@
     move v4, v1
 
     :cond_4
-    sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_SWIPE_BOUNCER:Z
+    sget-boolean v6, Lcom/android/systemui/LsRune;->SECURITY_SWIPE_BOUNCER:Z
 
-    if-eqz v5, :cond_6
+    if-eqz v6, :cond_6
 
     if-eqz v4, :cond_6
 
-    const-class v5, Lcom/android/systemui/statusbar/policy/KeyguardStateController;
+    const-class v6, Lcom/android/systemui/statusbar/policy/KeyguardStateController;
 
-    invoke-static {v5}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+    invoke-static {v6}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v6
 
-    check-cast v5, Lcom/android/systemui/statusbar/policy/KeyguardStateController;
+    check-cast v6, Lcom/android/systemui/statusbar/policy/KeyguardStateController;
 
-    check-cast v5, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;
+    check-cast v6, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;
 
-    iget-boolean v6, v5, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mIsSwipeBouncer:Z
+    iget-boolean v7, v6, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mIsSwipeBouncer:Z
 
-    if-eqz v6, :cond_5
+    if-eqz v7, :cond_5
 
-    iget-boolean v6, v5, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mCanDismissLockScreen:Z
+    iget-boolean v7, v6, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mCanDismissLockScreen:Z
 
-    if-eqz v6, :cond_5
+    if-eqz v7, :cond_5
 
-    iget-boolean v5, v5, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mShowing:Z
+    iget-boolean v6, v6, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mShowing:Z
 
-    if-eqz v5, :cond_5
+    if-eqz v6, :cond_5
 
-    move v5, v2
+    move v6, v2
 
     goto :goto_2
 
     :cond_5
-    move v5, v1
+    move v6, v1
 
     :goto_2
-    if-eqz v5, :cond_6
+    if-eqz v6, :cond_6
 
     const/4 v4, 0x3
 
@@ -17449,43 +17426,78 @@
     move v4, v1
 
     :cond_6
-    if-eqz v4, :cond_7
+    sget-boolean v6, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
-    goto :goto_3
+    if-eqz v6, :cond_7
+
+    invoke-virtual {p0}, Lcom/android/systemui/shade/NotificationPanelViewController;->isKeyguardShowing()Z
+
+    move-result v6
+
+    if-eqz v6, :cond_7
+
+    invoke-static {}, Lcom/android/systemui/wallpaper/WallpaperUtils;->isLiveWallpaperEnabled()Z
+
+    move-result v6
+
+    if-eqz v6, :cond_7
+
+    iget-object v6, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mBioUnlockControllerLazy:Ldagger/Lazy;
+
+    invoke-interface {v6}, Ldagger/Lazy;->get()Ljava/lang/Object;
+
+    move-result-object v6
+
+    check-cast v6, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;
+
+    invoke-virtual {v6}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->isWakeAndUnlock()Z
+
+    move-result v6
+
+    if-eqz v6, :cond_7
+
+    iput v5, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
+
+    move v4, v1
 
     :cond_7
+    if-eqz v4, :cond_8
+
+    goto :goto_3
+
+    :cond_8
     move v4, v1
 
     goto :goto_4
 
-    :cond_8
+    :cond_9
     :goto_3
     move v4, v2
 
     :goto_4
-    iget v5, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
+    iget v6, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
 
     iget-object p0, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mView:Lcom/android/systemui/shade/NotificationPanelView;
 
     invoke-virtual {p0}, Landroid/widget/FrameLayout;->getVisibility()I
 
-    move-result v6
+    move-result v7
 
-    if-nez v6, :cond_9
+    if-nez v7, :cond_a
 
     goto :goto_5
 
-    :cond_9
+    :cond_a
     move v2, v1
 
     :goto_5
-    if-ne v2, v4, :cond_a
+    if-ne v2, v4, :cond_b
 
-    if-nez v4, :cond_b
+    if-nez v4, :cond_c
 
-    if-eq v3, v5, :cond_b
+    if-eq v3, v6, :cond_c
 
-    :cond_a
+    :cond_b
     invoke-static {v4}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
     move-result-object v2
@@ -17494,7 +17506,7 @@
 
     move-result-object v0
 
-    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v3
 
@@ -17508,13 +17520,13 @@
 
     invoke-static {v2, v3, v0}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    :cond_b
-    if-eqz v4, :cond_c
+    :cond_c
+    if-eqz v4, :cond_d
 
     goto :goto_6
 
-    :cond_c
-    const/4 v1, 0x4
+    :cond_d
+    move v1, v5
 
     :goto_6
     invoke-virtual {p0, v1}, Landroid/widget/FrameLayout;->setVisibility(I)V
diff --git a/smali_classes2/com/android/systemui/shade/NotificationPanelViewController_Factory.smali b/smali_classes2/com/android/systemui/shade/NotificationPanelViewController_Factory.smali
index c7548dae..83575d30 100644
--- a/smali_classes2/com/android/systemui/shade/NotificationPanelViewController_Factory.smali
+++ b/smali_classes2/com/android/systemui/shade/NotificationPanelViewController_Factory.smali
@@ -2052,5 +2052,9 @@
 
     invoke-static {v0}, Ldagger/internal/DoubleCheck;->lazy(Ljavax/inject/Provider;)Ldagger/Lazy;
 
+    move-result-object v0
+
+    iput-object v0, v1, Lcom/android/systemui/shade/NotificationPanelViewController;->mBioUnlockControllerLazy:Ldagger/Lazy;
+
     return-object v1
 .end method
diff --git a/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$$ExternalSyntheticLambda1.smali b/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$$ExternalSyntheticLambda1.smali
index 9b9ad6d9..ba79f69d 100644
--- a/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$$ExternalSyntheticLambda1.smali
+++ b/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$$ExternalSyntheticLambda1.smali
@@ -24,77 +24,36 @@
 
 # virtual methods
 .method public final run()V
-    .locals 3
+    .locals 2
 
     iget-object p0, p0, Lcom/android/systemui/statusbar/KeyguardSecIndicationController$$ExternalSyntheticLambda1;->f$0:Lcom/android/systemui/statusbar/KeyguardSecIndicationController;
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
-    iget-object v1, p0, Lcom/android/systemui/statusbar/KeyguardIndicationController;->mContext:Landroid/content/Context;
+    if-eqz v0, :cond_0
 
-    if-eqz v0, :cond_3
-
-    invoke-virtual {v1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
-
-    move-result-object v0
-
-    iget-object v0, v0, Landroid/content/res/Configuration;->windowConfiguration:Landroid/app/WindowConfiguration;
-
-    invoke-virtual {v0}, Landroid/app/WindowConfiguration;->getRotation()I
-
-    move-result v0
-
-    const/4 v2, 0x1
-
-    if-eq v0, v2, :cond_2
-
-    const/4 v2, 0x2
-
-    if-eq v0, v2, :cond_1
-
-    const/4 v2, 0x3
-
-    if-eq v0, v2, :cond_0
-
-    const v0, 0x7f13086c
+    const v0, 0x7f130972
 
     goto :goto_0
 
     :cond_0
-    const v0, 0x7f13086e
-
-    goto :goto_0
-
-    :cond_1
-    const v0, 0x7f13086d
-
-    goto :goto_0
-
-    :cond_2
-    const v0, 0x7f13086f
-
-    goto :goto_0
-
-    :cond_3
     const/4 v0, 0x0
 
     :goto_0
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_1
+
+    iget-object v1, p0, Lcom/android/systemui/statusbar/KeyguardIndicationController;->mTopIndicationView:Lcom/android/systemui/statusbar/phone/KeyguardIndicationTextView;
 
-    iget-object p0, p0, Lcom/android/systemui/statusbar/KeyguardIndicationController;->mTopIndicationView:Lcom/android/systemui/statusbar/phone/KeyguardIndicationTextView;
+    iget-object p0, p0, Lcom/android/systemui/statusbar/KeyguardIndicationController;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v1, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
-    move-result-object v0
+    move-result-object p0
 
-    invoke-virtual {p0, v0}, Landroid/widget/TextView;->announceForAccessibility(Ljava/lang/CharSequence;)V
+    invoke-virtual {v1, p0}, Landroid/widget/TextView;->announceForAccessibility(Ljava/lang/CharSequence;)V
 
-    :cond_4
+    :cond_1
     return-void
 .end method
diff --git a/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$SecKeyguardCallback.smali b/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$SecKeyguardCallback.smali
index 224e5f63..c261f94f 100644
--- a/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$SecKeyguardCallback.smali
+++ b/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$SecKeyguardCallback.smali
@@ -280,7 +280,7 @@
 
     if-ne v0, v5, :cond_8
 
-    sput v3, Lcom/android/systemui/util/DeviceType;->supportInDisplayFingerprint:I
+    sput v4, Lcom/android/systemui/util/DeviceType;->supportInDisplayFingerprint:I
 
     :cond_8
     sget v0, Lcom/android/systemui/util/DeviceType;->supportInDisplayFingerprint:I
@@ -439,11 +439,11 @@
 
     const/4 v4, 0x2
 
-    if-ne v2, v4, :cond_13
+    if-ne v2, v4, :cond_12
 
     iget-boolean p3, p3, Lcom/android/keyguard/KeyguardUpdateMonitor;->mGoingToSleep:Z
 
-    if-nez p3, :cond_13
+    if-nez p3, :cond_12
 
     iget-object p3, v1, Lcom/android/systemui/statusbar/KeyguardIndicationController;->mContext:Landroid/content/Context;
 
@@ -559,11 +559,7 @@
 
     if-eqz p3, :cond_d
 
-    sget-boolean p3, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p3, :cond_d
-
-    if-eq p2, v4, :cond_12
+    sget-object p3, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_d
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
@@ -597,7 +593,7 @@
 
     if-ne p2, v8, :cond_f
 
-    sput v0, Lcom/android/systemui/util/DeviceType;->supportInDisplayFingerprint:I
+    sput v3, Lcom/android/systemui/util/DeviceType;->supportInDisplayFingerprint:I
 
     :cond_f
     sget p2, Lcom/android/systemui/util/DeviceType;->supportInDisplayFingerprint:I
@@ -625,9 +621,8 @@
 
     invoke-virtual {v1, p2}, Lcom/android/systemui/statusbar/KeyguardSecIndicationController;->showBounceAnimation(Lcom/android/systemui/statusbar/phone/KeyguardIndicationTextView;)V
 
-    :cond_12
     :goto_4
-    if-ne p1, v8, :cond_13
+    if-ne p1, v8, :cond_12
 
     iget-object p1, v1, Lcom/android/systemui/statusbar/KeyguardSecIndicationController;->mAccessibilityManager:Landroid/view/accessibility/AccessibilityManager;
 
@@ -635,13 +630,13 @@
 
     move-result p1
 
-    if-eqz p1, :cond_13
+    if-eqz p1, :cond_12
 
     invoke-interface {v9}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isMaxFailedBiometricUnlockAttemptsShort()Z
 
     move-result p1
 
-    if-nez p1, :cond_13
+    if-nez p1, :cond_12
 
     sget-object p1, Lcom/android/systemui/statusbar/IndicationEventType;->UNLOCK_GUIDE:Lcom/android/systemui/statusbar/IndicationEventType;
 
@@ -665,7 +660,7 @@
 
     invoke-virtual {p1, p2}, Lio/reactivex/Completable;->subscribe(Lio/reactivex/functions/Action;)V
 
-    :cond_13
+    :cond_12
     :goto_5
     iput v8, p0, Lcom/android/systemui/statusbar/KeyguardSecIndicationController$SecKeyguardCallback;->mLastSuccessiveErrorMessage:I
 
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/BiometricUnlockController.smali b/smali_classes2/com/android/systemui/statusbar/phone/BiometricUnlockController.smali
index ef95848a..38fc6b50 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/BiometricUnlockController.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/BiometricUnlockController.smali
@@ -850,9 +850,7 @@
     goto :goto_0
 
     :cond_2
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez v0, :cond_3
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     invoke-virtual {p0, v4}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->isUpdatePossible(Z)Z
 
@@ -1347,16 +1345,14 @@
     goto :goto_7
 
     :cond_b
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    const-string v6, "2"
-
-    if-nez v1, :cond_d
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     invoke-virtual {p0, v4}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->isUpdatePossible(Z)Z
 
     move-result v1
 
+    const-string v6, "2"
+
     if-eqz v1, :cond_d
 
     invoke-virtual {v0, v4}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isUnlockingWithBiometricAllowed(Z)Z
@@ -1521,9 +1517,7 @@
     goto :goto_0
 
     :cond_1
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez v0, :cond_2
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     invoke-virtual {p0, v2}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->isUpdatePossible(Z)Z
 
@@ -1607,7 +1601,7 @@
 .end method
 
 .method public final onBiometricHelp(ILjava/lang/String;Landroid/hardware/biometrics/BiometricSourceType;)V
-    .locals 2
+    .locals 3
 
     sget-object v0, Landroid/hardware/biometrics/BiometricSourceType;->FINGERPRINT:Landroid/hardware/biometrics/BiometricSourceType;
 
@@ -1629,119 +1623,121 @@
     return-void
 
     :cond_1
-    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
-    const/4 v0, 0x0
+    const/4 v1, -0x1
 
-    invoke-virtual {p0, p3, v0}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->vibrate(Landroid/hardware/biometrics/BiometricSourceType;Z)V
+    const/4 v2, 0x0
 
+    if-eqz v0, :cond_2
+
+    if-ne p1, v1, :cond_3
+
+    :cond_2
+    invoke-virtual {p0, p3, v2}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->vibrate(Landroid/hardware/biometrics/BiometricSourceType;Z)V
+
+    :cond_3
     const/4 p3, 0x1
 
-    iget-object v1, p0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mContext:Landroid/content/Context;
+    iget-object v0, p0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mContext:Landroid/content/Context;
 
-    if-eq p1, p3, :cond_8
+    if-eq p1, p3, :cond_a
 
     const/4 p3, 0x2
 
-    if-eq p1, p3, :cond_7
+    if-eq p1, p3, :cond_9
 
     const/4 p3, 0x3
 
-    if-eq p1, p3, :cond_6
+    if-eq p1, p3, :cond_8
 
     const/4 p3, 0x5
 
-    if-eq p1, p3, :cond_5
+    if-eq p1, p3, :cond_7
 
     const/16 p3, 0x3e9
 
-    if-eq p1, p3, :cond_4
+    if-eq p1, p3, :cond_6
 
     const/16 p3, 0x3eb
 
-    if-eq p1, p3, :cond_3
+    if-eq p1, p3, :cond_5
 
     const/16 p3, 0x3ec
 
-    if-eq p1, p3, :cond_2
+    if-eq p1, p3, :cond_4
 
     goto :goto_0
 
-    :cond_2
+    :cond_4
     const p2, 0x7f130847
 
-    invoke-virtual {v1, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+    invoke-virtual {v0, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
     move-result-object p2
 
     goto :goto_0
 
-    :cond_3
+    :cond_5
     const p2, 0x7f130843
 
-    invoke-virtual {v1, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+    invoke-virtual {v0, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
     move-result-object p2
 
     goto :goto_0
 
-    :cond_4
+    :cond_6
     const p2, 0x7f130846
 
-    invoke-virtual {v1, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+    invoke-virtual {v0, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
     move-result-object p2
 
     goto :goto_0
 
-    :cond_5
+    :cond_7
     const p2, 0x7f130845
 
-    invoke-virtual {v1, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+    invoke-virtual {v0, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
     move-result-object p2
 
     goto :goto_0
 
-    :cond_6
+    :cond_8
     const p2, 0x7f130841
 
-    invoke-virtual {v1, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+    invoke-virtual {v0, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
     move-result-object p2
 
     goto :goto_0
 
-    :cond_7
+    :cond_9
     const p2, 0x7f130842
 
-    invoke-virtual {v1, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+    invoke-virtual {v0, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
     move-result-object p2
 
     goto :goto_0
 
-    :cond_8
+    :cond_a
     const p2, 0x7f130844
 
-    invoke-virtual {v1, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+    invoke-virtual {v0, p2}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
     move-result-object p2
 
     :goto_0
-    sget-boolean p3, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez p3, :cond_9
-
-    invoke-virtual {p0, v0}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->isUpdatePossible(Z)Z
+    invoke-virtual {p0, v2}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->isUpdatePossible(Z)Z
 
     move-result p3
 
-    if-eqz p3, :cond_9
-
-    const/4 p3, -0x1
+    if-eqz p3, :cond_b
 
-    if-eq p1, p3, :cond_9
+    if-eq p1, v1, :cond_b
 
     iget-object p0, p0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mBiometricToastView:Lcom/android/keyguard/biometrics/KeyguardBiometricToastView;
 
@@ -1749,7 +1745,7 @@
 
     invoke-virtual {p0, p1, p2}, Lcom/android/keyguard/biometrics/KeyguardBiometricToastView;->update(Lcom/android/keyguard/biometrics/KeyguardBiometricToastView$ToastType;Ljava/lang/String;)V
 
-    :cond_9
+    :cond_b
     return-void
 .end method
 
@@ -2051,7 +2047,7 @@
 
     const/4 v10, 0x6
 
-    if-eqz v3, :cond_b
+    if-eqz v3, :cond_c
 
     iget v3, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
@@ -2133,9 +2129,9 @@
     goto :goto_1
 
     :cond_3
-    if-eqz v11, :cond_7
+    if-eqz v11, :cond_8
 
-    if-nez v12, :cond_7
+    if-nez v12, :cond_8
 
     if-eq v3, v6, :cond_5
 
@@ -2148,7 +2144,7 @@
     goto :goto_1
 
     :cond_4
-    if-nez v13, :cond_7
+    if-nez v13, :cond_8
 
     invoke-virtual {v1, v8}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->setWakeAndUnlock(Z)V
 
@@ -2161,13 +2157,24 @@
     goto :goto_1
 
     :cond_5
-    sget-object v14, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v14, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v14, :cond_6
 
+    iget-object v14, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->settingsHelper:Lcom/android/systemui/util/SettingsHelper;
+
+    invoke-virtual {v14}, Lcom/android/systemui/util/SettingsHelper;->isEnabledWof()Z
+
+    move-result v14
+
+    if-eqz v14, :cond_8
+
+    :cond_6
     invoke-virtual {v1, v6}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->setWakeAndUnlock(Z)V
 
     sget-boolean v14, Lcom/android/systemui/LsRune;->AOD_FULLSCREEN:Z
 
-    if-eqz v14, :cond_6
+    if-eqz v14, :cond_7
 
     iget-object v14, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->settingsHelper:Lcom/android/systemui/util/SettingsHelper;
 
@@ -2175,7 +2182,7 @@
 
     move-result v14
 
-    if-eqz v14, :cond_6
+    if-eqz v14, :cond_7
 
     iget-object v14, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->aodAmbientWallpaperHelper:Lcom/android/systemui/aod/AODAmbientWallpaperHelper;
 
@@ -2183,7 +2190,7 @@
 
     move-result v14
 
-    if-eqz v14, :cond_6
+    if-eqz v14, :cond_7
 
     iget-object v14, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->surfaceVisibilityController:Lcom/android/systemui/keyguard/SurfaceVisibilityController;
 
@@ -2193,7 +2200,7 @@
 
     goto :goto_1
 
-    :cond_6
+    :cond_7
     iget-object v14, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->windowVisibilityController:Lcom/android/systemui/keyguard/WindowVisibilityController;
 
     iput-object v14, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->curVisibilityController:Lcom/android/systemui/keyguard/VisibilityController;
@@ -2202,11 +2209,11 @@
 
     iput-boolean v14, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->needsBlankScreen:Z
 
-    :cond_7
+    :cond_8
     :goto_1
     iget-object v14, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->curVisibilityController:Lcom/android/systemui/keyguard/VisibilityController;
 
-    if-eqz v14, :cond_8
+    if-eqz v14, :cond_9
 
     invoke-virtual {v14}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -2224,18 +2231,18 @@
 
     invoke-static {v14}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->logD(Ljava/lang/String;)V
 
-    :cond_8
+    :cond_9
     invoke-virtual {v1}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->isFastWakeAndUnlockMode()Z
 
     move-result v14
 
-    if-nez v14, :cond_9
+    if-nez v14, :cond_a
 
     invoke-virtual {v1}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->isFastUnlockMode()Z
 
     move-result v15
 
-    if-nez v15, :cond_9
+    if-nez v15, :cond_a
 
     const-string v14, "not supported mode="
 
@@ -2265,20 +2272,20 @@
 
     goto :goto_3
 
-    :cond_9
+    :cond_a
     iget-boolean v3, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->isInvisibleAfterGoingAwayTransStarted:Z
 
-    if-eqz v14, :cond_a
+    if-eqz v14, :cond_b
 
     iget-boolean v9, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->needsBlankScreen:Z
 
-    if-eqz v9, :cond_a
+    if-eqz v9, :cond_b
 
     move v9, v6
 
     goto :goto_2
 
-    :cond_a
+    :cond_b
     move v9, v8
 
     :goto_2
@@ -2309,7 +2316,7 @@
     :goto_3
     iget-boolean v3, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->isBrightnessChangedCallbackRegistered:Z
 
-    if-eqz v3, :cond_b
+    if-eqz v3, :cond_c
 
     const-string v3, "unregisterBrightnessListener"
 
@@ -2325,10 +2332,10 @@
 
     iput-boolean v8, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->isBrightnessChangedCallbackRegistered:Z
 
-    :cond_b
+    :cond_c
     iget v3, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
-    if-ne v3, v10, :cond_c
+    if-ne v3, v10, :cond_d
 
     iget-object v3, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mPowerManager:Landroid/os/PowerManager;
 
@@ -2336,48 +2343,48 @@
 
     move-result v3
 
-    if-eqz v3, :cond_c
+    if-eqz v3, :cond_d
 
     move v3, v6
 
     goto :goto_4
 
-    :cond_c
+    :cond_d
     move v3, v8
 
     :goto_4
     iget v9, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
-    if-eqz v9, :cond_d
+    if-eqz v9, :cond_e
 
-    if-nez v3, :cond_d
+    if-nez v3, :cond_e
 
     invoke-virtual {v7}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController$$ExternalSyntheticLambda0;->run()V
 
-    :cond_d
+    :cond_e
     iget v7, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
-    if-eq v7, v6, :cond_13
+    if-eq v7, v6, :cond_14
 
-    if-eq v7, v5, :cond_13
+    if-eq v7, v5, :cond_14
 
     const/4 v9, 0x3
 
-    if-eq v7, v9, :cond_12
+    if-eq v7, v9, :cond_13
 
     const/4 v9, 0x5
 
-    if-eq v7, v9, :cond_f
+    if-eq v7, v9, :cond_10
 
-    if-eq v7, v10, :cond_13
+    if-eq v7, v10, :cond_14
 
     const/4 v2, 0x7
 
-    if-eq v7, v2, :cond_e
+    if-eq v7, v2, :cond_f
 
     goto/16 :goto_6
 
-    :cond_e
+    :cond_f
     const-string v2, "MODE_DISMISS_BOUNCER"
 
     invoke-static {v2}, Landroid/os/Trace;->beginSection(Ljava/lang/String;)V
@@ -2390,7 +2397,7 @@
 
     goto/16 :goto_6
 
-    :cond_f
+    :cond_10
     const-string v3, "MODE_UNLOCK_COLLAPSING"
 
     invoke-static {v3}, Landroid/os/Trace;->beginSection(Ljava/lang/String;)V
@@ -2399,17 +2406,17 @@
 
     move-result v2
 
-    if-eqz v2, :cond_11
+    if-eqz v2, :cond_12
 
     iget-boolean v2, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mBouncer:Z
 
-    if-nez v2, :cond_10
+    if-nez v2, :cond_11
 
     iget-object v2, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mAuthenticatedBioSourceType:Landroid/hardware/biometrics/BiometricSourceType;
 
     sget-object v3, Landroid/hardware/biometrics/BiometricSourceType;->FACE:Landroid/hardware/biometrics/BiometricSourceType;
 
-    if-ne v2, v3, :cond_10
+    if-ne v2, v3, :cond_11
 
     iget-object v2, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mKeyguardBypassController:Lcom/android/systemui/statusbar/phone/KeyguardBypassController;
 
@@ -2417,25 +2424,25 @@
 
     move-result v2
 
-    if-eqz v2, :cond_10
+    if-eqz v2, :cond_11
 
     invoke-static {}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->isLargeCoverScreen()Z
 
     move-result v2
 
-    if-eqz v2, :cond_11
+    if-eqz v2, :cond_12
 
-    :cond_10
+    :cond_11
     iget-object v2, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mKeyguardViewController:Lcom/android/keyguard/KeyguardViewController;
 
     invoke-interface {v2, v8}, Lcom/android/keyguard/KeyguardViewController;->notifyKeyguardAuthenticated(Z)V
 
-    :cond_11
+    :cond_12
     invoke-static {}, Landroid/os/Trace;->endSection()V
 
     goto :goto_6
 
-    :cond_12
+    :cond_13
     const-string v2, "MODE_SHOW_BOUNCER"
 
     invoke-static {v2}, Landroid/os/Trace;->beginSection(Ljava/lang/String;)V
@@ -2448,8 +2455,8 @@
 
     goto :goto_6
 
-    :cond_13
-    if-ne v7, v5, :cond_14
+    :cond_14
+    if-ne v7, v5, :cond_15
 
     const-string v2, "MODE_WAKE_AND_UNLOCK_PULSING"
 
@@ -2461,8 +2468,8 @@
 
     goto :goto_5
 
-    :cond_14
-    if-ne v7, v6, :cond_15
+    :cond_15
+    if-ne v7, v6, :cond_16
 
     const-string v2, "MODE_WAKE_AND_UNLOCK"
 
@@ -2470,7 +2477,7 @@
 
     goto :goto_5
 
-    :cond_15
+    :cond_16
     const-string v2, "MODE_WAKE_AND_UNLOCK_FROM_DREAM"
 
     invoke-static {v2}, Landroid/os/Trace;->beginSection(Ljava/lang/String;)V
@@ -2480,19 +2487,19 @@
 
     move-result v2
 
-    if-eqz v2, :cond_16
+    if-eqz v2, :cond_17
 
     iget-boolean v2, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->isInvisibleAfterGoingAwayTransStarted:Z
 
-    if-nez v2, :cond_16
+    if-nez v2, :cond_17
 
     iget-boolean v2, v1, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->needsBlankScreen:Z
 
-    if-nez v2, :cond_16
+    if-nez v2, :cond_17
 
     invoke-virtual {v1, v8}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->setForceInvisible(Z)V
 
-    :cond_16
+    :cond_17
     check-cast v4, Lcom/android/systemui/shade/NotificationShadeWindowControllerImpl;
 
     invoke-virtual {v4, v8}, Lcom/android/systemui/shade/NotificationShadeWindowControllerImpl;->setNotificationShadeFocusable(Z)V
@@ -2508,7 +2515,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_17
+    if-eqz v2, :cond_18
 
     iget v2, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
@@ -2524,13 +2531,13 @@
 
     move-result v2
 
-    if-nez v2, :cond_18
+    if-nez v2, :cond_19
 
     invoke-interface {v0, v3}, Ljava/util/List;->add(Ljava/lang/Object;)Z
 
     goto :goto_8
 
-    :cond_17
+    :cond_18
     iget v2, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
     iget-object v0, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mBiometricUnlockEventsListeners:Ljava/util/Set;
@@ -2546,7 +2553,7 @@
 
     move-result v3
 
-    if-eqz v3, :cond_18
+    if-eqz v3, :cond_19
 
     invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -2558,7 +2565,7 @@
 
     goto :goto_7
 
-    :cond_18
+    :cond_19
     :goto_8
     const-string v0, "startWakeAndUnlock end"
 
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl$21.smali b/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl$21.smali
index 32b9328c..feb085b8 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl$21.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl$21.smali
@@ -36,30 +36,15 @@
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    iget-object p1, p0, Lcom/android/systemui/statusbar/phone/CentralSurfacesImpl;->mToolTipWindow:Lcom/android/systemui/qs/buttons/QSTooltipWindow;
+    iget-object p0, p0, Lcom/android/systemui/statusbar/phone/CentralSurfacesImpl;->mToolTipWindow:Lcom/android/systemui/qs/buttons/QSTooltipWindow;
 
-    if-eqz p1, :cond_0
+    if-eqz p0, :cond_0
 
-    invoke-virtual {p1}, Lcom/android/systemui/qs/buttons/QSTooltipWindow;->hideToolTip()V
+    invoke-virtual {p0}, Lcom/android/systemui/qs/buttons/QSTooltipWindow;->hideToolTip()V
 
     :cond_0
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_1
-
-    iget-object p0, p0, Lcom/android/systemui/statusbar/phone/CentralSurfacesImpl;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    move-result-object p0
-
-    invoke-virtual {p0}, Landroid/content/res/Resources;->getDisplayMetrics()Landroid/util/DisplayMetrics;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/systemui/util/DeviceState;->setInDisplayFingerprintSensorPosition(Landroid/util/DisplayMetrics;)V
-
-    :cond_1
     return-void
 .end method
 
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl.smali b/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl.smali
index ce96c971..aaf66d5d 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl.smali
@@ -9849,23 +9849,6 @@
     sput v12, Lcom/android/systemui/util/DeviceState;->ROTATION_270:I
 
     :cond_33
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v1, :cond_34
-
-    iget-object v1, v9, Lcom/android/systemui/statusbar/phone/CentralSurfacesImpl;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Landroid/content/res/Resources;->getDisplayMetrics()Landroid/util/DisplayMetrics;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/android/systemui/util/DeviceState;->setInDisplayFingerprintSensorPosition(Landroid/util/DisplayMetrics;)V
-
-    :cond_34
     invoke-static {}, Landroid/os/Trace;->endSection()V
 
     iget-object v1, v9, Lcom/android/systemui/statusbar/phone/CentralSurfacesImpl;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
@@ -9934,7 +9917,7 @@
 
     iget-boolean v0, v3, Lcom/android/systemui/InitController;->mTasksExecuted:Z
 
-    if-nez v0, :cond_35
+    if-nez v0, :cond_34
 
     iget-object v0, v3, Lcom/android/systemui/InitController;->mTasks:Ljava/util/ArrayList;
 
@@ -10010,7 +9993,7 @@
 
     return-void
 
-    :cond_35
+    :cond_34
     new-instance v0, Ljava/lang/IllegalStateException;
 
     const-string v1, "post init tasks have already been executed!"
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaView.smali b/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaView.smali
index 47671521..da84b623 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaView.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaView.smali
@@ -1030,9 +1030,7 @@
 
     if-nez v9, :cond_d
 
-    sget v7, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    iput v7, p1, Lcom/android/systemui/keyguard/ui/binder/KeyguardSecBottomAreaViewBinder$ConfigurationBasedDimensions;->upperFPIndicationBottomMargin:I
+    iput v5, p1, Lcom/android/systemui/keyguard/ui/binder/KeyguardSecBottomAreaViewBinder$ConfigurationBasedDimensions;->upperFPIndicationBottomMargin:I
 
     iget-object v7, p0, Lcom/android/systemui/statusbar/phone/KeyguardSecBottomAreaView;->upperFPIndication$delegate:Lkotlin/Lazy;
 
@@ -1263,67 +1261,9 @@
     iput v2, p1, Lcom/android/systemui/keyguard/ui/binder/KeyguardSecBottomAreaViewBinder$ConfigurationBasedDimensions;->indicationAreaSideMargin:I
 
     :cond_19
-    sget-boolean v2, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v2, :cond_1b
-
-    const-class v2, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-static {v2}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_1b
-
-    invoke-virtual {p0}, Landroid/widget/FrameLayout;->getDisplay()Landroid/view/Display;
-
-    move-result-object v2
-
-    invoke-virtual {v2}, Landroid/view/Display;->getRotation()I
-
-    move-result v2
-
-    if-eqz v2, :cond_1a
-
-    invoke-virtual {p0}, Landroid/widget/FrameLayout;->getDisplay()Landroid/view/Display;
-
-    move-result-object v2
-
-    invoke-virtual {v2}, Landroid/view/Display;->getRotation()I
-
-    move-result v2
-
-    if-ne v2, v11, :cond_1b
-
-    :cond_1a
-    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
-
-    move-result v2
-
-    if-nez v2, :cond_1b
-
-    sget v2, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    const v3, 0x7f07044a
-
-    invoke-virtual {v0, v3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v3
-
-    add-int/2addr v3, v2
-
-    iput v3, p1, Lcom/android/systemui/keyguard/ui/binder/KeyguardSecBottomAreaViewBinder$ConfigurationBasedDimensions;->indicationAreaBottomMargin:I
-
-    :cond_1b
     iget-object v2, p0, Lcom/android/systemui/statusbar/phone/KeyguardBottomAreaView;->pluginLockData:Lcom/android/systemui/pluginlock/PluginLockData;
 
-    if-eqz v2, :cond_1e
+    if-eqz v2, :cond_1c
 
     check-cast v2, Lcom/android/systemui/pluginlock/PluginLockDataImpl;
 
@@ -1331,7 +1271,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_1e
+    if-eqz v2, :cond_1c
 
     iget v2, p1, Lcom/android/systemui/keyguard/ui/binder/KeyguardSecBottomAreaViewBinder$ConfigurationBasedDimensions;->indicationAreaBottomMargin:I
 
@@ -1349,18 +1289,18 @@
 
     iget-object v3, v2, Lcom/android/systemui/pluginlock/PluginLockDataImpl;->mData:Lcom/android/systemui/pluginlock/model/DynamicLockData;
 
-    if-nez v3, :cond_1c
+    if-nez v3, :cond_1a
 
     const/4 v2, -0x1
 
     goto :goto_b
 
-    :cond_1c
+    :cond_1a
     invoke-virtual {v2}, Lcom/android/systemui/pluginlock/PluginLockDataImpl;->isLandscape()Z
 
     move-result v3
 
-    if-eqz v3, :cond_1d
+    if-eqz v3, :cond_1b
 
     iget-object v2, v2, Lcom/android/systemui/pluginlock/PluginLockDataImpl;->mData:Lcom/android/systemui/pluginlock/model/DynamicLockData;
 
@@ -1382,7 +1322,7 @@
 
     goto :goto_b
 
-    :cond_1d
+    :cond_1b
     iget-object v2, v2, Lcom/android/systemui/pluginlock/PluginLockDataImpl;->mData:Lcom/android/systemui/pluginlock/model/DynamicLockData;
 
     invoke-virtual {v2}, Lcom/android/systemui/pluginlock/model/DynamicLockData;->getIndicationData()Lcom/android/systemui/pluginlock/model/IndicationData;
@@ -1404,10 +1344,10 @@
     :goto_b
     iput v2, p1, Lcom/android/systemui/keyguard/ui/binder/KeyguardSecBottomAreaViewBinder$ConfigurationBasedDimensions;->indicationAreaBottomMargin:I
 
-    :cond_1e
+    :cond_1c
     sget-boolean v2, Lcom/android/systemui/LsRune;->LOCKUI_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v2, :cond_1f
+    if-eqz v2, :cond_1d
 
     const-class v2, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
@@ -1419,9 +1359,9 @@
 
     iget-boolean v2, v2, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
 
-    if-eqz v2, :cond_1f
+    if-eqz v2, :cond_1d
 
-    if-ne v1, v11, :cond_1f
+    if-ne v1, v11, :cond_1d
 
     const v1, 0x7f07048c
 
@@ -1431,14 +1371,14 @@
 
     goto :goto_d
 
-    :cond_1f
-    if-ne v1, v6, :cond_20
+    :cond_1d
+    if-ne v1, v6, :cond_1e
 
     const v1, 0x7f07048a
 
     goto :goto_c
 
-    :cond_20
+    :cond_1e
     const v1, 0x7f07048b
 
     :goto_c
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController.smali b/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController.smali
index 6278b112..fa41c2d5 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController.smali
@@ -1262,53 +1262,8 @@
 
     invoke-virtual {v0, v3, v1}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
 
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-eqz v1, :cond_8
-
-    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Landroid/content/res/Resources;->getDisplayMetrics()Landroid/util/DisplayMetrics;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/android/systemui/util/DeviceState;->setInDisplayFingerprintSensorPosition(Landroid/util/DisplayMetrics;)V
-
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    const-string v3, "finger_print_height"
-
-    invoke-virtual {v0, v3, v1}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintImageSize:I
-
-    const-string v3, "finger_print_image_size"
-
-    invoke-virtual {v0, v3, v1}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintMarginBottom:I
-
-    const-string v3, "finger_print_margin"
-
-    invoke-virtual {v0, v3, v1}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    iget-object v1, p0, Lcom/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v1
-
-    const-string v3, "finger_print_enabled"
-
-    invoke-virtual {v0, v3, v1}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    :cond_8
     sget-object v1, Lcom/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController;->KEY_HELP_TEXT_VISIBILITY:Ljava/lang/String;
 
     invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
@@ -1333,18 +1288,18 @@
 
     move-result-object v1
 
-    if-nez v1, :cond_9
+    if-nez v1, :cond_8
 
     const/4 p0, -0x1
 
     goto :goto_6
 
-    :cond_9
+    :cond_8
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
     move-result-object p0
 
-    if-eqz p1, :cond_a
+    if-eqz p1, :cond_9
 
     const p1, 0x7f070433
 
@@ -1354,7 +1309,7 @@
 
     goto :goto_6
 
-    :cond_a
+    :cond_9
     const p1, 0x7f070432
 
     invoke-virtual {p0, p1}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager$1.smali b/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager$1.smali
index 38de3c37..56332a99 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager$1.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager$1.smali
@@ -25,25 +25,11 @@
 
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
-    move-result p2
+    move-result p0
 
-    if-eqz p2, :cond_0
+    if-eqz p0, :cond_0
 
-    sget-boolean p2, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p2, :cond_0
-
-    sget-object p2, Landroid/hardware/biometrics/BiometricSourceType;->FINGERPRINT:Landroid/hardware/biometrics/BiometricSourceType;
-
-    invoke-virtual {p1, p2}, Landroid/hardware/biometrics/BiometricSourceType;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    iget-object p0, p0, Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager$1;->this$0:Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager;
-
-    invoke-virtual {p0}, Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager;->updateLockContainerMargin()V
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_0
     return-void
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager.smali b/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager.smali
index 1f023e87..1972dbbd 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager.smali
@@ -2674,7 +2674,7 @@
 
     if-nez v2, :cond_0
 
-    goto/16 :goto_6
+    goto/16 :goto_5
 
     :cond_0
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
@@ -2691,7 +2691,7 @@
 
     iget-object v7, p0, Lcom/android/systemui/statusbar/phone/StatusBarKeyguardViewManager;->mContext:Landroid/content/Context;
 
-    if-eqz v2, :cond_7
+    if-eqz v2, :cond_5
 
     invoke-virtual {v7}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
@@ -2721,16 +2721,16 @@
 
     invoke-virtual {v2, v8}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v1
+    move-result v0
 
-    iput v1, v7, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
+    iput v0, v7, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
 
     goto :goto_2
 
     :cond_1
     invoke-virtual {v2, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v8
+    move-result v6
 
     if-eq v0, v4, :cond_3
 
@@ -2753,47 +2753,20 @@
     move-result v1
 
     :goto_1
-    add-int/2addr v8, v1
+    add-int/2addr v6, v1
 
-    iput v8, v7, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
+    iput v6, v7, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
 
     :goto_2
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v1, :cond_6
-
-    const/4 v1, 0x2
-
-    if-ne v0, v1, :cond_6
-
-    iget-object v0, p0, Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager;->mKeyguardUpdateManager:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_5
-
-    sget v0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    goto :goto_3
-
-    :cond_5
-    invoke-virtual {v2, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    move-result v0
-
-    :goto_3
-    iput v0, v7, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
-
-    :cond_6
     iget-object p0, p0, Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager;->mLockIconContainer:Landroid/view/ViewGroup;
 
     invoke-virtual {p0, v7}, Landroid/view/ViewGroup;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    goto :goto_6
+    goto :goto_5
 
-    :cond_7
+    :cond_5
     iget-object v2, p0, Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager;->mLockIconContainer:Landroid/view/ViewGroup;
 
     invoke-virtual {v2}, Landroid/view/ViewGroup;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
@@ -2810,22 +2783,22 @@
 
     move-result v6
 
-    if-eq v0, v4, :cond_9
+    if-eq v0, v4, :cond_7
 
-    if-ne v0, v3, :cond_8
+    if-ne v0, v3, :cond_6
 
-    goto :goto_4
+    goto :goto_3
 
-    :cond_8
+    :cond_6
     move v4, v1
 
-    :cond_9
-    :goto_4
-    if-eqz v4, :cond_a
+    :cond_7
+    :goto_3
+    if-eqz v4, :cond_8
 
-    goto :goto_5
+    goto :goto_4
 
-    :cond_a
+    :cond_8
     invoke-virtual {v7}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
     move-result-object v0
@@ -2834,7 +2807,7 @@
 
     move-result v1
 
-    :goto_5
+    :goto_4
     add-int/2addr v6, v1
 
     iput v6, v2, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
@@ -2843,7 +2816,7 @@
 
     invoke-virtual {p0, v2}, Landroid/view/ViewGroup;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    :goto_6
+    :goto_5
     return-void
 .end method
 
diff --git a/smali_classes2/com/android/systemui/tv/DaggerTvGlobalRootComponent$CentralSurfacesComponentImpl.smali b/smali_classes2/com/android/systemui/tv/DaggerTvGlobalRootComponent$CentralSurfacesComponentImpl.smali
index 302a7199..0b3e4926 100644
--- a/smali_classes2/com/android/systemui/tv/DaggerTvGlobalRootComponent$CentralSurfacesComponentImpl.smali
+++ b/smali_classes2/com/android/systemui/tv/DaggerTvGlobalRootComponent$CentralSurfacesComponentImpl.smali
@@ -2054,7 +2054,9 @@
 
     invoke-static {p0}, Ldagger/internal/DoubleCheck;->lazy(Ljavax/inject/Provider;)Ldagger/Lazy;
 
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result-object p0
+
+    iput-object p0, p1, Lcom/android/systemui/shade/NotificationPanelViewController;->mBioUnlockControllerLazy:Ldagger/Lazy;
 
     return-object p1
 .end method
diff --git a/smali_classes2/com/android/systemui/util/DeviceState.smali b/smali_classes2/com/android/systemui/util/DeviceState.smali
index 1ad83983..7636e344 100644
--- a/smali_classes2/com/android/systemui/util/DeviceState.smali
+++ b/smali_classes2/com/android/systemui/util/DeviceState.smali
@@ -6,40 +6,26 @@
 # static fields
 .field public static final IS_ALREADY_BOOTED:Z
 
-.field public static QUICKBOARD_AVAILABLE_CHECKED:Z = false
+.field public static QUICKBOARD_AVAILABLE_CHECKED:Z
 
-.field public static ROTATION_0:I = 0x0
+.field public static ROTATION_0:I
 
-.field public static ROTATION_180:I = 0x0
+.field public static ROTATION_180:I
 
-.field public static ROTATION_270:I = 0x0
+.field public static ROTATION_270:I
 
-.field public static ROTATION_90:I = 0x0
+.field public static ROTATION_90:I
 
-.field public static mQuickboardAvailable:Z = false
+.field public static mQuickboardAvailable:Z
 
-.field public static sDisplaySize:Landroid/graphics/Point; = null
+.field public static sDisplaySize:Landroid/graphics/Point;
 
-.field public static sInDisplayFingerprintHeight:I = 0x0
+.field public static sOldScreenLayout:I
 
-.field public static sInDisplayFingerprintImageSize:I = 0x0
-
-.field public static sInDisplayFingerprintMarginBottom:I = 0x0
-
-.field public static sLoadedSensorValue:Z = false
-
-.field public static sOldScreenLayout:I = 0x0
-
-.field public static sOldScreenWidthDp:I = 0x0
+.field public static sOldScreenWidthDp:I
 
 .field public static final sPhoneCount:I
 
-.field public static sSemSensorAreaHeight:Ljava/lang/String; = "4"
-
-.field public static sSemSensorImageSize:Ljava/lang/String; = "10.80"
-
-.field public static sSemSensorMarginBottom:Ljava/lang/String; = "13.77"
-
 .field public static final sSizePoint:Landroid/graphics/Point;
 
 
@@ -863,7 +849,7 @@
 .end method
 
 .method public static isInDisplayFpSensorPositionHigh()Z
-    .locals 2
+    .locals 3
 
     const-class v0, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
@@ -887,27 +873,22 @@
 
     int-to-float v0, v0
 
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    const/4 v1, 0x0
 
-    int-to-float v1, v1
+    int-to-float v2, v1
 
-    div-float/2addr v1, v0
+    div-float/2addr v2, v0
 
     const v0, 0x3e6147ae    # 0.22f
 
-    cmpl-float v0, v1, v0
+    cmpl-float v0, v2, v0
 
     if-lez v0, :cond_0
 
-    const/4 v0, 0x1
-
-    goto :goto_0
+    const/4 v1, 0x1
 
     :cond_0
-    const/4 v0, 0x0
-
-    :goto_0
-    return v0
+    return v1
 .end method
 
 .method public static isMediaQuickControlBarAvailable(Landroid/content/Context;)Z
@@ -1069,169 +1050,6 @@
     return v1
 .end method
 
-.method public static isSmartViewDisplayWithFitToAspectRatio(Landroid/content/Context;)Z
-    .locals 6
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez v0, :cond_0
-
-    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isSmartViewFitToActiveDisplay()Z
-
-    move-result p0
-
-    return p0
-
-    :cond_0
-    const-string v0, "display"
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/hardware/display/DisplayManager;
-
-    invoke-virtual {v0}, Landroid/hardware/display/DisplayManager;->semGetWifiDisplayStatus()Landroid/hardware/display/SemWifiDisplayStatus;
-
-    move-result-object v0
-
-    const/4 v1, 0x1
-
-    const/4 v2, 0x0
-
-    if-eqz v0, :cond_1
-
-    invoke-virtual {v0}, Landroid/hardware/display/SemWifiDisplayStatus;->getActiveDisplayState()I
-
-    move-result v0
-
-    const/4 v3, 0x2
-
-    if-ne v0, v3, :cond_1
-
-    move v0, v1
-
-    goto :goto_0
-
-    :cond_1
-    move v0, v2
-
-    :goto_0
-    const-string v3, "media_router"
-
-    invoke-virtual {p0, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Landroid/media/MediaRouter;
-
-    const/4 v4, 0x4
-
-    invoke-virtual {v3, v4}, Landroid/media/MediaRouter;->getSelectedRoute(I)Landroid/media/MediaRouter$RouteInfo;
-
-    move-result-object v3
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->getSupportedTypes()I
-
-    move-result v5
-
-    and-int/2addr v4, v5
-
-    if-eqz v4, :cond_3
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->semGetDeviceAddress()Ljava/lang/String;
-
-    move-result-object v4
-
-    if-nez v4, :cond_3
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->semGetStatusCode()I
-
-    move-result v4
-
-    const/4 v5, 0x6
-
-    if-ne v4, v5, :cond_3
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->getPresentationDisplay()Landroid/view/Display;
-
-    move-result-object v4
-
-    if-nez v4, :cond_2
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->getDescription()Ljava/lang/CharSequence;
-
-    move-result-object v4
-
-    if-eqz v4, :cond_3
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->getDescription()Ljava/lang/CharSequence;
-
-    move-result-object v3
-
-    invoke-interface {v3}, Ljava/lang/CharSequence;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    const-string v4, "Audio"
-
-    invoke-virtual {v3, v4}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_3
-
-    :cond_2
-    move v3, v1
-
-    goto :goto_1
-
-    :cond_3
-    move v3, v2
-
-    :goto_1
-    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object p0
-
-    const-string v4, "lelink_cast_on"
-
-    invoke-static {p0, v4, v2}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I
-
-    move-result p0
-
-    if-ne p0, v1, :cond_4
-
-    move p0, v1
-
-    goto :goto_2
-
-    :cond_4
-    move p0, v2
-
-    :goto_2
-    if-nez v0, :cond_5
-
-    if-nez v3, :cond_5
-
-    if-eqz p0, :cond_6
-
-    :cond_5
-    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isSmartViewFitToActiveDisplay()Z
-
-    move-result p0
-
-    if-eqz p0, :cond_6
-
-    goto :goto_3
-
-    :cond_6
-    move v1, v2
-
-    :goto_3
-    return v1
-.end method
-
 .method public static isSmartViewFitToActiveDisplay()Z
     .locals 1
 
@@ -1592,236 +1410,6 @@
     return v0
 .end method
 
-.method public static setInDisplayFingerprintSensorPosition(Landroid/util/DisplayMetrics;)V
-    .locals 7
-
-    const-string v0, "readFingerprintSensor : failed to close file"
-
-    sget-boolean v1, Lcom/android/systemui/util/DeviceState;->sLoadedSensorValue:Z
-
-    if-nez v1, :cond_3
-
-    new-instance v1, Ljava/io/File;
-
-    const-string v2, "/sys/class/fingerprint/fingerprint/position"
-
-    invoke-direct {v1, v2}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1}, Ljava/io/File;->exists()Z
-
-    move-result v2
-
-    const-string v3, "DeviceState"
-
-    if-eqz v2, :cond_2
-
-    const/4 v2, 0x0
-
-    :try_start_0
-    new-instance v4, Ljava/io/FileInputStream;
-
-    invoke-direct {v4, v1}, Ljava/io/FileInputStream;-><init>(Ljava/io/File;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    :try_start_1
-    invoke-virtual {v1}, Ljava/io/File;->length()J
-
-    move-result-wide v5
-
-    long-to-int v1, v5
-
-    new-array v1, v1, [B
-
-    invoke-virtual {v4, v1}, Ljava/io/FileInputStream;->read([B)I
-
-    move-result v5
-
-    if-lez v5, :cond_0
-
-    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    new-instance v4, Ljava/lang/String;
-
-    sget-object v5, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;
-
-    invoke-direct {v4, v1, v5}, Ljava/lang/String;-><init>([BLjava/nio/charset/Charset;)V
-
-    const-string v1, ","
-
-    invoke-virtual {v4, v1}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
-
-    move-result-object v1
-
-    const/4 v4, 0x0
-
-    aget-object v4, v1, v4
-
-    sput-object v4, Lcom/android/systemui/util/DeviceState;->sSemSensorMarginBottom:Ljava/lang/String;
-
-    const/4 v4, 0x3
-
-    aget-object v4, v1, v4
-
-    sput-object v4, Lcom/android/systemui/util/DeviceState;->sSemSensorAreaHeight:Ljava/lang/String;
-
-    const/4 v4, 0x7
-
-    aget-object v1, v1, v4
-
-    sput-object v1, Lcom/android/systemui/util/DeviceState;->sSemSensorImageSize:Ljava/lang/String;
-
-    const/4 v1, 0x1
-
-    sput-boolean v1, Lcom/android/systemui/util/DeviceState;->sLoadedSensorValue:Z
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    goto :goto_0
-
-    :cond_0
-    move-object v2, v4
-
-    :goto_0
-    if-eqz v2, :cond_3
-
-    goto :goto_2
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_4
-
-    :catch_0
-    move-exception v1
-
-    move-object v2, v4
-
-    goto :goto_1
-
-    :catchall_1
-    move-exception p0
-
-    goto :goto_3
-
-    :catch_1
-    move-exception v1
-
-    :goto_1
-    :try_start_3
-    const-string v4, "readFingerprintSensor : failure to read sensor info : "
-
-    invoke-static {v3, v4, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    if-eqz v2, :cond_3
-
-    :goto_2
-    :try_start_4
-    invoke-virtual {v2}, Ljava/io/FileInputStream;->close()V
-    :try_end_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_2
-
-    goto :goto_6
-
-    :catch_2
-    move-exception v1
-
-    invoke-static {v3, v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    goto :goto_6
-
-    :goto_3
-    move-object v4, v2
-
-    :goto_4
-    if-eqz v4, :cond_1
-
-    :try_start_5
-    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
-    :try_end_5
-    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_3
-
-    goto :goto_5
-
-    :catch_3
-    move-exception v1
-
-    invoke-static {v3, v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    :cond_1
-    :goto_5
-    throw p0
-
-    :cond_2
-    const-string v0, "readFingerprintSensor : No file for sensor pos"
-
-    invoke-static {v3, v0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_3
-    :goto_6
-    sget-object v0, Lcom/android/systemui/util/DeviceState;->sSemSensorImageSize:Ljava/lang/String;
-
-    invoke-static {v0}, Ljava/lang/Float;->parseFloat(Ljava/lang/String;)F
-
-    move-result v0
-
-    const/4 v1, 0x5
-
-    invoke-static {v1, v0, p0}, Landroid/util/TypedValue;->applyDimension(IFLandroid/util/DisplayMetrics;)F
-
-    move-result v0
-
-    sget-object v2, Lcom/android/systemui/util/DeviceState;->sSemSensorMarginBottom:Ljava/lang/String;
-
-    invoke-static {v2}, Ljava/lang/Float;->parseFloat(Ljava/lang/String;)F
-
-    move-result v2
-
-    invoke-static {v1, v2, p0}, Landroid/util/TypedValue;->applyDimension(IFLandroid/util/DisplayMetrics;)F
-
-    move-result v2
-
-    sget-object v3, Lcom/android/systemui/util/DeviceState;->sSemSensorAreaHeight:Ljava/lang/String;
-
-    invoke-static {v3}, Ljava/lang/Float;->parseFloat(Ljava/lang/String;)F
-
-    move-result v3
-
-    invoke-static {v1, v3, p0}, Landroid/util/TypedValue;->applyDimension(IFLandroid/util/DisplayMetrics;)F
-
-    move-result p0
-
-    float-to-int v1, v2
-
-    float-to-int p0, p0
-
-    div-int/lit8 p0, p0, 0x2
-
-    add-int/2addr p0, v1
-
-    float-to-int v0, v0
-
-    div-int/lit8 v2, v0, 0x2
-
-    add-int/2addr v2, p0
-
-    sput v2, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    sput v0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintImageSize:I
-
-    sput v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintMarginBottom:I
-
-    return-void
-.end method
-
 .method public static shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
     .locals 5
 
diff --git a/smali_classes2/com/android/systemui/util/DeviceType.smali b/smali_classes2/com/android/systemui/util/DeviceType.smali
index 07542fd7..ad9e9ab8 100644
--- a/smali_classes2/com/android/systemui/util/DeviceType.smali
+++ b/smali_classes2/com/android/systemui/util/DeviceType.smali
@@ -36,6 +36,8 @@
 
 .field public static supportSEPLite:I = -0x1
 
+.field public static supportSideFingerprintExclusive:I = -0x1
+
 .field public static supportTablet:I = -0x1
 
 .field public static supportVibrator:I = -0x1
-- 
2.45.2

