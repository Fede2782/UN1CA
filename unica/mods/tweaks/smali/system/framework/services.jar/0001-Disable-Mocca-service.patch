From f225eedd2b601b1f6404958b522d701ee18a1c49 Mon Sep 17 00:00:00 2001
From: BlackMesa123 <giangrecosalvo9@gmail.com>
Date: Fri, 14 Jun 2024 11:30:57 +0200
Subject: [PATCH] Disable Mocca service

---
 smali/com/android/server/SystemServer.smali | 149 --------------------
 1 file changed, 149 deletions(-)

diff --git a/smali/com/android/server/SystemServer.smali b/smali/com/android/server/SystemServer.smali
index 3451cc99..9d7e5c6b 100644
--- a/smali/com/android/server/SystemServer.smali
+++ b/smali/com/android/server/SystemServer.smali
@@ -1654,54 +1654,6 @@
     :goto_10
     invoke-virtual/range {p1 .. p1}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
-    const-string v0, "MoccaReady"
-
-    invoke-virtual {v2, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
-
-    if-eqz v9, :cond_12
-
-    :try_start_e
-    const-string v0, "com.samsung.android.mocca.MoccaLoader"
-
-    invoke-static {v0}, Ljava/lang/Class;->forName(Ljava/lang/String;)Ljava/lang/Class;
-
-    move-result-object v0
-
-    new-array v4, v4, [Ljava/lang/Class;
-
-    const-class v7, Landroid/content/Context;
-
-    aput-object v7, v4, v6
-
-    const-class v7, Landroid/os/IBinder;
-
-    aput-object v7, v4, v14
-
-    invoke-virtual {v0, v5, v4}, Ljava/lang/Class;->getDeclaredMethod(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;
-
-    move-result-object v0
-
-    filled-new-array {v3, v9}, [Ljava/lang/Object;
-
-    move-result-object v4
-
-    invoke-virtual {v0, v12, v4}, Ljava/lang/reflect/Method;->invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
-    :try_end_e
-    .catchall {:try_start_e .. :try_end_e} :catchall_e
-
-    goto :goto_11
-
-    :catchall_e
-    move-exception v0
-
-    const-string/jumbo v4, "making Mocca Service ready : "
-
-    invoke-virtual {v1, v4, v0}, Lcom/android/server/SystemServer;->reportWtf(Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    :cond_12
-    :goto_11
-    invoke-virtual/range {p1 .. p1}, Landroid/util/TimingsTraceLog;->traceEnd()V
-
     const-string v0, "SAccessoryManager"
 
     invoke-virtual {v2, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
@@ -9316,109 +9268,8 @@
     :goto_58
     invoke-virtual/range {p1 .. p1}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
-    const-string v2, "StartMoccaService"
-
-    invoke-virtual {v14, v2}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
-
-    :try_start_66
-    const-string v2, "com.samsung.android.mocca.MoccaLoader"
-
-    invoke-static {v2}, Ljava/lang/Class;->forName(Ljava/lang/String;)Ljava/lang/Class;
-
-    move-result-object v2
-
-    const-string v3, "getMoccaService"
-    :try_end_66
-    .catchall {:try_start_66 .. :try_end_66} :catchall_41
-
     move-object/from16 v30, v1
 
-    const/4 v10, 0x1
-
-    :try_start_67
-    new-array v1, v10, [Ljava/lang/Class;
-
-    const-class v10, Landroid/content/Context;
-
-    const/16 v17, 0x0
-
-    aput-object v10, v1, v17
-
-    invoke-virtual {v2, v3, v1}, Ljava/lang/Class;->getDeclaredMethod(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;
-
-    move-result-object v1
-
-    filled-new-array {v13}, [Ljava/lang/Object;
-
-    move-result-object v2
-
-    const/4 v3, 0x0
-
-    invoke-virtual {v1, v3, v2}, Ljava/lang/reflect/Method;->invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    move-object v3, v1
-
-    check-cast v3, Landroid/os/IBinder;
-    :try_end_67
-    .catchall {:try_start_67 .. :try_end_67} :catchall_40
-
-    :try_start_68
-    const-string/jumbo v1, "mocca"
-
-    invoke-static {v1, v3}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V
-    :try_end_68
-    .catchall {:try_start_68 .. :try_end_68} :catchall_3f
-
-    goto :goto_5b
-
-    :catchall_3f
-    move-exception v0
-
-    move-object v1, v0
-
-    goto :goto_5a
-
-    :catchall_40
-    move-exception v0
-
-    goto :goto_59
-
-    :catchall_41
-    move-exception v0
-
-    move-object/from16 v30, v1
-
-    :goto_59
-    move-object v1, v0
-
-    const/4 v3, 0x0
-
-    :goto_5a
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v10, "Starting MoccaService:"
-
-    invoke-virtual {v2, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/Throwable;->getMessage()Ljava/lang/String;
-
-    move-result-object v10
-
-    invoke-virtual {v2, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v15, v2, v1}, Lcom/android/server/SystemServer;->reportWtf(Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    :goto_5b
-    invoke-virtual/range {p1 .. p1}, Landroid/util/TimingsTraceLog;->traceEnd()V
-
     const-string v1, "SemMdnieManagerService"
 
     invoke-virtual {v14, v1}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
-- 
2.45.2

